---
title: "man ドキュメントの使い方メモ"
author: "Ryo Nakagami"
date: "2026-01-02"
date-modified: "2026-01-10"
categories: [環境構築, Linux]
listing_category: development
comments:
  utterances:
       repo: RyoNakagami/regmonkey-datascience-blog
       label: discussion
       issue-term: title
---

## TL;DR

::: {#def- .custom_problem .blog-custom-border}
[`man` コマンド]{.def-title}

- `man` はmanual（マニュアル）ページを表示するためのコマンド
- `man 1 command`でセクション番号(今回は `1` )を指定したmanコマンドの使用方法を表示
- `/usr/share/man` や `/usr/local/share/man` にあるドキュメントマニュアルを参照している

:::

[`man` コマンドの特徴]{.mini-section}

- `man` はデフォルトでは `less` ページャーとして利用
  - `-P more` で `more` を利用できる 
- `-N` で行番号の表示
- `3600g` で3600行目へジャンプ
- `/<文字列>` で前方検索，`n` で次のマッチへ

[セクションページの目安]{.mini-section}

:::: {.no-border-top-table}

| セクション | 内容                               |
| ----- | -------------------------------- |
| 1     | ユーザーコマンド（ls, cp, grep など）        |
| 2     | システムコール（open, read, fork など）     |
| 3     | Cライブラリ関数                         |
| 5     | 設定ファイル形式（fstab, passwd など）       |
| 8     | 管理者コマンド（mount, ip, systemctl など） |

::::

[セクションページの種類の確認]{.mini-section}

`passwd` を指定した場合，コマンドとしての`passwd`のマニュアルなのか，それとも `/etc/passwd` ファイルのマニュアルなのかどちらのパターンも考えられます．
このとき，入力した名前についてどのようなセクションがあるのかを一覧表示する場合 `man -f <name>` を実行します．例として，

```bash
$ man -f passwd                          
passwd (1)           - change user password
passwd (1ssl)        - OpenSSL application commands
passwd (5)           - the password file
```


## 1. `man bash` のような 長い `man` ページで現在位置を把握したい

行番号の表示は，ページャー(デフォルトでは `less`) の機能を用いて実現できます．

- 起動後に `-N` を入力すると，行番号表示のトグルとして使えます
- 起動時から有効にしたい場合は `man bash | less -N`

## 2. 直接指定した行へジャンプ

`less` をページャとして用いる場合は

[基本操作]{.mini-section}

- `<行番号>g`: 指定行へ移動
- `G`: 最終行へ移動
- `g`: 先頭への移動

## 3. 文字列検索

[基本操作]{.mini-section}

- `/pattern` : 前方検索
- `?pattern` : 後方検索
- `n` : 次のマッチへ
- `N` : 前のマッチへ

::: {#exm- .custom_problem }
<br>

`.profile` を含む行を検索する場合は

```txt
/\.profile
```

`.` は正規表現なので，`\.` とエスケープすることが必要

:::
---

::: {.callout-note}
### 前方検索 vs 後方検索

- 前方検索: 現在位置から下に向かって検索．次にマッチの `n` は下に移動する
- 後方検索: 現在位置から上方向 に向かって検索．次にマッチの `n` は上に移動する

`n`, `N` は同じ方向・逆方向の次にマッチに相当します．

:::

## 4. クリップボードへコピー

::: {.callout-note}
### クリップボードへコピーするコマンド

`ln` コマンドの `man` ページを，整形済みのプレーンテキストにして，クリップボードへコピーするコマンドは以下

:::{style="padding-left:1em;"}

```bash
# 通常
man ln | col -bx | xclip -selection clipboard

# markdownへ変換したものをclipboardへ
man ln | col -bx | pandoc -t markdown | xclip -selection clipboard
```
:::

処理の流れは以下

1. `man` でマニュアルを表示
2. `col -bx` で余計な改行コードを整形
3. `xclip -selection clipboard` でクリップボードへコピー

:::

### `col`コマンド

::: {#def- .custom_problem .blog-custom-border}
[`col` コマンド]{.def-title}


- 行送り・バックスペース・制御文字を解釈して，再構成するフィルタ用コマンド
- `man` や `tbl` のような端末制御前提の出力を前処理する際に用いる

:::

[options]{.mini-section}

| オプション | 役割                |
| ----- | ----------------- |
| `-b`  | man 特有の太字・下線を完全除去 |
| `-x`  | タブをスペースにして崩れ防止    |


::: {#exm- .custom_problem }
### `pandoc` を用いてPDF化
<br>

```bash
man ln | col -bx | pandoc -t pdf -o <output-path>
```

他のフォーマットで出力したい場合は，`pandoc --list-input-formats` で出力可能形式を調べることができます．

:::
---

## Appendix: less vs vim

[移動]{.mini-section}

| 操作   | less    | vim               |
| ---- | ------- | ----------------- |
| 下へ1行 | `j`     | `j`               |
| 上へ1行 | `k`     | `k`               |
| 先頭へ  | `g`     | `gg`              |
| 末尾へ  | `G`     | `G`               |
| 指定行へ | `3600g` | `:3600` / `3600G` |

[検索]{.mini-section}

| 操作    | less       | vim        |
| ----- | ---------- | ---------- |
| 前方検索  | `/pattern` | `/pattern` |
| 後方検索  | `?pattern` | `?pattern` |
| 次のマッチ | `n`        | `n`        |
| 前のマッチ | `N`        | `N`        |

[表示]{.mini-section}

| 操作      | less           | vim             |
| ------- | -------------- | --------------- |
| 行番号表示   | `-N`           | `:set number`   |
| 行番号OFF  | `-N`           | `:set nonumber` |
