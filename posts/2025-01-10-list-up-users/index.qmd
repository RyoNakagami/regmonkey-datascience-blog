---
title: "Linuxã‚·ã‚¹ãƒ†ãƒ ä¸Šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ã‚’æ¡ä»¶ã«å¿œã˜ã¦è¡¨ç¤ºã™ã‚‹"
author: "Ryo Nakagami"
date: "2025-01-10"
date-modified: "2025-07-24"
categories: [shell,Linux]
listing_category: development
comments:
  utterances:
       repo: RyoNakagami/regmonkey-datascience-blog
       label: discussion
       issue-term: title
---

## ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆ `ls-users`

::: {.custom_problem .blog-custom-border}
[ğŸ¯ ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ç›®çš„]{.def-title-no-before}

`/etc/passwd` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿å–ã‚Šï¼Œä»¥ä¸‹ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹:

- ã™ã¹ã¦ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼
- ã‚·ã‚¹ãƒ†ãƒ ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆUID < 1000ï¼‰
- humanãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆUID >= 1000ï¼‰

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ `humanãƒ¦ãƒ¼ã‚¶ãƒ¼` ã‚’è¡¨ç¤ºã•ã›ã‚‹ï¼

:::

### ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆæœ¬ä½“

```{.bash}
#!/bin/bash

print_help() {
    echo "Usage: $0 [-a|-s|-h]"
    echo "Options:"
    echo "  -a    Show all users"
    echo "  -s    Show only system users"
    echo "  -h    Show only human users"
    echo "  -?    Show this help message"
    exit 1
}

# Default to human users if no option is provided
MODE="human"

while getopts "ash?" opt; do
    case $opt in
        a) MODE="all";;
        s) MODE="system";;
        h) MODE="human";;
        ?) print_help;;
    esac
done

# Print header
printf "%-20s %-6s %-6s\n" "Username" "UID" "GID"

case $MODE in
    "all")
        awk -F: '{ printf "%-20s %-6s %-6s\n", $1, $3, $4 }' /etc/passwd
        ;;
    "system")
        awk -F: '$3 < 1000 { printf "%-20s %-6s %-6s\n", $1, $3, $4 }' /etc/passwd
        ;;
    "human")
        awk -F: '$3 >= 1000 && $3 < 65534 { printf "%-20s %-6s %-6s\n", $1, $3, $4 }' /etc/passwd
        ;;
esac
```

### ã‚¹ã‚¯ãƒªãƒ—ãƒˆè§£èª¬

[ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®å‡¦ç†]{.mini-section}

```{.bash}
while getopts "ash?" opt; do
    case $opt in
        a) MODE="all";;
        s) MODE="system";;
        h) MODE="human";;
        ?) print_help;;
    esac
done
```

- `getopts` ã‚’ä½¿ã£ã¦ã€ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«å¿œã˜ã¦å‡¦ç†åˆ†å²
- `MODE` ã¨ã„ã†å¤‰æ•°ã«æ¡ä»¶ã‚’è¨˜éŒ²ã—ï¼Œoptionã«å¿œã˜ãŸå‡¦ç†ã¯å¾Œæ®µã§å®Ÿè£…

|option|å‡¦ç†å†…å®¹|
|------|-------|
|`-a`|å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼è¡¨ç¤º|
|`-s`|ã‚·ã‚¹ãƒ†ãƒ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿è¡¨ç¤ºï¼ˆUID < 1000ï¼‰|
|`-h`|humanãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿è¡¨ç¤º|
|`-?`|ãƒ˜ãƒ«ãƒ—ã‚’è¡¨ç¤ºï¼Œstatus codeã¯ `exit 1`|

[ãƒ˜ãƒƒãƒ€ãƒ¼å‡ºåŠ›]{.mini-section}


```{.bash}
printf "%-20s %-6s %-6s\n" "Username" "UID" "GID"
```

- æ•´å½¢ã•ã‚ŒãŸã‚«ãƒ©ãƒ è¦‹å‡ºã—ã‚’å‡ºåŠ›
- `%-20s`ã¯æ–‡å­—åˆ—(`s`)ã‚’å·¦å¯„ã›ã§20æ–‡å­—åˆ†ã®å¹…ã§è¡¨ç¤º

:::: {.no-border-top-table}

| æ›¸å¼æŒ‡å®šå­   | æ„å‘³                       |
| ------- | ------------------------ |
| `%-20s` | å·¦å¯„ã›ã§20æ–‡å­—å¹…ã®æ–‡å­—åˆ—ï¼ˆUsernameåˆ—ï¼‰ |
| `%-6s`  | å·¦å¯„ã›ã§6æ–‡å­—å¹…ã®æ–‡å­—åˆ—ï¼ˆUIDåˆ—ï¼‰       |
| `%-6s`  | å·¦å¯„ã›ã§6æ–‡å­—å¹…ã®æ–‡å­—åˆ—ï¼ˆGIDåˆ—ï¼‰       |


::::

[ãƒ¦ãƒ¼ã‚µãƒ¼ä¸€è¦§ã®å–å¾—]{.mini-section}

```{.bash}
case $MODE in
    "all")
        awk -F: '{ printf "%-20s %-6s %-6s\n", $1, $3, $4 }' /etc/passwd
        ;;
    "system")
        awk -F: '$3 < 1000 { printf "%-20s %-6s %-6s\n", $1, $3, $4 }' /etc/passwd
        ;;
    "human")
        awk -F: '$3 >= 1000 && $3 < 65534 { printf "%-20s %-6s %-6s\n", $1, $3, $4 }' /etc/passwd
        ;;
esac
```

:::: {.no-border-top-table}

|command|å‹•ä½œèª¬æ˜|
|---------|---------------------------|
|`awk -F:`|`:`åŒºåˆ‡ã‚Šã§ /etc/passwd ã‚’åˆ†å‰²|
|`'$3 >= 1000 && $3 < 65534 { printf ...}'`|UID ãŒ 1000ä»¥ä¸Š65534æœªæº€ã‚’å¯¾è±¡ã«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼|
|`$1`|`/etc/passwd`ã«ãŠã‘ã‚‹usernameã‚«ãƒ©ãƒ |
|`$3`|`/etc/passwd`ã«ãŠã‘ã‚‹UIDã‚«ãƒ©ãƒ |
|`$4`|`/etc/passwd`ã«ãŠã‘ã‚‹GIDã‚«ãƒ©ãƒ |

::::

## `/etc/passwd`ãƒ•ã‚¡ã‚¤ãƒ«

::: {#def- .custom_problem .blog-custom-border}
[`/etc/passwd`ãƒ•ã‚¡ã‚¤ãƒ«]{.def-title}

- Linux ã«ãŠã„ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã®ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«

:::

[åŸºæœ¬ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ]{.mini-section}

```bash
ãƒ¦ãƒ¼ã‚¶ãƒ¼å:ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰:UID:GID:ã‚³ãƒ¡ãƒ³ãƒˆ:ãƒ›ãƒ¼ãƒ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª:ãƒ­ã‚°ã‚¤ãƒ³ã‚·ã‚§ãƒ«
```

å®Ÿéš›ã«ç¢ºèªã—ã¦ã¿ã‚‹ã¨

```bash
% cat /etc/passwd
kirby:x:1001:1001:Hoshino Kirby:/home/kirby:/bin/bash
```

ç¬¬ï¼’ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯å¤šãã®å ´åˆ `x` ã¨ã„ã†è¡¨è¨˜ã«ãªã£ã¦ã„ã¾ã™ï¼å®Ÿéš›ã®ãƒãƒƒã‚·ãƒ¥ã¯ `/etc/shadow` ã«ä¿å­˜ã•ã‚Œã¦ã„ã¾ã™ï¼


## Linuxã«ãŠã‘ã‚‹Userã¨Group

[Linuxã«ãŠã‘ã‚‹useråŒºåˆ†]{.mini-section}

:::: {.no-border-top-table}

|ãƒ¦ãƒ¼ã‚¶ãƒ¼åŒºåˆ†|èª¬æ˜|
|----------|---|
|ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒ¦ãƒ¼ã‚¶ãƒ¼| ã‚·ã‚¹ãƒ†ãƒ å”¯ä¸€ã®ç‰¹æ¨©ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼Œã™ã¹ã¦ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã‚’ç„¡è¦–ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ï¼ `ãƒ¦ãƒ¼ã‚¶ãƒ¼å:root, UID:0` ã¨æ±ºã¾ã£ã¦ã„ã‚‹|
|ã‚·ã‚¹ãƒ†ãƒ ãƒ¦ãƒ¼ã‚¶ãƒ¼| å„ç¨®ã‚µãƒ¼ãƒãƒ¼ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚„ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å®Ÿè¡Œã«åˆ©ç”¨ã•ã‚Œã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ UIDã¯ä¸»ã«`1~99`ã®ç¯„å›²ã§å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹|
|ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼| 	ã‚·ã‚¹ãƒ†ãƒ ã®ä¸€èˆ¬åˆ©ç”¨è€… ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã¯1000ä»¥é™ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ï¼ˆåˆã‚ã¦ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãªã‚‰1000ï¼‰|
: {tbl-colwidths="[25,75]"}

::::

::: {.callout-note}

- rootä»¥å¤–ã®uid1000æœªæº€ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯ãƒ‡ãƒ¼ãƒ¢ãƒ³ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ‰€æœ‰è€…ã¨ã—ã¦åˆ©ç”¨ã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¨ã—ã¦ç”¨æ„ã•ã‚Œã¦ã„ã‚‹
- 100æœªæº€ã®UIDã«ã¤ã„ã¦ã‚·ã‚¹ãƒ†ãƒ ã«ã‚ˆã£ã¦é™çš„ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã¹ãã§ã‚ã‚Šï¼Œã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã£ã¦ä½œæˆã•ã‚Œã‚‹ã¹ãã§ã¯ãªã„ç¯„å›²
- 100 ã‹ã‚‰ 499 ã¯ï¼Œã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…ã‚„ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒ `useradd` ã‚’ä½¿ç”¨ã—ã¦å‹•çš„ã«å‰²ã‚Šå½“ã¦ã‚‹ãŸã‚ã«äºˆç´„ã•ã‚ŒãŸé ˜åŸŸ

:::


[nobodyã¨ã¯èª°ã‹ï¼Ÿ]{.mini-section}

::: {#def- .custom_problem .blog-custom-border}
[nobodyãƒ¦ãƒ¼ã‚¶ãƒ¼]{.def-title}

- nobodyã«å¯¾ã—ã¦ï¼Œä¸€èˆ¬çš„ã«ã¯UID 65534ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹
- 65535ã¯16bitç¬¦å·ãªã—æ•´æ•°ã§è¡¨ã™ã“ã¨ã®ã§ãã‚‹ä¸€ç•ªå¤§ããªæ•°å­—(`FFFFFF`)
- NFS(Network File System)ã‚µãƒ¼ãƒãƒ¼ãŒã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰æä¾›ã•ã‚ŒãŸUIDã‚„GIDã‚’ä¿¡é ¼ã§ããªã„å ´åˆï¼Œã¾ãŸã¯root-squashã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹å ´åˆã«ä½¿ç”¨ã•ã‚Œã‚‹
- åŸºæœ¬çš„ã«ã¯NFSç”¨ã«ç”¨æ„ã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼

:::

æ³¨æ„ç‚¹ã¨ã—ã¦ï¼Œãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’é€šã˜ã¦ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼é–“ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å…±æœ‰ã™ã‚‹NFSç”¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ã‚ã£ã¦ãã®ä»–ã®ç›®çš„ã§ä½¿ç”¨ã•ã‚Œã‚‹ã“ã¨ã¯æƒ³å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ï¼ã€Œnobodyã‚’ä¿¡é ¼ã§ããªã„ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å®Ÿè¡Œã‚„ä¿¡é ¼ã§ããªã„ãƒ‡ãƒ¼ã‚¿ã®å‡¦ç†ã«ä½¿ç”¨ã™ã‚‹ã“ã¨ã€ã¯æ¨å¥¨ã•ã‚Œã¾ã›ã‚“ï¼ã€Œã‚ãã¾ã§ï¼Œã‚µãƒ¼ãƒ“ã‚¹ã«ã¯å°‚ç”¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’æŒãŸã›ã‚‹ã¹ãã€ã¨ã„ã†ãƒ«ãƒ¼ãƒ«ã‚’å¿˜ã‚Œãªã„ã‚ˆã†ã«ã—ã¾ã—ã‚‡ã†ï¼