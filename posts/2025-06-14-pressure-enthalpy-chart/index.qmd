---
title: "PHç·šå›³: pressure-enthalpy chart"
author: "Ryo Nakagami"
date: "2025-06-14"
date-modified: "2025-06-25"
categories: [ç†±åŠ›å­¦]
listing_category: development
comments:
  utterances:
       repo: RyoNakagami/regmonkey-datascience-blog
       label: discussion
       issue-term: title
---

## PHç·šå›³

PHç·šå›³ï¼ˆåœ§åŠ›ï¼æ¯”ã‚¨ãƒ³ã‚¿ãƒ«ãƒ”ãƒ¼ç·šå›³ï¼‰ã¯ï¼Œç¸¦è»¸ã«åœ§åŠ›ï½ï¼Œæ¨ªè»¸ã«æ¯”ã‚¨ãƒ³ã‚¿ãƒ«ãƒ”ãƒ¼ï½ˆã‚’ã¨ã‚Šï¼Œ å®Ÿç”¨ä¸Šã®ä¾¿åˆ©ã•ã‹ã‚‰ç¸¦è»¸ã¯åœ§åŠ›ã®å¯¾æ•°ã§ç›®ç››ã‚‰ã‚Œã¦ã„ã¾ã™ï¼
æ¯”ã‚¨ãƒ³ã‚¿ãƒ«ãƒ”ãƒ¼ã¯ç›´æ¥æ¸¬å®šã™ã‚‹ã“ã¨ã¯å›°é›£ã§ã™ãŒï¼Œåœ§åŠ›ã¨æ¸©åº¦ã¯æ¸¬å®šã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã®ã§ï¼Œãã‚Œã‚‰ã®å€¤ã‹ã‚‰PHç·šå›³ã‚’ãƒ™ãƒ¼ã‚¹ã«æ¯”ã‚¨ãƒ³ã‚¿ãƒ«ãƒ”ãƒ¼ã‚’è¨ˆç®—ã—ï¼Œå†·åª’ã®çŠ¶æ…‹ã‚’æŠŠæ¡ã—ã¾ã™ï¼

:::: {.no-border-top-table}

| ç”¨èª        | æ„å‘³                  | å›³ã§ã®ä½ç½®      |
| --------- | ------------------- | ---------- |
| **é£½å’Œæ¶²ç·š**  | æ¶²ä½“ãŒè’¸ç™ºã‚’å§‹ã‚ã‚‹å¢ƒç•Œï¼ã“ã®ç·šã®å·¦å´ã¯ã€Œæ¶²ä½“ï¼ˆã‚µãƒ–ã‚¯ãƒ¼ãƒ«æ¶²ï¼‰ã€é ˜åŸŸ         | æ¹¿ã‚Šè’¸æ°—é ˜åŸŸã®å·¦ç«¯ï¼ˆé’ç·šï¼‰  |
| **é£½å’Œè’¸æ°—ç·š** | è’¸æ°—ãŒå‡ç¸®ã‚’å§‹ã‚ã‚‹å¢ƒç•Œï¼ã“ã®ç·šã®å³å´ã¯ã€Œéç†±è’¸æ°—ï¼ˆsuperheated vaporï¼‰ã€é ˜åŸŸ         | æ¹¿ã‚Šè’¸æ°—é ˜åŸŸã®å³ç«¯ï¼ˆã‚ªãƒ¬ãƒ³ã‚¸ç·šï¼‰  |
| **äºŒç›¸é ˜åŸŸ**  | æ¶²ä½“ã¨è’¸æ°—ãŒå…±å­˜ï¼ˆæ²¸é¨° or å‡ç¸®ä¸­ï¼‰ | é£½å’Œæ¶²ç·šã¨è’¸æ°—ç·šã®é–“ |
: {tbl-colwidths="[20,50, 30]"}

::::

```{python}
#| label: fig-ph-chart
#| fig-cap: ""
import numpy as np
import matplotlib.pyplot as plt
from CoolProp.CoolProp import PropsSI  # â† ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œã« import

fluid = "R410A"  # ä»»æ„ã®å†·åª’ã«å¤‰æ›´å¯
pa_converter = 10**6


# Saturation curve
T_min = PropsSI("Ttriple", fluid) + 1.0  # [K]
T_crit = PropsSI("Tcrit", fluid)  # [K]
T_sat = np.linspace(T_min, T_crit - 1e-5, 200)

p_sat = PropsSI("P", "T", T_sat, "Q", 0, fluid)
h_liq = PropsSI("H", "T", T_sat, "Q", 0, fluid) / 1000  # [kJ/kg]
h_vap = PropsSI("H", "T", T_sat, "Q", 1, fluid) / 1000  # [kJ/kg]

plt.figure(figsize=(8, 6))
plt.plot(h_liq, p_sat / pa_converter, label="Saturated Liquid")
plt.plot(h_vap, p_sat / pa_converter, label="Saturated Vapor")

# é©å½“ãªç­‰æ¸©ç·šï¼ˆä»»æ„ã§ï¼‰
for T_iso in np.linspace(T_crit - 123.5, T_crit + 60, 4):
    p_iso = np.logspace(np.log10(p_sat.min()), np.log10(p_sat.max()), 150)
    h_iso = PropsSI("H", "T", T_iso, "P", p_iso, fluid) / 1000
    plt.plot(
        h_iso,
        p_iso / pa_converter,
        linestyle="--",
        label=f"{T_iso - 273.15:.0f} Â°C Isotherm",
    )

plt.yscale("log")
plt.xlabel("Enthalpy [kJ/kg]")
plt.ylabel("Pressure [MPa]")
plt.title(f"Pressureâ€“Enthalpy (p-h) Diagram for {fluid}")
plt.legend()
plt.grid(True, which="both", ls=":")
plt.tight_layout()
plt.show()
```

### ä¹¾ãåº¦ã¨æ¹¿ã‚Šåº¦

é£½å’Œè’¸æ°—ã¨é£½å’Œæ¶²ãŒå…±å­˜ã—ã¦ã„ã‚‹æ¹¿ã‚Šè’¸æ°—çŠ¶æ…‹ã¯ï¼Œæ¸©åº¦ã¨åœ§åŠ›ã®ä»–ã«ï¼Œæ¹¿ã‚Šè’¸æ°—ä¸­ã®é£½å’Œè’¸æ°—ã®è³ªé‡åˆ†ç‡ã‚’æŒ‡å®šã—ãªã„ã¨æ¯”ã‚¨ãƒ³ã‚¿ãƒ«ãƒ”ãƒ¼ã®ä½ç½®ã¯å®šã¾ã‚Šã¾ã›ã‚“ï¼

::: {#def- .custom_problem .blog-custom-border}
[ä¹¾ãåº¦]{.def-title}

- æ¹¿ã‚Šè’¸æ°— 1kg ä¸­ã«é£½å’Œè’¸æ°—ãŒ x(kg) å«ã¾ã‚Œã¦ã„ã‚‹ã¨ãï¼Œã“ã®æ¹¿ã‚Šè’¸æ°—ã®ä¹¾ãåº¦ã¯ x ã§ã‚ã‚‹ã¨ã„ã†
- æ¹¿ã‚Šåº¦ã¯ï¼Œé£½å’Œæ¶²ã®è³ªé‡åˆ†ç‡ (1 - x) ã®ã“ã¨ã‚’ã„ã†

:::

:::: {.no-border-top-table}

| çŠ¶æ…‹             | èª¬æ˜                   | ä¹¾ãåº¦ $x$         |
| -------------- | -------------------- | --------------- |
| **éå†·å´æ¶²**       | é£½å’Œæ¶²ä½“ã‚ˆã‚Šã‚‚æ¸©åº¦ãŒä½ã„çŠ¶æ…‹ï¼ˆæ¶²ä½“ã®ã¿ï¼‰ | $x = 0$ |
| **é£½å’Œæ¶²ä½“**       | è’¸ç™ºé–‹å§‹ç›´å‰ã®çŠ¶æ…‹            | $x = 0$         |
| **æ··åˆï¼ˆæ¶² + è’¸æ°—ï¼‰** | æ¶²ä½“ã¨è’¸æ°—ãŒå…±å­˜ã™ã‚‹çŠ¶æ…‹ï¼ˆè’¸ç™ºä¸­ï¼‰ï¼Œæ¹¿ã‚Šè’¸æ°—    | $0 < x < 1$     |
| **é£½å’Œè’¸æ°—**       | è’¸ç™ºçµ‚äº†ç›´å¾Œã®çŠ¶æ…‹            | $x = 1$         |
| **åŠ ç†±è’¸æ°—**       | é£½å’Œè’¸æ°—ã‚ˆã‚Šã‚‚é«˜æ¸©ã®è’¸æ°—ï¼ˆå®Œå…¨ã«è’¸æ°—ï¼‰  | $x = 1$  |
: {tbl-colwidths="[25,50,25]"}

```{python}
# Define data arrays
x_values = np.array([0.0, 1.0])
kawaki_values = [0, 0.2, 1.0]
h_vap_line = np.zeros_like(x_values)
TC = -15
T = TC + 273.15

for i, x in enumerate(x_values):
    h_vap_line[i] = PropsSI("H", "T", T, "Q", x, fluid) / 1000
p_sat_line = PropsSI("P", "T", T, "Q", 0, fluid)

plt.figure(figsize=(8, 6))

for i, kawaki in enumerate(kawaki_values):
    plt.scatter(
        (1 - kawaki) * h_vap_line[0] + kawaki * h_vap_line[1],
        p_sat_line / pa_converter,
        label=f"h{i}",
    )

# é£½å’Œæ¶²ï½é£½å’Œè’¸æ°—ã‚’çµã¶ -15 Â°C ç­‰æ¸©ç·šï¼ˆç ´ç·šï¼‰
plt.plot([h_vap_line[0], h_vap_line[1]], [p_sat_line / pa_converter, p_sat_line / pa_converter],
         linestyle='--', color='gray', label=f'{TC} Â°C Isotherm')

plt.plot(h_liq, p_sat / pa_converter, label="Saturated Liquid")
plt.plot(h_vap, p_sat / pa_converter, label="Saturated Vapor")
plt.yscale("log")
plt.xlabel("Enthalpy [kJ/kg]")
plt.ylabel("Pressure [MPa]")
plt.legend()
plt.grid(True, which="both", ls=":")
plt.tight_layout()
plt.show()
```

$h_1$ ã«ãŠã‘ã‚‹ä¹¾ãåº¦ã®è¨ˆç®—ã¯ä»¥ä¸‹

$$
x = \frac{h_1 - h_0}{h_2 - h_0}
$$

::::

::: {.callout-note}
### ç†±ä¼é”ã¨ç²˜æ€§ä¿‚æ•°

- å†·åª’å´ç†±ä¼é”ç‡ã¯ãƒ—ãƒ©ãƒ³ãƒˆãƒ«æ•°ã«ä¾å­˜
- ãƒ—ãƒ©ãƒ³ãƒˆãƒ«æ•°ã¯ç†±ä¼å°ã«é–¢ã™ã‚‹ç„¡æ¬¡å…ƒã®ç‰©æ€§å€¤ã§ã‚ã‚Šï¼Œæµä½“ã®å‹•ç²˜åº¦ã¨ç†±æ‹¡æ•£ä¿‚æ•°ã®æ¯”ã§ã™ï¼

$$
Pr = \frac{\mu \cdot C_p}{\lambda}
$$

- $Pr$: ãƒ—ãƒ©ãƒ³ãƒˆãƒ«æ•°
- $\mu$: ç²˜æ€§ä¿‚æ•° [kg/mï½¥s]
- $C_p$: å®šåœ§æ¯”ç†± [J/kgï½¥K]
- $\lambda$: ç†±ä¼å°ç‡ [W/mï½¥K]

ãã—ã¦ç²˜æ€§ä¿‚æ•° $\mu$ ã¯McAdamsãƒ¢ãƒ‡ãƒ«ã‚’ç”¨ã„ã‚‹ã¨

$$
\frac{1}{\mu} = \frac{x}{\mu_v} + \frac{1-x}{\mu_l}
$$

- $x$: ä¹¾ãåº¦
- $v$: ã‚¬ã‚¹ç›¸
- $l$: æ¶²ç›¸

:::


### åŠ ç†±è’¸æ°—ã®æ¯”ä½“ç©

åŠ ç†±è’¸æ°—ã®æ¯”ä½“ç© $v_h$ [mÂ³/kg] ã¯ï¼ŒåŠ ç†±è’¸æ°—ã‚’ç†æƒ³æ°—ä½“ã¨è¿‘ä¼¼ã§ãã‚‹å ´åˆã«ã¯ç†æƒ³æ°—ä½“ã®çŠ¶æ…‹æ–¹ç¨‹å¼ã‚ˆã‚Šä»¥ä¸‹ã®ã‚ˆã†ã«è¡¨ã™ã“ã¨ãŒã§ãã¾ã™

$$
\begin{align}
v_h 
  &= \frac{v_eT_h}{T_e}\\
  &= v_e\left(1 + \frac{\Delta_h}{T_e}\right)
\end{align}
$$

- $v_e$: é£½å’Œè’¸æ°—ç·šã§ã®æ¯”ä½“ç©
- $T_h$: åŠ ç†±è’¸æ°—ã®æ¸©åº¦
- $\Delta_h$: åŠ ç†±åº¦


::: {.callout-note}
### æ¯”ä½“ç©ã¨åœ§ç¸®æ©Ÿã¨å†·åª’å¾ªç’°é‡

ç³»ã®å†·åª’å¾ªç’°é‡ $q_m$ [kg/h] ã¯ç†±äº¤æ›é‡ã‚’æ±ºå®šã™ã‚‹é‡è¦ãªè¦ç´ ã§ã™ï¼ãã—ã¦ï¼Œ$q_m$ ã¯åœ§ç¸®æ©Ÿã®æ€§èƒ½ã¨é‹è»¢æ¡ä»¶ã«ä¾å­˜ã—ã¾ã™ï¼
å®¹ç©å‹è’¸æ°—åœ§ç¸®æ©Ÿã¯ï¼Œå˜ä½æ™‚é–“ã‚ãŸã‚Šä¸€å®šå®¹ç©ã®ã‚¬ã‚¹ã‚’å¸ã„è¾¼ã‚“ã§åãå‡ºã™ã‚‚ã®ã§ã™ï¼ç†è«–æŠ¼ã—ã®ã‘é‡ $V_p$ [mÂ³/h] ã¯

$$
V_p = V_{st} \times N_{comp} \times 3600 \times 10^{-6}
$$

- $V_{st}$: ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯ãƒœãƒªãƒ¥ãƒ¼ãƒ  [cmÂ³]
- $N_{comp}$: å›è»¢ / ç§’ = Hz
- $V_p$: ç†è«–ãƒ”ã‚¹ãƒˆãƒ³æŠ¼ã—ã®ã‘é‡ [mÂ³/h]

ã“ã‚Œã‚’è³ªé‡ã«å¤‰æ›ã™ã‚‹ã¨å¾ªç’°æµé‡ $q_m$ ã«ãªã‚Šã¾ã™

$$
q_m = V_p \times \frac{1}{v_g}\times \eta_v
$$

- $v_g$: å¸å…¥å†·åª’ã‚¬ã‚¹ã®æ¯”å®¹ç©
- $1/v_g$: å¯†åº¦
- $\eta_v$: ä½“ç©åŠ¹ç‡ (0.8~0.9ç¨‹åº¦)

:::


### å†·åª’ã®è‡¨ç•Œæ¸©åº¦ã¨è‡¨ç•Œåœ§åŠ›

::: {#def- .custom_problem .blog-custom-border}
[è‡¨ç•Œç‚¹(Critical Point)]{.def-title}

- PHç·šå›³ã®ï¼Œé£½å’Œæ¶²ä½“ç·šã¨é£½å’Œè’¸æ°—ç·šã®é«˜åœ§ãƒ»é«˜æ¸©å´ã®çµ‚ç‚¹ï¼ˆæ¥åˆç‚¹ï¼‰ã‚’è‡¨ç•Œç‚¹ã¨å‘¼ã¶
- ã“ã®ç‚¹ã«ãŠã‘ã‚‹åœ§åŠ›ã‚’è‡¨ç•Œåœ§åŠ›ï¼Œæ¸©åº¦ã‚’è‡¨ç•Œæ¸©åº¦ã¨è¨€ã†
- è‡¨ç•Œç‚¹ä»¥ä¸Šã§ã¯è’¸ç™ºç¾è±¡ã‚‚æ¶²åŒ–ç¾è±¡ã‚‚ãªãï¼Œæ¶²ç›¸ã¨æ°—ç›¸ã®åŒºåˆ¥ã¯ã¤ã‹ãªããªã£ã¦ï¼Œç›¸å¤‰åŒ–ã¯å­˜åœ¨ã—ãªã„

:::

å†·å‡ã‚µã‚¤ã‚¯ãƒ«ã§ã¯å†·åª’ã‚¬ã‚¹ã®æ¶²åŒ–ï¼ˆå‡ç¸®ï¼‰ã®éç¨‹ã‚’å¿…è¦ã¨ã™ã‚‹ã®ã§ï¼Œå†·åª’ã¨ã—ã¦ã¯è‡¨ç•Œç‚¹ï¼ˆè‡¨ç•Œæ¸©åº¦ï¼‰ã¯ æ¶²åŒ–ã•ã›ã‚‹ãŸã‚ã®å†·å´æ°´ã¾ãŸã¯å†·å´ç©ºæ°—ã®æ¸©åº¦ã‚ˆã‚Šè‘—ã—ãé«˜ã„ã“ã¨ãŒå¿…è¦ã¨ãªã‚Šã¾ã™ï¼
@fig-ph-chart ã®ç´«è‰²ç·šã¯è‡¨ç•Œæ¸©åº¦ã¨åŒã˜ç­‰æ¸©ç·šã‚’è¡¨ã—ã¦ã„ã¾ã™ï¼ã“ã®æ¸©åº¦ã‚ˆã‚Šã‚‚é«˜ã„æ¸©åº¦ã§ã¯å†·åª’ã‚’æ¶²åŒ–ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ï¼

```{python}
#| label: fig-ct-table
#| fig-cap: "å†·åª’ã®è‡¨ç•Œæ¸©åº¦ã¨è‡¨ç•Œåœ§åŠ›"
import pandas as pd
ref_list = ['R134a', 'R22', 'R410A', 'R717', 'R744']

ref_list = ['R134a', 'R22', 'R410A', 'R717', 'R744']

records = []
for ref in ref_list:
    T_c = PropsSI('Tcrit', ref)          # [K]
    P_c = PropsSI('Pcrit', ref) / 1e6    # [MPa]
    records.append({'Fluid': ref,
                    'T_crit [K]': T_c,
                    'T_crit [Â°C]': T_c - 273.15,
                    'P_crit [MPa]': P_c})

df = pd.DataFrame(records)
df
```

### R410Aå†·åª’ã‚’ä½¿ã£ãŸç†æƒ³å†·å‡ã‚µã‚¤ã‚¯ãƒ«ã®PHç·šå›³ã®ä½œå›³

::: {#exr- .custom_problem .blog-custom-border}
[R410Aã®PHç·šå›³ä½œå›³]{.def-title}

[å…¥åŠ›æ¡ä»¶]{.mini-section}

:::: {.no-border-top-table}

| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿                  | å€¤     |
| ---------------------- | ----- |
| è’¸ç™ºæ¸©åº¦ $T_{\text{evap}}$ | -15 â„ƒ |
| å‡ç¸®æ¸©åº¦ $T_{\text{cond}}$ | 30 â„ƒ  |
| éå†·å´åº¦                   | 5 â„ƒ   |
| éç†±åº¦                    | 5 â„ƒ   |
| å†·åª’                     | R410A |

::::


:::


::: {.callout-note collapse="false" icon=false}
## Solution

```{python}
import CoolProp.CoolProp as CP

fluid = "R22"

# æ¸©åº¦è¨­å®šï¼ˆã™ã¹ã¦ [K] ã«å¤‰æ›ï¼‰
T_evap = -15 + 273.15  # è’¸ç™ºæ¸©åº¦
T_cond = 30 + 273.15  # å‡ç¸®æ¸©åº¦
dT_subcool = 5  # éå†·å´
dT_superheat = 5  # éç†±

# é£½å’Œåœ§åŠ›ï¼ˆè’¸ç™ºå™¨å´ã¨å‡ç¸®å™¨å´ï¼‰
P_evap = CP.PropsSI(
    "P", "T", T_evap, "Q", 1, fluid
)  # æ¸©åº¦ T_evap ã§å“è³ªï¼ˆä¹¾ãåº¦ï¼‰Q = 1 ã®ã¨ã(=é£½å’Œè’¸æ°—)ã®åœ§åŠ› P
P_cond = CP.PropsSI(
    "P", "T", T_cond, "Q", 0, fluid
)  # æ¸©åº¦ T_cond ã§å“è³ªï¼ˆä¹¾ãåº¦ï¼‰Q = 0 ã®ã¨ãã®åœ§åŠ› P

# çŠ¶æ…‹1: è’¸ç™ºå™¨å‡ºå£ï¼ˆéç†±è’¸æ°—ï¼‰
T1 = T_evap + dT_superheat
h1 = CP.PropsSI("H", "T", T1, "P", P_evap, fluid)
s1 = CP.PropsSI("S", "T", T1, "P", P_evap, fluid)

# çŠ¶æ…‹2: åœ§ç¸®æ©Ÿå‡ºå£ï¼ˆæ–­ç†±åœ§ç¸®ï¼‰
h2 = CP.PropsSI("H", "P", P_cond, "S", s1, fluid)
T2 = CP.PropsSI("T", "P", P_cond, "H", h2, fluid)

# ========= ç­‰ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ç·šã‚’ç”Ÿæˆ =========
# å…¥å£åœ§ï½å‡ºå£åœ§ã¾ã§å¯¾æ•°åˆ»ã¿ã§ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°
P_line = np.logspace(np.log10(P_evap), np.log10(P_cond), 200)  # [Pa]
h_line = CP.PropsSI("H", "P", P_line, "S", s1, fluid)  # [J/kg]

# çŠ¶æ…‹3: å‡ç¸®å™¨å‡ºå£ï¼ˆéå†·å´æ¶²ï¼‰
T3 = T_cond - dT_subcool
h3 = CP.PropsSI("H", "T", T3, "P", P_cond, fluid)

# çŠ¶æ…‹4: è†¨å¼µå¼å‡ºå£ï¼ˆç­‰ã‚¨ãƒ³ã‚¿ãƒ«ãƒ”ãƒ¼è†¨å¼µï¼‰
h4 = h3
T4 = CP.PropsSI("T", "P", P_evap, "H", h4, fluid)

# å†·å‡èƒ½åŠ›ï¼ˆ1 kgã‚ãŸã‚Šï¼‰
q_in = h1 - h4  # è’¸ç™ºå™¨ã§ã®å¸ç†±
w_in = h2 - h1  # åœ§ç¸®æ©Ÿã®ä»•äº‹
q_out = h2 - h3  # å‡ç¸®å™¨ã§ã®æ”¾ç†±
COP = q_in / w_in  # æˆç¸¾ä¿‚æ•°

# çµæœè¡¨ç¤º
print("=== å†·å‡ã‚µã‚¤ã‚¯ãƒ«å„ç‚¹ã®çŠ¶æ…‹ï¼ˆå˜ä½: SIï¼‰ ===")
print(f"çŠ¶æ…‹1ï¼ˆéç†±è’¸æ°—ï¼‰: T={T1 - 273.15:.2f}Â°C, h={h1 / 1000:.2f} kJ/kg")
print(f"çŠ¶æ…‹2ï¼ˆåœ§ç¸®å¾Œï¼‰  : T={T2 - 273.15:.2f}Â°C, h={h2 / 1000:.2f} kJ/kg")
print(f"çŠ¶æ…‹3ï¼ˆéå†·å´æ¶²ï¼‰: T={T3 - 273.15:.2f}Â°C, h={h3 / 1000:.2f} kJ/kg")
print(f"çŠ¶æ…‹4ï¼ˆè†¨å¼µå¾Œï¼‰  : T={T4 - 273.15:.2f}Â°C, h={h4 / 1000:.2f} kJ/kg")

print("\n=== æ€§èƒ½æŒ‡æ¨™ ===")
print(f"å†·å‡èƒ½åŠ› q_in   : {q_in / 1000:.2f} kJ/kg")
print(f"åœ§ç¸®æ©Ÿä»•äº‹ w_in : {w_in / 1000:.2f} kJ/kg")
print(f"COP (æˆç¸¾ä¿‚æ•°)  : {COP:.2f}")

# plot
h_points = [h2 / 1e3, h3 / 1e3, h4 / 1e3, h1 / 1e3]
P_points = [P_cond / 1e6, P_cond / 1e6, P_evap / 1e6, P_evap / 1e6]

plt.figure(figsize=(8, 6))
plt.plot(
    h_points,
    P_points,
    marker="o",
    linestyle="-",
    color="blue",
    label="refrigeration cycle",
)

# Add labels at each point
for i, (h, P) in enumerate(zip(h_points, P_points), start=1):
    plt.text(
        h + 1, P + 0.02, f"{(i % 4) + 1}", fontsize=12, color="black"
    )  # adjust offsets as needed

plt.plot(h_line / 1000, P_line / 1e6, linestyle="-", color="blue")
plt.xlabel("h [kJ/kg]")
plt.ylabel("P [MPa]")
plt.grid(True)

# Saturation curve
T_min = -20 + 273.15
T_crit = 49 + 273.15  # [K]
T_sat = np.linspace(T_min, T_crit - 1e-5, 200)

p_sat = PropsSI("P", "T", T_sat, "Q", 0, fluid)
h_liq = PropsSI("H", "T", T_sat, "Q", 0, fluid) / 1000  # [kJ/kg]
h_vap = PropsSI("H", "T", T_sat, "Q", 1, fluid) / 1000  # [kJ/kg]

plt.plot(h_liq, p_sat / pa_converter, label="Saturated Liquid")
plt.plot(h_vap, p_sat / pa_converter, label="Saturated Vapor")

plt.yscale("log")
plt.xlabel("Enthalpy [kJ/kg]")
plt.ylabel("Pressure [MPa]")
plt.title(f"Pressureâ€“Enthalpy (p-h) Diagram for {fluid}")
plt.legend()
plt.grid(True, which="both", ls=":")
plt.tight_layout()
plt.show()
```

:::

[1â†’2: æ–­ç†±å¤‰åŒ–]{.mini-section}

- è’¸ç™ºå™¨ã‚’å‡ºãŸåŠ ç†±çŠ¶æ…‹ã®å†·åª’è’¸æ°—ã¯ï¼Œåœ§ç¸®æ©Ÿã«å¸ã„è¾¼ã¾ã‚Œã¦ç­‰æ¯”ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã§[å¯é€†æ–­ç†±åœ§ç¸®]{.regmonkey-bold}ã•ã‚Œï¼Œé«˜åœ§ã§åŠ ç†±åº¦ã®å¤§ããªåŠ ç†±è’¸æ°—ã«ãªã£ã¦åãå‡ºã•ã‚Œã‚‹

[2â†’3: ç­‰åœ§å¤‰åŒ–]{.mini-section}

- åœ§ç¸®æ©Ÿã‹ã‚‰åãå‡ºã•ã‚ŒãŸåŠ ç†±ã‚¬ã‚¹ã¯ï¼Œå‡ç¸®å™¨ã§ã®å†·å´ä½œç”¨ã«ã‚ˆã‚Šï¼Œç­‰åœ§ã®ã‚‚ã¨ã§é¡•ç†±ã‚’æ”¾å‡ºã—ã¦é£½å’Œè’¸æ°—ã«ãªã‚‹
- å‡ç¸®è¡Œç¨‹ãŒé€²ã‚€ã«é€£ã‚Œï¼Œå‡ç¸®ã®æ½œç†±ã‚’æ”¾å‡ºã—ã¦æ¹¿ã‚Šè’¸æ°—ã«ãªã‚Šï¼Œæ›´ã«å†·å´ã•ã‚Œã‚‹ã¨ä¹¾ãåº¦ãŒã‚¼ãƒ­ã®é£½å’Œæ¶²ã«ãªã‚‹
- ãã®å¾Œï¼Œé¡•ç†±ã‚’æ”¾å‡ºã—ã¦éå†·å´æ¶²ã«ãªã‚‹

[3â†’4: ç­‰æ¯”ã‚¨ãƒ³ã‚¿ãƒ«ãƒ”ãƒ¼å¤‰åŒ–]{.mini-section}

- è†¨å¼µå¼ã§çµã‚Šè†¨å¼µã•ã‚Œã‚‹
  - çµã‚Šè†¨å¼µ: æµä½“ãŒå¼éƒ¨ãªã©ã®ç‹­ã„é€šè·¯ã‚’é€šéã™ã‚‹éš›ï¼Œæµã‚Œã®æŠµæŠ—ã«ã‚ˆã‚Šåœ§åŠ›ç¡¬åŒ–ã™ã‚‹ç¾è±¡
- ç†±ã¨ä»•äº‹ã®å‡ºå…¥ã‚ŠãŒãªã„ã®ã§æ¯”ã‚¨ãƒ³ã‚¿ãƒ«ãƒ”ãƒ¼ã¯å¤‰åŒ–ã›ãšã«åœ§åŠ›ãŒä¸‹ãŒã‚‹
- é£½å’Œæ¶²ç·šã‚’è¶…ãˆã‚‹ã¨è‡ªèº«ã®ç†±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’è’¸ç™ºã®æ½œç†±ã¨ã—ã¦æ¶ˆè²»ã—ï¼Œæ¹¿ã‚Šè’¸æ°—ã¨ãªã£ã¦è’¸ç™ºå™¨ã«æµå…¥
  - ç™ºç”Ÿã—ãŸè’¸æ°—ã‚’ãƒ•ãƒ©ãƒƒã‚·ãƒ¥è’¸æ°—ã¨å‘¼ã¶
- è†¨å¼µã«ã‚ˆã£ã¦å†·åª’ã®æ¯”ã‚¨ãƒ³ã‚¿ãƒ«ãƒ”ãƒ¼ã¯å¤‰åŒ–ã—ãªã„ãŒï¼Œæ¯”ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã¯å¢—å¤§ã™ã‚‹

[4â†’1: ç­‰åœ§å¤‰åŒ–]{.mini-section}

- å†·åª’ã¯è’¸ç™ºæ°—ã«å…¥ã‚Šï¼Œç­‰åœ§ã®ã‚‚ã¨ã§å¤–éƒ¨ã‹ã‚‰ç†±ã‚’å—ã‘å…¥ã‚Œã‚‹
- å†·åª’æ¶²ã«æ½œç†±ãŒåŠ ãˆã‚‰ã‚Œï¼Œä¹¾ãåº¦ãŒå¤§ãããªã‚Šï¼Œé£½å’Œè’¸æ°—ã¨ãªã‚‹
- æ›´ã«é¡•ç†±ãŒåŠ ãˆã‚‰ã‚Œï¼ŒåŠ ç†±è’¸æ°—ã«ãªã‚Šï¼Œåœ§ç¸®æ©Ÿã«å¸ã„è¾¼ã¾ã‚Œã‚‹

### éå…±æ²¸æ··åˆå†·åª’ã®PHç·šå›³

æ¹¿ã‚Šè’¸æ°—é ˜åŸŸã«ãŠã‘ã‚‹ç­‰æ¸©ç·šã¯ï¼Œå˜ä¸€æˆåˆ†å†·åª’ã§ã¯ç­‰åœ§ç·šã¨ä¸¦è¡Œã§ã™ãŒï¼Œéå…±æ²¸æ··åˆå†·åª’ã§ã¯å³ä¸‹ãŒã‚Šã®å‹¾é…ã‚’æŒã£ãŸç·šã«ãªã‚Šã¾ã™ï¼
æ¹¿ã‚Šè’¸æ°—ãŒåŠ ç†±ï¼ˆè’¸ç™ºå™¨å†…ï¼‰ã¾ãŸã¯å†·å´ï¼ˆå‡ç¸®å™¨å†…ï¼‰ã«ä¼´ã†ç›¸å¤‰åŒ–ã«ã‚ˆã£ã¦ä¹¾ãåº¦ãŒå¤‰åŒ–ã™ã‚‹ã¨ï¼Œæ¹¿ã‚Šè’¸æ°—ä¸­ã®é£½å’Œè’¸æ°—ã¨é£½å’Œæ¶²ã®ã„ãšã‚Œã‚‚æ··åˆçµ„æˆå‰²åˆãŒ
å¤‰ã‚ã‚‹ãŸã‚ï¼Œ[ç­‰æ¸©ã®ã‚‚ã¨ã§ã¯ï¼Œé£½å’Œåœ§åŠ›ãŒå¤‰åŒ–ã™ã‚‹]{.regmonkey-bold}ã“ã¨ã«ã‚ˆã‚‹ï¼

```{python}
# | label: fig-ph-mix-chart
# | fig-cap: ""

fluid = "R407C"  # ä»»æ„ã®å†·åª’ã«å¤‰æ›´å¯
pa_converter = 10**6


def linear_interp_inf(x):
    x = np.array(x)
    mask = np.isfinite(x)  # finiteãªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
    return np.interp(np.arange(len(x)), np.where(mask)[0], x[mask])


# Saturation curve
T_min = PropsSI("Ttriple", fluid) + 1.0  # [K]
T_crit = PropsSI("Tcrit", fluid)  # [K]
T_sat = np.linspace(T_min, T_crit - 1e-5, 200)

p_sat = PropsSI("P", "T", T_sat, "Q", 0, fluid)
h_liq = PropsSI("H", "T", T_sat, "Q", 0, fluid) / 1000  # [kJ/kg]
h_vap = PropsSI("H", "T", T_sat, "Q", 1, fluid) / 1000  # [kJ/kg]

plt.figure(figsize=(8, 6))
plt.plot(h_liq, p_sat / pa_converter, label="Saturated Liquid")
plt.plot(h_vap, p_sat / pa_converter, label="Saturated Vapor")

# é©å½“ãªç­‰æ¸©ç·šï¼ˆä»»æ„ã§ï¼‰
for T_iso in np.linspace(T_crit - 123.5, T_crit + 60, 4):
    p_iso = np.logspace(np.log10(p_sat.min()), np.log10(p_sat.max()), 150)
    h_iso = PropsSI("H", "T", T_iso, "P", p_iso, fluid) / 1000
    h_iso = linear_interp_inf(h_iso)
    plt.plot(
        h_iso,
        p_iso / pa_converter,
        linestyle="-",
        label=f"{T_iso - 273.15:.0f} Â°C Isotherm",
    )

plt.yscale("log")
plt.xlabel("Enthalpy [kJ/kg]")
plt.ylabel("Pressure [MPa]")
plt.title(f"Pressureâ€“Enthalpy (p-h) Diagram for {fluid}")
plt.legend()
plt.grid(True, which="both", ls=":")
plt.tight_layout()
plt.show()
```

::: {#def- .custom_problem .blog-custom-border}
[æ¸©åº¦å‹¾é…]{.def-title}

ã‚ã‚‹ä¸€å®šã®ç­‰åœ§ç·šä¸Šã®æ²¸ç‚¹ã¨éœ²ç‚¹ã®æ¸©åº¦ãŒç•°ãªã‚Šï¼Œéœ²ç‚¹ã«ãŠã‘ã‚‹æ¸©åº¦ã®ã»ã†ãŒæ²¸ç‚¹ã«ãŠã‘ã‚‹æ¸©åº¦ã‚ˆã‚Šã‚‚é«˜ããªã£ã¦ã„ã‚‹ã¨ãï¼Œã“ã®ç­‰åœ§ç·šä¸Šã®æ²¸ç‚¹ã¨éœ²ç‚¹ã¨ã®æ¸©åº¦å·®ã‚’æ¸©åº¦å‹¾é…ã¨å‘¼ã¶

:::

- R404Aã‚„R410Aã¯0.2~0.4Kã®ã‚ªãƒ¼ãƒ€ãƒ¼
- R407Cã¯æ¸©åº¦å‹¾é…ãŒå¤§ãã4.5Kã»ã©

## ğŸ“˜ ç†è§£åº¦ãƒã‚§ãƒƒã‚¯

::: {#exr- .custom_problem .blog-custom-border}
[è‡¨ç•Œæ¸©åº¦]{.def-title}

æ¬¡ã®è¨˜è¿°ã®ã†ã¡æ­£ã—ã„ã‚‚ã®ã¯ã©ã‚Œã‹ï¼Ÿ

a. è‡¨ç•Œç‚¹ã¯ï¼Œæ°—ä½“ã¨æ¶²ä½“ã®åŒºåˆ¥ãŒãªããªã‚‹çŠ¶æ…‹ç‚¹ã§ã‚ã‚‹ï¼ã“ã®è‡¨ç•Œç‚¹ã¯é£½å’Œåœ§åŠ›æ›²ç·šã®çµ‚ç‚¹ã¨ã—ã¦è¡¨ã•ã‚Œã‚‹ï¼è‡¨ç•Œç‚¹ã«ãŠã‘ã‚‹æ¸©åº¦ãŠã‚ˆã³åœ§åŠ›ã‚’è‡¨ç•Œæ¸©åº¦ãŠã‚ˆã³è‡¨ç•Œåœ§åŠ›ã¨ã„ã†ï¼
b. å†·å‡è£…ç½®ã¯ï¼Œé€šå¸¸ï¼Œå‡ç¸®æ¸©åº¦ã‚’å†·åª’ã®è‡¨ç•Œæ¸©åº¦ã‚ˆã‚Šã‚‚é«˜ã„æ¸©åº¦ã§ä½¿ç”¨ã—ã¦ã„ã‚‹

:::

::: {.callout-note collapse="true" icon=false}
## Solution

a

:::

::: {#exr- .custom_problem .blog-custom-border}
[åœ§ç¸®æ©Ÿ]{.def-title}

æ¬¡ã®è¨˜è¿°ã®ã†ã¡æ­£ã—ã„ã‚‚ã®ã¯ã©ã‚Œã‹ï¼Ÿ

a. åœ§ç¸®æ©Ÿã®å¸ã„è¾¼ã¿è’¸æ°—ã®æ¯”ä½“ç©ã‚’ç›´æ¥æ¸¬å®šã™ã‚‹ã®ã¯å›°é›£ã§ã‚ã‚‹ï¼ãã®ãŸã‚ï¼Œå¸ã„è¾¼ã¿è’¸æ°—ã®åœ§åŠ›ã¨æ¸©åº¦ã‚’å›³ã£ã¦ï¼Œãã‚Œã‚‰ã®å€¤ã‹ã‚‰PHç·šå›³ã‚„ç†±åŠ›å­¦æ€§è³ªè¡¨ã‚’ç”¨ã„ã¦å†·åª’ã®æ¯”ä½“ç©ã‚’æ±‚ã‚ã‚‹
b. æ¯”ä½“ç©ã®å˜ä½ã¯ mÂ³/kg ã§ã‚ã‚Šï¼Œæ¯”ä½“ç©ãŒå¤§ãããªã‚‹ã¨å†·åª’è’¸æ°—ã®å¯†åº¦ã¯å°ã•ããªã‚‹
c. åœ§ç¸®æ©Ÿå¸è¾¼ã¿åœ§åŠ›ãŒä½ä¸‹ã™ã‚‹ã¨ï¼Œå¸è¾¼ã¿è’¸æ°—ã®æ¯”ä½“ç©ãŒå¤§ãããªã‚‹ã®ã§ï¼Œåœ§ç¸®æ©Ÿé§†å‹•ã®è»¸å‹•åŠ›ã¯å°ã•ããªã‚‹


:::

::: {.callout-note collapse="true" icon=false}
## Solution

a, b, c

:::

::: {#exr- .custom_problem .blog-custom-border}
[è†¨å¼µå¼]{.def-title}

æ¬¡ã®è¨˜è¿°ã®ã†ã¡æ­£ã—ã„ã‚‚ã®ã¯ã©ã‚Œã‹ï¼Ÿ

a. è†¨å¼µå¼ã¯éå†·å´ã¨ãªã£ãŸå†·åª’æ¶²ã‚’çµã‚Šè†¨å¼µã•ã›ã‚‹ã“ã¨ã§ï¼Œè’¸ç™ºåœ§åŠ›ã¾ã§å†·åª’ã®åœ§åŠ›ã‚’ä¸‹ã’ã‚‹
b. è†¨å¼µå¼ã§è’¸ç™ºåœ§åŠ›ã¾ã§å†·åª’ã®åœ§åŠ›ã‚’ä¸‹ã’ã‚‹éš›ï¼Œä¾‹bå†…ã¯å‘¨å›²ã¨ã®é–“ã§ï¼Œç†±ã¨ä»•äº‹ã®æˆå—ã‚’è¡Œã†ã“ã¨ã§å†·åª’è‡ªèº«ã®æ¸©åº¦ã‚’ä¸‹ã’ã¦ã„ã‚‹

:::

::: {.callout-note collapse="true" icon=false}
## Solution

a,

:::
