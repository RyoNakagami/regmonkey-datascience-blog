---
title: "ç¶™æ‰¿ï¼Œãƒ¡ã‚½ãƒƒãƒ‰ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ï¼Œã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰ã®å‘¼ã³å‡ºã—"
author: "Ryo Nakagami"
date: "2025-11-04"
date-modified: "2025-11-07"
categories: [python]
listing_category: general-series
comments:
  utterances:
       repo: RyoNakagami/regmonkey-datascience-blog
       label: discussion
       issue-term: title
---

## ç¶™æ‰¿(Inheritance)

ã‚µãƒ–ã‚¯ãƒ©ã‚¹ãŒè¦ªã‚¯ãƒ©ã‚¹ã‚’ç¶™æ‰¿ã™ã‚‹ã¨ï¼Œè¦ªã‚¯ãƒ©ã‚¹ã§å®šç¾©ã•ã‚ŒãŸã™ã¹ã¦ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å¼•ãç¶™ãã“ã¨ãŒã§ãã¾ã™ï¼

::: {#def- .custom_problem .blog-custom-border}
[OOPã«ãŠã‘ã‚‹ç¶™æ‰¿]{.def-title}

- ã‚ã‚‹ã‚¯ãƒ©ã‚¹ï¼ˆè¦ªã‚¯ãƒ©ã‚¹ï¼Œã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¹ï¼ŒåŸºåº•ã‚¯ãƒ©ã‚¹ï¼‰ã®æ©Ÿèƒ½ã‚’ï¼Œåˆ¥ã®ã‚¯ãƒ©ã‚¹ï¼ˆå­ã‚¯ãƒ©ã‚¹ï¼Œã‚µãƒ–ã‚¯ãƒ©ã‚¹ï¼Œæ´¾ç”Ÿã‚¯ãƒ©ã‚¹ï¼‰ãŒå¼•ãç¶™ãä»•çµ„ã¿
- **å†åˆ©ç”¨æ€§**: åŒã˜ã‚ˆã†ãªå‡¦ç†ã‚’è¤‡æ•°ã®ã‚¯ãƒ©ã‚¹ã§æ›¸ã‹ã‹ãšã«ï¼Œè¦ªã‚¯ãƒ©ã‚¹ã«ã¾ã¨ã‚ã¦ã—ã¾ã†
- **æ‹¡å¼µæ€§**: è¦ªã‚¯ãƒ©ã‚¹ã®æ©Ÿèƒ½ã‚’ãã®ã¾ã¾ä½¿ã„ã¤ã¤ï¼Œæ–°ã—ã„æŒ¯ã‚‹èˆã„ï¼ˆãƒ¡ã‚½ãƒƒãƒ‰ã‚„å±æ€§ï¼‰ã‚’è¿½åŠ ãƒ»å¤‰æ›´ã§ãã‚‹

:::

::: {#exm- .custom_problem }
### åˆæœŸåŒ–å‡¦ç† `__init__` ã¨ç¶™æ‰¿
<br>

```{python}
#| code-overflow: wrap
#| code-fold: show

class Person:
    def __init__(self, name, nationality):
        self.name = name
        self.nationality = nationality

class FootballPlayer(Person):
    def __init__(self, name, nationality, position, club):
        # è¦ªã‚¯ãƒ©ã‚¹ã®åˆæœŸåŒ–ï¼ˆnameã¨nationalityã‚’è¨­å®šï¼‰
        super().__init__(name, nationality)
        # å­ã‚¯ãƒ©ã‚¹ç‹¬è‡ªã®å±æ€§
        self.position = position
        self.club = club

# ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç”Ÿæˆ
player = FootballPlayer("Kylian MbappÃ©", "France", "Forward", "Real Madrid")

print(player.name)
print(player.nationality)
print(player.position)
print(player.club)
```

:::
---

::: {#exm- .custom_problem }
### `dataclass` ã‚’ç”¨ã„ãŸåˆæœŸåŒ–å‡¦ç†ã¨ç¶™æ‰¿
<br>

```{python}
#| code-overflow: wrap
#| code-fold: show

from dataclasses import dataclass

@dataclass
class Person:
    name: str
    nationality: str

@dataclass
class FootballPlayer(Person):
    position: str
    club: str = 'Arsenal' # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤OK

player = FootballPlayer("Kylian MbappÃ©", "France", "Forward", "Real Madrid")

print(player.name)
print(player.nationality)
print(player.position)
print(player.club)
```

:::
---

::: {#exm- .custom_problem }
### `dataclass` ã‚’ç”¨ã„ãŸåˆæœŸåŒ–å‡¦ç†ã¨ç¶™æ‰¿ with `__post_init__`
<br>

- `dataclass` ã¯ è¦ªã‚¯ãƒ©ã‚¹ â†’ å­ã‚¯ãƒ©ã‚¹ ã®é †ã«ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’çµåˆã—ã¦ `__init__` ã‚’è‡ªå‹•ç”Ÿæˆ
- `super().__init__` ã®è¨­å®šãŒ `dataclass` ç¶™æ‰¿ã§ã¯ä¸è¦ã«ãªã‚‹
- è¦ªã‚¯ãƒ©ã‚¹ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’ç”¨ã„ã¦ã„ã‚‹ã¨å°‘ã—è©±ãŒã‚„ã‚„ã“ã—ããªã‚‹

```{python}
#| code-overflow: wrap
#| code-fold: show

from dataclasses import dataclass

@dataclass
class Person:
    name: str

    def print_name(self):
        print(self.name)

@dataclass
class MDPerson(Person):
    affiliation: str

    def __post_init__(self):
        self.name = f"Doctor {self.name}"

John = MDPerson('John', 'UT')
John.print_name()
```

:::
---

### ãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰

::: {#def- .custom_problem .blog-custom-border}
[ãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰]{.def-title}

- è¦ªã‚¯ãƒ©ã‚¹ï¼ˆã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¹ï¼‰ã§å®šç¾©ã•ã‚ŒãŸãƒ¡ã‚½ãƒƒãƒ‰ã‚’ï¼Œå­ã‚¯ãƒ©ã‚¹ï¼ˆã‚µãƒ–ã‚¯ãƒ©ã‚¹ï¼‰ã§å†å®šç¾©ã—ã¦æŒ¯ã‚‹èˆã„ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨
- Pythonã§ã¯ï¼ŒåŸºæœ¬çš„ã«ã™ã¹ã¦ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒC++ã«ãŠã‘ã‚‹ã€Œä»®æƒ³é–¢æ•°ã€ã«ç›¸å½“ = [ã„ã¤ã§ã‚‚ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰å¯èƒ½]{.regmonkey-bold}
  - `def __methodname(self)` ãªã©ã®ã‚ˆã†ã«privateåŒ–ã§ã‚ã‚‹ç¨‹åº¦é˜²ãã“ã¨ã¯å¯èƒ½

:::

::: {#exm- .custom_problem }
### è¦ªãƒ¡ã‚½ãƒƒãƒ‰ã‚’éƒ¨åˆ†çš„ã«å†åˆ©ç”¨ã™ã‚‹ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰
<br>

```{python}
#| code-overflow: wrap
#| code-fold: show
class Logger:
    def log(self, msg):
        print(f"[LOG] {msg}")

class TimestampLogger(Logger):
    def log(self, msg):
        import datetime
        now = datetime.datetime.now().isoformat()
        super().log(f"{now} - {msg}")

TimestampLogger().log("system started")
```

:::
---

[Coding Style Guide]{.mini-section}

::: {.callout-note}
### OOP Style Guide: Explicitly mark method overrides in subclasses using decorators or documentation.

- `@override` ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ï¼ˆPython 3.12ä»¥é™ or `typing_extensions`çµŒç”±ï¼‰ã‚’ä½¿ã†, xorï¼Œdocstring ã§ã€Œ` """Override of Base.process"""`ã€ã¨æ˜è¨˜ã™ã‚‹
- æ˜ç¢ºãªæ„å›³ãŒãªã„é™ã‚Šï¼ŒåŸºåº•ã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚„å±æ€§ã‚’å†å®šç¾©ã—ãªã„
- å®Ÿè£…ã‚’ç½®ãæ›ãˆã‚‹ã®ã§ã¯ãªãæ‹¡å¼µã™ã‚‹å ´åˆã¯ï¼Œ`super()` ã‚’é©åˆ‡ã«å‘¼ã³å‡ºã™
- åŸºåº•ã‚¯ãƒ©ã‚¹å´ã§ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã‚’æƒ³å®šã—ã¦ã„ãªã„å ´åˆã¯ `__` ã‚’ä»˜ä¸ã—ã¦privateåŒ–ã™ã‚‹

:::

::: {#exm- .custom_problem }
<br>

```{python}
#| code-overflow: wrap
#| code-fold: show

# from typing import override  # Python 3.12ä»¥é™åˆ©ç”¨å¯èƒ½)
from typing_extensions import override  # Python 3.11ãªã©ã§ã¯typing_extensionsçµŒç”±

class Base:
    def process(self, data):
        print("Base processing:", data)

class Derived(Base):
    @override
    def process(self, data):
        """Override of Base.process"""
        print("Derived processing:", data)
        super().process(data)
```


:::
---


### Interface Inheritance vs Implementation Inheritance

::: {#def- .custom_problem .blog-custom-border}
[Implementation Inheritanceï¼ˆå®Ÿè£…ç¶™æ‰¿ï¼‰]{.def-title}

- æ—¢å­˜ã®å‹ã‚’ç‰¹æ®ŠåŒ–ã—ï¼ŒåŸºåº•ã‚¯ãƒ©ã‚¹ã®ã‚³ãƒ¼ãƒ‰ã‚’å†åˆ©ç”¨ã™ã‚‹ç¶™æ‰¿ã®ã“ã¨
- ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ç¶™æ‰¿ä»¥å¤–ã®ç¶™æ‰¿ã¯å®Ÿè£…ç¶™æ‰¿

:::

[Pros]{.mini-section}

- åŸºåº•ã‚¯ãƒ©ã‚¹ã®ã‚³ãƒ¼ãƒ‰ã‚’å†åˆ©ç”¨ã™ã‚‹ã®ã§ï¼Œã‚³ãƒ¼ãƒ‰é‡ã‚’å‰Šæ¸›ã§ãã‚‹
- ç¶™æ‰¿é–¢ä¿‚ã¯ã‚¯ãƒ©ã‚¹å®šç¾©æ™‚ï¼ˆã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ç›¸å½“ï¼‰ã«æ˜ç¤ºã•ã‚Œã‚‹ãŸã‚ï¼Œé™çš„è§£æãƒ„ãƒ¼ãƒ«ãŒãã®æ§‹é€ ã‚’ç†è§£ã—ã‚„ã™ãï¼Œå®šç¾©ãƒŸã‚¹ï¼ˆä¾‹: æœªå®Ÿè£…ãƒ¡ã‚½ãƒƒãƒ‰ã‚„èª¤ã£ãŸã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ï¼‰ã‚’æ—©æœŸã«æ¤œå‡ºã§ãã‚‹


[Cons]{.mini-section}

- åŸºåº•ã‚¯ãƒ©ã‚¹ã¨ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã«å®Ÿè£…ãŒåˆ†æ•£ã™ã‚‹ãŸã‚ï¼Œã‚¯ãƒ©ã‚¹éšå±¤ã‚’è¿½ã„ã‹ã‘ãªã‘ã‚Œã°æŒ™å‹•ã‚’ç†è§£ã§ããªã„
- ã€Œä¸Šæ›¸ãã™ã¹ãã§ãªã„ãƒ¡ã‚½ãƒƒãƒ‰ã€ã‚’èª¤ã£ã¦ä¸Šæ›¸ãã—ã¦ã—ã¾ã†ãƒªã‚¹ã‚¯ãŒã‚ã‚‹
- å®Ÿè¡Œæ™‚ã«**ãƒ¡ã‚½ãƒƒãƒ‰è§£æ±ºé †åºï¼ˆMROï¼‰**ã‚’ãŸã©ã‚‹ãŸã‚ï¼Œãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒä½ä¸‹ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹
- å¤šé‡ç¶™æ‰¿æ™‚ã«ï¼Œ**ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ç¶™æ‰¿å•é¡Œ**ï¼ˆåŒä¸€ç¥–å…ˆã‚’è¤‡æ•°çµŒè·¯ã§ç¶™æ‰¿ã™ã‚‹å½¢ï¼‰ãŒç™ºç”Ÿã™ã‚‹ãƒªã‚¹ã‚¯ãŒã‚ã‚‹

[Coding Style Guide]{.mini-section}

::: {.callout-note}
### OOP Style Guide: Keep inheritance hierarchies as shallow as possible â€” ideally within one or two levels.

- ç¶™æ‰¿éšå±¤ã¯ã§ãã‚‹ã ã‘æµ…ãä¿ã¡ï¼Œç†æƒ³çš„ã«ã¯1ã€œ2æ®µéšä»¥å†…ã«ã¨ã©ã‚ã‚‹
- å¤šé‡ç¶™æ‰¿è‡ªä½“ã¯è¨±å®¹ã•ã‚Œã‚‹ãŒï¼Œå¤šé‡å®Ÿè£…ç¶™æ‰¿ã¯åŸºæœ¬çš„ã«ã¯éæ¨å¥¨
- ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ç¶™æ‰¿ã¯ç‰¹ã«é¿ã‘ã‚‹ã¹ã

:::

::: {#exm- .custom_problem }
### ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³
<br>

```{python}
#| code-overflow: wrap
#| code-fold: show

class Device:
    def power_on(self):
        print("Power on")

class NetworkDevice(Device):
    def connect(self):
        print("Connect to network")

class SmartDevice(Device):
    def connect(self):
        print("Connect to app")

# Diamond inheritance: both inherit from Device
class SmartNetworkDevice(SmartDevice, NetworkDevice):
    def sync(self):
        print("Syncing data")

# Ambiguity: which connect() should be used?
snd = SmartNetworkDevice()
snd.connect()  # -> Which one? Depends on MRO (method resolution order)
```

:::
---

::: {#def- .custom_problem .blog-custom-border}
[ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ç¶™æ‰¿]{.def-title}

- æŠ½è±¡ã‚¯ãƒ©ã‚¹ã‚’è¦ªã‚¯ãƒ©ã‚¹ã¨ã™ã‚‹ç¶™æ‰¿ã®ã“ã¨
- ã‚¯ãƒ©ã‚¹ã«ç‰¹å®šã®ãƒ¡ã‚½ãƒƒãƒ‰ç¾¤ã®å®Ÿè£…ã‚’å¼·åˆ¶ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ç¶™æ‰¿å½¢æ…‹
- åŒä¸€APIã‚’è¤‡æ•°ã‚¯ãƒ©ã‚¹ã§çµ±ä¸€çš„ã«æä¾›ã—ãŸã„ã¨ãã«ç‰¹ã«åˆ©ç”¨ã•ã‚Œã‚‹
- ã€Œä½•ã‚’ã§ãã‚‹ã‹ï¼ˆwhatï¼‰ã€ã‚’å®£è¨€ã—ï¼Œã€Œã©ã†å®Ÿè£…ã™ã‚‹ã‹ï¼ˆhowï¼‰ã€ã¯ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã«å§”ã­ã‚‹

:::

::: {#exm- .custom_problem }
### Abstract Base Classã‚’ç”¨ã„ãŸã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ç¶™æ‰¿
<br>

```{python}
#| code-overflow: wrap
#| code-fold: show

from abc import ABC, abstractmethod

class Serializer(ABC):
    @abstractmethod
    def serialize(self, data):
        pass

class JsonSerializer(Serializer):
    def serialize(self, data):
        import json
        return json.dumps(data)

def save_data(serializer: Serializer, data):
    print(serializer.serialize(data))

# Unified interface:
save_data(JsonSerializer(), {"foo": "bar"})
```

:::
---

[Pros]{.mini-section}

- æ˜ç¤ºçš„ãªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å¥‘ç´„ã«ã‚ˆã‚Šï¼ŒAPIã®ä¸€è²«æ€§ã¨å¯èª­æ€§ã‚’é«˜ã‚ã‚‰ã‚Œã‚‹
- IDEè£œå®Œãƒ»å‹ãƒã‚§ãƒƒã‚¯ãƒ»é™çš„è§£æãŒæ©Ÿèƒ½ã™ã‚‹
- è¨­è¨ˆæ®µéšã§ã€Œå®Ÿè£…æ¼ã‚Œã€ã‚„ã€Œèª¤å®Ÿè£…ã€ã‚’æ¤œå‡ºã§ãã‚‹
- ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹æº–å‚™ãŒå®¹æ˜“ã«ãªã‚‹

[Cons]{.mini-section}

- å°è¦æ¨¡ã‚³ãƒ¼ãƒ‰ã§ã¯éå‰°è¨­è¨ˆã«ãªã‚ŠãŒã¡(ãã‚‚ãã‚‚æŠ½è±¡ã‚¯ãƒ©ã‚¹ãŒå¿…è¦ã§ã¯ãªã„å¯èƒ½æ€§ãŒã‚ã‚‹)
- æŠ½è±¡ã‚¯ãƒ©ã‚¹ãŒè‚¥å¤§åŒ–ã™ã‚‹ã¨ï¼Œä¸è¦ãªãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè£…ã‚’å¼·åˆ¶ã•ã‚Œã‚‹å ´åˆãŒã‚ã‚‹
- APIå¤‰æ›´æ™‚ã«å…¨å®Ÿè£…ã‚¯ãƒ©ã‚¹ã®ä¿®æ­£ãŒå¿…è¦ã«ãªã‚‹ï¼ˆä¿å®ˆã‚³ã‚¹ãƒˆã®å¢—å¤§ï¼‰
- ã‚ã–ã‚ã–ç¶™æ‰¿ã‚’ä½¿ã†ã®ã§ã¯ãªãï¼Œãƒ€ãƒƒã‚¯ã‚¿ã‚¤ãƒ”ãƒ³ã‚° + ã‚³ãƒ³ãƒã‚¸ã‚·ãƒ§ãƒ³ã§ååˆ†ãªã‚±ãƒ¼ã‚¹ã‚‚ã‚ã‚‹
- å®Ÿè£…ç¶™æ‰¿ã¨ç•°ãªã‚Šï¼Œã‚³ãƒ¼ãƒ‰å†åˆ©ç”¨ã«ã‚ˆã‚‹çŸ­ç¸®åŠ¹æœã¯ãªã„

[Coding Style Guide]{.mini-section}

::: {.callout-note}
### OOP Style Guide: Define clear, minimal, and stable interfaces.

- ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¯å¿…è¦æœ€å°é™ã®ãƒ¡ã‚½ãƒƒãƒ‰ã«ã¨ã©ã‚ã‚‹
- å…±é€šAPIã‚’æŠ½è±¡ã‚¯ãƒ©ã‚¹ã‚’ç”¨ã„ã¦å®šç¾©ã™ã‚‹å ´åˆã¯ï¼Œèª¬æ˜ç”¨documentã‚’ç”¨æ„ã™ã‚‹ã“ã¨

ä¾‹: ã™ã¹ã¦ã®æ¨å®šå™¨ãƒ»äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã¯ `BaseEstimatorï¼ˆABCï¼‰`ã‚’ç¶™æ‰¿ã—ï¼Œæœ€ä½é™ `fit(X, y)`, `predict(X)` ã‚’å®šç¾©ã—ï¼Œå¿…è¦ã«å¿œã˜ã¦`score(X, y)`ã‚’è¿½åŠ ã™ã‚‹

:::

::: {#exm- .custom_problem }
### çµ±è¨ˆæ¨å®šé‡ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ç”¨ã®å®Ÿè£…ä¾‹
<br>

```{python}
#| code-overflow: wrap
#| code-fold: show

from abc import ABC, abstractmethod
import numpy as np

class BaseEstimator(ABC):
    """Abstract base class for all estimators.

    Rules:
        - Require fit() and predict() methods
        - Optionally define score()
    """

    @abstractmethod
    def fit(self, X: np.ndarray, y: np.ndarray):
        """Fit model to data."""
        pass

    @abstractmethod
    def predict(self, X: np.ndarray) -> np.ndarray:
        """Predict from model."""
        pass

    def score(self, X: np.ndarray, y: np.ndarray) -> float:
        """Optional: default scoring by R^2."""
        y_pred = self.predict(X)
        u = ((y - y_pred) ** 2).sum()
        v = ((y - y.mean()) ** 2).sum()
        return 1 - u / v

class LinearRegression(BaseEstimator):
    """Ordinary Least Squares Estimator."""

    def __init__(self):
        self.coef_ = None
        self.intercept_ = None

    def fit(self, X: np.ndarray, y: np.ndarray):
        X_ = np.c_[np.ones(X.shape[0]), X]
        beta = np.linalg.pinv(X_.T @ X_) @ X_.T @ y
        self.intercept_ = beta[0]
        self.coef_ = beta[1:]
        return self

    def predict(self, X: np.ndarray) -> np.ndarray:
        return X @ self.coef_ + self.intercept_
```

Then,

```{python}
#| code-overflow: wrap
#| code-fold: show
#| 
X = np.random.rand(100, 3)
y = X @ np.array([1.2, -0.7, 0.3]) + 0.5 + np.random.randn(100) * 0.05

model = LinearRegression()
model.fit(X, y)
print("R^2:", model.score(X, y))
```

:::
---

### ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å±æ€§ãƒ»ãƒ¡ã‚½ãƒƒãƒ‰ã¨ `public` / `protected` / `private` ã®æ•´ç†

ç¶™æ‰¿ã®æ–‡è„ˆã«ãŠã„ã¦ï¼ŒC++ã§ã¯ã€Œ**ãƒ‡ãƒ¼ã‚¿ãƒ¡ãƒ³ãƒãƒ¼ã¯privateã«ã™ã¹ã**ã€ã¨ã•ã‚Œã¾ã™ãŒï¼Œ

- C++ ã¨ç•°ãªã‚Šï¼ŒPythonã¯ã™ã¹ã¦ã®å±æ€§ã¨ãƒ¡ã‚½ãƒƒãƒ‰ãŒå…¬é–‹ãŒåŸºæœ¬
- è¦ªã‚¯ãƒ©ã‚¹ã®å±æ€§ã‚’å®Œå…¨ã«privateçš„ã«é‹ç”¨ï¼ˆåå‰ãƒãƒ³ã‚°ãƒªãƒ³ã‚°ï¼‰ã—ã¦ã—ã¾ã†ã¨ç¶™æ‰¿ã®æŸ”è»Ÿæ€§ãŒå¤§ããå¤±ã‚ã‚Œã‚‹

ã¨ã„ã†ç†ç”±ã‹ã‚‰ï¼Œprivate(`__name`) ã‚ˆã‚Šã‹ã¯protected(`_name`) ã¨ã„ã†é‹ç”¨ã®ã»ã†ãŒå¥½ã¾ã—ã„ã¨ã•ã‚Œã¾ã™ï¼

:::: {.no-border-top-table}

| ç›®çš„       | Pythonã§ã®å‘½å | ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã‹ã‚‰ | å¤–éƒ¨ã‚³ãƒ¼ãƒ‰ã‹ã‚‰ | å‚™è€ƒ               |
| -------- | ---------- | ------- | ------- | ---------------- |
| å…¬é–‹API    | `name`     | âœ…       | âœ…       | åˆ©ç”¨è€…å‘ã‘ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ |
| ç¶™æ‰¿å‘ã‘å†…éƒ¨å±æ€§ | `_name`    | âœ…       | âš ï¸ï¼ˆéæ¨å¥¨ï¼‰ | ç¶™æ‰¿æ‹¡å¼µã§ä½¿ã†ãƒ‡ãƒ¼ã‚¿ãƒ¡ãƒ³ãƒãƒ¼   |
| å®Œå…¨ã«å†…éƒ¨é™å®š  | `__name`   | âŒ       | âŒ       | ç¶™æ‰¿ã—ãªã„å‰æã§ã®å†…éƒ¨å®Ÿè£…ç”¨   |

::::

### Propertyã®æ´»ç”¨

APIè¨­è¨ˆã®è¦³ç‚¹ã‹ã‚‰èª­ã¿å–ã‚Šå°‚ç”¨ã®å€¤ã‚„æ´¾ç”Ÿå€¤ã‚’è¿”ã™å ´åˆï¼Œ`getter` ã ã‘ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä½œæˆã—ã¦ï¼Œ`setter` ã‚’ä¸è¦ã«ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ï¼

::: {#exm- .custom_problem }
<br>

```python
from abc import ABC, abstractmethod

class BaseEstimator(ABC):
    @abstractmethod
    def fit(self, X, y):
        pass

    @abstractmethod
    def predict(self, X):
        pass

class LinearEstimator(BaseEstimator):
    def __init__(self):
        self._weights = None  # protectedå±æ€§ã¨ã—ã¦ä¿æŒ

    @property
    def weights(self):
        """è»½å¾®ãªè¨ˆç®—ã‚„æ¤œè¨¼ã‚’ä¼´ã†æ´¾ç”Ÿå€¤ã‚’è¿”ã™"""
        if self._weights is None:
            raise ValueError("Estimator has not been fitted yet")
        return self._weights
```

- `weights` ã¯è¨ˆç®—ã‚„çŠ¶æ…‹ç¢ºèªã‚’ä¼´ã†ãŸã‚ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨ã—ã¦æä¾›
- `fit()` / `predict()` ã¯å¿…é ˆã®å…¬é–‹API
- å†…éƒ¨çŠ¶æ…‹ `_weights` ã¯ protected ã¨ã—ï¼Œç›´æ¥æ“ä½œã•ã›ãªã„

:::
---

::: {.callout-note}
### OOP Style Guide: Use Properties to expose minimal and predictable attribute APIs

- å±æ€§ã‚¢ã‚¯ã‚»ã‚¹ã®APIã‚’æä¾›ã™ã‚‹å ´åˆï¼Œãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯è»½é‡ãªè¨ˆç®—ã‚„åˆ¶ç´„ãƒã‚§ãƒƒã‚¯ãŒã‚ã‚‹å ´åˆã®ã¿ä½¿ç”¨
- èª­ã¿å–ã‚Šå°‚ç”¨ã®å€¤ã‚„æ´¾ç”Ÿå€¤ã‚’è¿”ã™å ´åˆï¼Œ`getter` ã ã‘ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä½œæˆã—ã¦ï¼Œ`setter` ã‚’ä¸è¦ã«ã™ã‚‹

:::


### ä¾‹å¤–çš„ãªçŠ¶æ³ã‚’è¦—ã„ã¦ `staticmethod` ã¯ä½¿ç”¨ã—ãªã„

::: {#def- .custom_problem .blog-custom-border}
[staticmethod]{.def-title}

- ã‚¯ãƒ©ã‚¹ã«å±ã™ã‚‹ãŒï¼Œã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ (`self`) ã‚„ã‚¯ãƒ©ã‚¹ (`cls`) ã«ä¾å­˜ã—ãªã„ãƒ¡ã‚½ãƒƒãƒ‰
- å®Ÿéš›ã«ã¯å˜ãªã‚‹ã€Œãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é–¢æ•°ã€ã‚’ã‚¯ãƒ©ã‚¹å†…ã«ç½®ã„ãŸå½¢

:::

::: {#exm- .custom_problem }
<br>

- `self.__class__` ã¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ã‚¯ãƒ©ã‚¹ã‚’å‚ç…§ã™ã‚‹ã®ã§ï¼Œ`staticmethod` ã‚‚å‘¼ã³å‡ºã—å¯èƒ½
- `<Class>`ã§ã‚‚å‚ç…§å¯èƒ½(`CoyoteWeapon.commercial()`)

```{python}
#| code-overflow: wrap
#| code-fold: show

from dataclasses import dataclass

@dataclass
class CoyoteWeapon:
    name: str
    power: int

    @staticmethod
    def commercial():
        print("This is Coyote Weapon")

    def info(self):
        self.__class__.commercial()
        print(f"Weapon: {self.name}, Power: {self.power}")

# ã‚¯ãƒ©ã‚¹åã‹ã‚‰ staticmethod ã‚’å‘¼ã³å‡ºã™
CoyoteWeapon.commercial()  # â†’ This is Coyote Weapon

# ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œã£ã¦ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã¶
weapon = CoyoteWeapon(name="Rocket Launcher", power=9000)
weapon.info()
```
:::
---

[Coding Style Guide]{.mini-section}

::: {.callout-note}
### OOP Style Guide: Avoid staticmethod unless API requires it

- `staticmethod` ã®ä¹±ç”¨ã‚’é¿ã‘ï¼Œãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ¬ãƒ™ãƒ«é–¢æ•°ã§åŸºæœ¬å¯¾å¿œã™ã‚‹
- MLflowãªã©ã®APIå´ãŒå®Ÿè£…ã‚’è¦æ±‚ã™ã‚‹å ´åˆã®ã¿åˆ©ç”¨ã™ã‚‹

:::

### `classmethod` ã¯é™å®šçš„ã«åˆ©ç”¨ã™ã‚‹

::: {#def- .custom_problem .blog-custom-border}
[classmethod]{.def-title}

- ã‚¯ãƒ©ã‚¹å…¨ä½“ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹method

:::

[Coding Style Guide]{.mini-section}

::: {.callout-note}
### OOP Style Guide: Use classmethod only when writing a named constructor, or a class-specific routine that modifies necessary global state such as a process-wide cache.

- åå‰ä»˜ãã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ ã‚„ã€€ã‚¯ãƒ©ã‚¹å›ºæœ‰ã®å‡¦ç†ï¼ˆä¾‹: ãƒ—ãƒ­ã‚»ã‚¹å…¨ä½“ã§ä½¿ã†ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®åˆæœŸåŒ–ãªã©ï¼‰ã§ã®ã¿ä½¿ç”¨

:::

::: {#exm- .custom_problem }
### åå‰ä»˜ãã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿
<br>

- é€šå¸¸ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ `__init__` ã¨ã¯åˆ¥ã«ï¼Œã‚¯ãƒ©ã‚¹ã‚’åˆæœŸåŒ–ã™ã‚‹è£œåŠ©çš„ãªã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’ä½œã‚ŠãŸã„å ´åˆã«ä½¿ã†

```{python}
#| code-overflow: wrap
#| code-fold: show

from dataclasses import dataclass

@dataclass
class Rectangle:
    width: float
    height: float

    @classmethod
    def from_square(cls, side_length: float):
        """æ­£æ–¹å½¢ã‹ã‚‰ Rectangle ã‚’ä½œã‚‹åå‰ä»˜ãã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿"""
        return cls(width=side_length, height=side_length)


# ä½¿ç”¨ä¾‹
r = Rectangle.from_square(5)
print(r)  # Rectangle(width=5, height=5)
```
:::
---

::: {#exm- .custom_problem }
<br>

- `_global_cache` ã¯ã‚¯ãƒ©ã‚¹å…¨ä½“ã§å…±æœ‰ã•ã‚Œã‚‹çŠ¶æ…‹
- `classmethod` ã‚’ä½¿ã†ã“ã¨ã§ï¼Œã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã›ãšã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½

```{python}
#| code-overflow: wrap
#| code-fold: show

class Cache:
    _global_cache = {}

    @classmethod
    def set(cls, key, value):
        cls._global_cache[key] = value

    @classmethod
    def get(cls, key):
        return cls._global_cache.get(key)

# ä½¿ç”¨ä¾‹
Cache.set("x", 100)
print(Cache.get("x")) 
```

:::
---


## ã‚³ãƒ³ãƒã‚¸ã‚·ãƒ§ãƒ³(Composition)

ç¶™æ‰¿(Inhertitance)ã¯ï¼Œã€Œclass Aã¯ class Bã®ä¸€ç¨®ã€ã¨ã„ã†æ€æƒ³ãŒèƒŒæ™¯ã«ã‚ã‚Šã¾ã™ãŒï¼Œ

- ã‚¢ãƒ’ãƒ«ã¯é³¥ã§ã‚ã‚‹ã¨åŒæ™‚ã«ãã¡ã°ã—ã‚„ã—ã£ã½ã‚’æŒã£ã¦ã„ã‚‹

ã¨ã„ã†ã‚ˆã†ãªA(ã‚¢ãƒ’ãƒ«)ã¯B(ãã¡ã°ã—ã‚„ã—ã£ã½)ã‚’æœ‰ã—ã¦ã„ã‚‹(A-has-B logic)ã®å ´åˆã¯ï¼Œã‚³ãƒ³ãƒã‚¸ã‚·ãƒ§ãƒ³ï¼ˆcompositionï¼‰ã‚’ä½¿ã†ã¹ãã¨ã•ã‚Œã¾ã™ï¼

::: {#exm- .custom_problem }
### ğŸ¦† ã‚³ãƒ³ãƒã‚¸ã‚·ãƒ§ãƒ³ï¼ˆA-has-B logic
<br>

```{python}
#| code-overflow: wrap
#| code-fold: show

from dataclasses import dataclass

@dataclass
class Bill:
    length_cm: float
    color: str

    def quack_sound(self):
        return "Quack!"


@dataclass
class Tail:
    length_cm: float
    fluffiness: int  # 1ã€œ10æ®µéš

    def wag(self):
        return "Tail wagging gracefully"


@dataclass
class Bird:
    species: str

    def fly(self):
        return f"{self.species} is flying!"


@dataclass
class Duck(Bird):
    bill: Bill
    tail: Tail

    def describe(self):
        return (
            f"This is a {self.species}.\n"
            f"Bill: {self.bill.length_cm}cm, color {self.bill.color}\n"
            f"Tail: {self.tail.length_cm}cm, fluffiness {self.tail.fluffiness}"
        )

    def quack(self):
        return self.bill.quack_sound()

    def wag_tail(self):
        return self.tail.wag()

duck = Duck(
    species="Mallard",
    bill=Bill(length_cm=6.5, color="yellow"),
    tail=Tail(length_cm=8.0, fluffiness=7)
)

print(duck.describe())
print(duck.fly())
print(duck.quack())
print(duck.wag_tail())
```

:::
---

### Composition vs Inheritance

::: {.callout-note}
### OOP Style Guide: Composition is often more appropriate than inheritance

- ç¶™æ‰¿ã¯æ…é‡ã«ä½¿ã„ï¼Œã¾ãšã¯ã€Œã‚³ãƒ³ãƒã‚¸ã‚·ãƒ§ãƒ³ï¼ˆcompositionï¼‰ã€ã‚’è€ƒãˆã‚‹ã¹ã
- ã€Œéƒ¨å“ã®å…¥ã‚Œæ›¿ãˆã€ãŒå¿…è¦ãªå ´åˆã‚„è²¬å‹™ã‚’åˆ†é›¢ã—ãŸã„ã€å ´åˆï¼ŒCompositionãŒæœ‰åŠ¹

:::

:::: {.no-border-top-table}

| é …ç›®  | ç¶™æ‰¿ (Inheritance)    | ã‚³ãƒ³ãƒã‚¸ã‚·ãƒ§ãƒ³ (Composition)                                   |
| --- | ------------------- | ------------------------------------------------------- |
| é–¢ä¿‚  | is-aï¼ˆã€œã¯ã€œã§ã‚ã‚‹ï¼‰        | has-aï¼ˆã€œã‚’æŒã£ã¦ã„ã‚‹ï¼‰                                          |
| å†åˆ©ç”¨ | è¦ªã‚¯ãƒ©ã‚¹ã®æ©Ÿèƒ½ã‚’å¼•ãç¶™ã        | ä»–ã‚¯ãƒ©ã‚¹ã®æ©Ÿèƒ½ã‚’å†…éƒ¨ã§ä½¿ã†                                           |
| æŸ”è»Ÿæ€§ | ä½ã„ï¼ˆæ§‹é€ ãŒå›ºå®šï¼‰           | é«˜ã„ï¼ˆå…¥ã‚Œæ›¿ãˆã‚„æ‹¡å¼µãŒå®¹æ˜“ï¼‰                                          |
| çµåˆåº¦ | å¼·ã„                  | å¼±ã„ï¼ˆç–çµåˆï¼‰                                                 |
: {tbl-colwidths="[20,40,40]"}

::::

## Appendix
### ãƒ€ãƒƒã‚¯ã‚¿ã‚¤ãƒ”ãƒ³ã‚° vs ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ç¶™æ‰¿

:::: {.no-border-top-table}

| è¦³ç‚¹              | ãƒ€ãƒƒã‚¯ã‚¿ã‚¤ãƒ”ãƒ³ã‚°                                                         | ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ç¶™æ‰¿                                            |
| --------------- | ---------------------------------------------------------------- | ----------------------------------------------------- |
| **å®šç¾©**          | ã€Œ**è¦‹ãŸç›®ãŒã‚¢ãƒ’ãƒ«ãªã‚‰ã‚¢ãƒ’ãƒ«**ã€ã®åŸå‰‡ã«åŸºã¥ãï¼Œã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å‹ã§ã¯ãªã**æŒ¯ã‚‹èˆã„ï¼ˆãƒ¡ã‚½ãƒƒãƒ‰ã‚„å±æ€§ã®å­˜åœ¨ï¼‰**ã§åˆ¤æ–­ã™ã‚‹ | æŠ½è±¡ã‚¯ãƒ©ã‚¹ï¼ˆABCï¼‰ã‚’ä»‹ã—ã¦ï¼Œ**ç‰¹å®šã®ãƒ¡ã‚½ãƒƒãƒ‰ç¾¤ã‚’å¿…ãšå®Ÿè£…**ã™ã‚‹ã“ã¨ã‚’å¼·åˆ¶ã™ã‚‹ä»•çµ„ã¿         |
| **Python çš„å®Ÿè£…ä¾‹** | `fit()` ã¨ `predict()` ã‚’æŒã£ã¦ã„ã‚Œã° Estimator ã¨ã—ã¦æ‰±ã†ï¼ˆScikit-Learn æµï¼‰   | `Estimator` æŠ½è±¡åŸºåº•ã‚¯ãƒ©ã‚¹ã‚’ç¶™æ‰¿ã—ï¼Œ`fit()`ãƒ»`predict()` ã®å®šç¾©ã‚’å¼·åˆ¶ã™ã‚‹ |
: {tbl-colwidths="[20,40,40]"}

::::


References
----------
- [Google C++ Style Guide](https://google.github.io/styleguide/cppguide.html)
- [Google Python Style Guide](https://google.github.io/styleguide/pyguide.html)
- [Pythonã«ãŠã‘ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã‚¯ãƒ©ã‚¹](../2025-11-03-python-class-101/index.html)
