<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>regmonkey datascience blog</title>
<link>https://ryonakagami.github.io/regmonkey-datascience-blog/</link>
<atom:link href="https://ryonakagami.github.io/regmonkey-datascience-blog/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.6.43</generator>
<lastBuildDate>Tue, 08 Apr 2025 00:00:00 GMT</lastBuildDate>
<item>
  <title>確率行列と固有値</title>
  <dc:creator>Ryo Nakagami</dc:creator>
  <link>https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-04-08-probability-matrix-exercise/</link>
  <description><![CDATA[ 





<section id="problem" class="level2">
<h2 class="anchored" data-anchor-id="problem">Problem</h2>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="exr-" class="custom_problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1</strong></span> <br></p>
<p><img src="https://latex.codecogs.com/png.latex?n"> 次非負実行列 <img src="https://latex.codecogs.com/png.latex?A%20=%20(a_%7Bij%7D)"> が</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7Bj=1%7D%5En%20a_%7Bij%7D%20=%201%0A"></p>
<p>を満たすとき，<img src="https://latex.codecogs.com/png.latex?A"> を確率行列と呼ぶ． このとき，以下が成立することを示せ</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%5Cpmb%20f%20=%20%5Cpmb%20f%0A"></p>
<p>ただし，<img src="https://latex.codecogs.com/png.latex?%5Cpmb%20f%20=%20(1,%20%5Ccdots%201)%5ET">， つまり <img src="https://latex.codecogs.com/png.latex?%5Cpmb%20f"> はすべての成分が1であるような <img src="https://latex.codecogs.com/png.latex?n">項列ベクトルであるとする．</p>
</div>
</div>
<!--::: {.callout-note collapse="true" icon=false}-->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?A%5Cpmb%20f"> は <img src="https://latex.codecogs.com/png.latex?n"> 項列ベクトルとなるので，その第 <img src="https://latex.codecogs.com/png.latex?i"> 項成分を <img src="https://latex.codecogs.com/png.latex?b_i"> とすると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0Ab_i%0A%20%20%20%20&amp;=%20%5Csum_%7Bj=1%7D%5En%20a_%7Bij%7Df_j%5C%5C%0A%20%20%20%20&amp;=%20%5Csum_%7Bj=1%7D%5En%20a_%7Bij%7D%20%5Cquad%20(%5Cbecause%20f_j%20=%201)%5C%5C%0A%20%20%20%20&amp;=%201%0A%5Cend%7Balign%7D%0A"></p>
<p>従って，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%5Cpmb%20f%20=%20(1,%20%5Ccdots,%201)%5ET%20=%20%5Cpmb%20f%0A"></p>
</div>
</div>
</div>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="exr-" class="custom_problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2</strong></span> <br></p>
<p><img src="https://latex.codecogs.com/png.latex?A,%20B"> が <img src="https://latex.codecogs.com/png.latex?n"> 次確率行列であるとき，<img src="https://latex.codecogs.com/png.latex?AB"> も確率行列であることを示せ</p>
</div>
</div>
<!--::: {.callout-note collapse="true" icon=false}-->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?AB%20=%20(c_%7Bij%7D)"> とするとき，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0Ac_%7Bij%7D%20=%20%5Csum_%7Bk=1%7D%5En%20a_%7Bik%7Db_%7Bkj%7D%0A%5Cend%7Balign%7D%0A"></p>
<p>となります．このとき</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Csum_%7Bj=1%7D%5En%20c_%7Bij%7D%0A%20%20%20%20&amp;=%20%5Csum_%7Bj=1%7D%5En%5Csum_%7Bk=1%7D%5En%20a_%7Bik%7Db_%7Bkj%7D%5C%5C%0A%20%20%20%20&amp;=%20%5Csum_%7Bk=1%7D%5En%5Csum_%7Bj=1%7D%5En%20a_%7Bik%7Db_%7Bkj%7D%5C%5C%0A%20%20%20%20&amp;=%20%5Csum_%7Bk=1%7D%5En%20a_%7Bik%7D(%5Csum_%7Bj=1%7D%5En%20b_%7Bkj%7D)%5C%5C%0A%20%20%20%20&amp;=%20%5Csum_%7Bk=1%7D%5En%20a_%7Bik%7D%20%5Cquad%20(%5Cbecause%20%5Csum_%7Bj=1%7D%5En%20b_%7Bkj%7D%20=%201)%5C%5C%0A%20%20%20%20&amp;=%201%0A%5Cend%7Balign%7D%0A"></p>
<p>従って，<img src="https://latex.codecogs.com/png.latex?A,%20B"> が <img src="https://latex.codecogs.com/png.latex?n"> 次確率行列であるとき，<img src="https://latex.codecogs.com/png.latex?AB"> も確率行列である．</p>
</div>
</div>
</div>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="exr-" class="custom_problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3</strong></span> <br></p>
<p><img src="https://latex.codecogs.com/png.latex?A"> が確率行列のとき，複素数 <img src="https://latex.codecogs.com/png.latex?%5Clambda"> に対して <img src="https://latex.codecogs.com/png.latex?A%5Cpmb%20x%20=%20%5Clambda%20%5Cpmb%20x"> となるような列ベクトル <img src="https://latex.codecogs.com/png.latex?%5Cpmb%20x%20%5Cneq%20%5Cpmb%200"> が存在すれば</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%7C%5Clambda%7C%20%5Cleq%201%0A"></p>
<p>となることを示せ．</p>
</div>
</div>
<!--::: {.callout-note collapse="true" icon=false}-->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5Cpmb%20x"> の成分のうち絶対値が最大となるような成分を <img src="https://latex.codecogs.com/png.latex?%7Cx_p%7C"> とすると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Clambda%20x_p%20=%20%5Csum_%7Bi=1%7D%5En%20a_%7Bpi%7D%20x_i%0A%5Cend%7Balign%7D%0A"></p>
<p>ここで，両辺について絶対値を取ると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%7C%5Clambda%20x_p%20%7C%20&amp;=%20%7C%5Clambda%7C%5C,%7Cx_p%7C%5C%5C%0A%5Cleft%7C%5Csum_%7Bi=1%7D%5En%20a_%7Bpi%7D%20x_i%5Cright%7C%0A%20%20%20%20&amp;%20%5Cleq%20%5Csum_%7Bi=1%7D%5En%20a_%7Bpi%7D%20%7Cx_i%7C%20%5Cquad%20(%5Cbecause%5Ctext%7B%E4%B8%89%E8%A7%92%E4%B8%8D%E7%AD%89%E5%BC%8F%7D)%5C%5C%0A%20%20%20%20&amp;%20%5Cleq%20%20%5Csum_%7Bi=1%7D%5En%20a_%7Bpi%7D%20%7Cx_p%7C%5C%5C%0A%20%20%20%20&amp;=%20%7Cx_p%7C%20%5Cquad(%5Cbecause%20%5Csum_%7Bi=1%7D%5En%20a_%7Bpi%7D%20=%201)%0A%5Cend%7Balign%7D%0A"></p>
<p>従って，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%7C%5Clambda%7C%5C,%7Cx_p%7C%20%5Cleq%20%7Cx_p%7C%20%5CRightarrow%20%7C%5Clambda%7C%5Cleq%201%0A"></p>
</div>
</div>
</div>
</section>
<section id="appendix" class="level2">
<h2 class="anchored" data-anchor-id="appendix">Appendix</h2>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="thm-" class="custom_problem theorem">
<p><span class="theorem-title"><strong>Theorem 1</strong></span> <strong>: 転置行列の固有値</strong> <br></p>
<p>任意の <img src="https://latex.codecogs.com/png.latex?n"> 次正方行列 <img src="https://latex.codecogs.com/png.latex?A"> に対して，<img src="https://latex.codecogs.com/png.latex?A"> の固有値と <img src="https://latex.codecogs.com/png.latex?A%5ET"> の固有値は等しい</p>
</div>
</div>
<!--::: {.callout-note collapse="true" icon=false}-->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?A"> の固有値を <img src="https://latex.codecogs.com/png.latex?%5Clambda"> とすると，<img src="https://latex.codecogs.com/png.latex?%5Clambda"> は次の固有方程式の解と対応します．</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%7C%5Clambda%20%5Cpmb%20I%20-%20A%7C%20=%200%0A"></p>
<p>行列式は転置不変性，つまり</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%7C%5Clambda%20%5Cpmb%20I%20-%20A%7C%20=%20%7C(%5Clambda%20%5Cpmb%20I%20-%20A)%5ET%7C%0A"></p>
<p>という性質を持つので</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%7C(%5Clambda%20%5Cpmb%20I%20-%20A)%5ET%7C%0A%20%20%20%20&amp;=%20%7C(%5Clambda%20%5Cpmb%20I%5ET%20-%20A%5ET)%7C%5C%5C%0A%20%20%20%20&amp;=%20%7C(%5Clambda%20%5Cpmb%20I%20-%20A%5ET)%7C%5C%5C%0A%20%20%20%20&amp;=%200%0A%5Cend%7Balign%7D%0A"></p>
<p>従って，<img src="https://latex.codecogs.com/png.latex?%5Clambda"> は <img src="https://latex.codecogs.com/png.latex?A%5ET"> の固有方程式の解となることがわかるので，<img src="https://latex.codecogs.com/png.latex?A"> の固有値と <img src="https://latex.codecogs.com/png.latex?A%5ET"> の固有値は等しいことがわかる．</p>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>線形代数</category>
  <category>統計</category>
  <guid>https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-04-08-probability-matrix-exercise/</guid>
  <pubDate>Tue, 08 Apr 2025 00:00:00 GMT</pubDate>
</item>
<item>
  <title>ベクトル空間における内積</title>
  <dc:creator>Ryo Nakagami</dc:creator>
  <link>https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-04-07-inner-product/</link>
  <description><![CDATA[ 





<section id="ベクトルの成す角と内積" class="level2">
<h2 class="anchored" data-anchor-id="ベクトルの成す角と内積">ベクトルの成す角と内積</h2>
<p><img src="https://latex.codecogs.com/png.latex?%5Cpmb%7Ba%7D,%20%5Cpmb%7Bb%7D%20%5Cin%20%5Cmathbb%20R%5E2"> を空間内の２つのベクトルでいずれもゼロベクトルではないとします．原点 <img src="https://latex.codecogs.com/png.latex?O"> を始点として</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bgather%7D%0A%5Cpmb%7Ba%7D%20=%20%5Coverrightarrow%7BOA%7D%5C%5C%0A%5Cpmb%7Bb%7D%20=%20%5Coverrightarrow%7BOB%7D%0A%5Cend%7Bgather%7D%0A"></p>
<p>となる点 <img src="https://latex.codecogs.com/png.latex?A,%20B"> をとります．このとき，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctheta%20=%20%5Cangle%20AOB%0A"></p>
<p>を <strong>ベクトル <img src="https://latex.codecogs.com/png.latex?%5Cpmb%7Ba%7D,%20%5Cpmb%7Bb%7D"> の成す角</strong> といいいます．ただし，<img src="https://latex.codecogs.com/png.latex?0%20%5Cleq%20%5Ctheta%20%5Cleq%20%5Cpi"> とします．</p>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="def-inner-product" class="custom_problem theorem definition">
<p><span class="theorem-title"><strong>Definition 1</strong></span> <strong>: ベクトルの内積</strong> <br></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5C%7C%5Cpmb%7Ba%7D%5C%7C%5C,%5C%7C%5Cpmb%7Bb%7D%5C%7C%20%5Ccos%20%5Ctheta%0A"></p>
<p>を <img src="https://latex.codecogs.com/png.latex?%5Cpmb%7Ba%7D"> と <img src="https://latex.codecogs.com/png.latex?%5Cpmb%7Bb%7D"> の内積，またはスカラー積といい，<img src="https://latex.codecogs.com/png.latex?(%5Cpmb%7Ba%7D,%20%5Cpmb%7Bb%7D)"> や <img src="https://latex.codecogs.com/png.latex?%5Cpmb%7Ba%7D%20%5Ccdot%20%5Cpmb%7Bb%7D"> で表す．<img src="https://latex.codecogs.com/png.latex?%5Cpmb%7Ba%7D,%20%5Cpmb%7Bb%7D"> のいずれかがゼロベクトルの場合は</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(%5Cpmb%7Ba%7D,%20%5Cpmb%7Bb%7D)%20=%200%0A"></p>
<p>とする．</p>
</div>
</div>
<p><strong> ▶&nbsp; シュワルツの不等式</strong></p>
<p>内積の定義</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(%5Cpmb%7Ba%7D,%20%5Cpmb%7Bb%7D)%20=%20%5C%7C%5Cpmb%7Ba%7D%5C%7C%5C,%5C%7C%5Cpmb%7Bb%7D%5C%7C%20%5Ccos%20%5Ctheta%0A"></p>
<p>より， <img src="https://latex.codecogs.com/png.latex?-1%20%5Cleq%20%5Ccos%5Ctheta%20%5Cleq%201"> であるから</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cvert(%5Cpmb%7Ba%7D,%20%5Cpmb%7Bb%7D)%5Cvert%20%5Cleq%20%5C%7C%5Cpmb%7Ba%7D%5C%7C%5C,%5C%7C%5Cpmb%7Bb%7D%5C%7C%0A"></p>
<p>であることがわかります．証明は <a href="https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-03-03-triangle-inequality/#%E3%82%B7%E3%83%A5%E3%83%AF%E3%83%AB%E3%83%84%E3%81%AE%E4%B8%8D%E7%AD%89%E5%BC%8F%E3%81%A8%E4%B8%89%E8%A7%92%E4%B8%8D%E7%AD%89%E5%BC%8F">いろいろな三角不等式 &gt; シュワルツの不等式と三角不等式</a> を参考にしてください．</p>
<p><strong> ▶&nbsp; 直交(orthogonal)</strong></p>
<p>ベクトル <img src="https://latex.codecogs.com/png.latex?%5Cpmb%7Ba%7D,%20%5Cpmb%7Bb%7D"> の成す角が直角のとき，ベクトル <img src="https://latex.codecogs.com/png.latex?%5Cpmb%7Ba%7D,%20%5Cpmb%7Bb%7D"> は直交すると呼びます．このとき，<img src="https://latex.codecogs.com/png.latex?%5Ccos%5Ctheta%20=%200"> であることから</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cpmb%7Ba%7D%20%5Cperp%20%5Cpmb%7Bb%7D%20%5CLongleftrightarrow%20(%5Cpmb%7Ba%7D,%20%5Cpmb%7Bb%7D)%20=%200%0A"></p>
<p><strong> ▶&nbsp; ベクトルの角度と幾何学的理解</strong></p>
<p>ベクトルの成す角の定義より</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctheta%20=%20%5Carccos%20%5Cfrac%7B(%5Cpmb%20a,%20%5Cpmb%20b)%7D%7B%5C%7C%5Cpmb%20a%5C%7C%5C,%5C%7C%5Cpmb%20b%5C%7C%7D%0A"></p>
<p>この定義が幾何学的に見て妥当なものかどうかを以下確認します．</p>
<p>Figure&nbsp;1 のように <img src="https://latex.codecogs.com/png.latex?%5Cpmb%7Ba%7D,%20%5Cpmb%7Bb%7D"> を考えたとき，<img src="https://latex.codecogs.com/png.latex?%5Cpmb%7Bb%7D"> の先端から <img src="https://latex.codecogs.com/png.latex?%5Cpmb%7Ba%7D"> に対して垂線を下ろします．その足 <img src="https://latex.codecogs.com/png.latex?B'"> のベクトルを <img src="https://latex.codecogs.com/png.latex?k%5Cpmb%20a"> とおくと，２つのベクトルが直交 <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%5Ctheta%20=%20%5Cfrac%7B%5Cpi%7D%7B2%7D">するとき，その内積は <img src="https://latex.codecogs.com/png.latex?0"> になることから</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(%5Cpmb%20%7Bb%7D%20-%20k%5Cpmb%20%7Ba%7D,%20%5Cpmb%20%7Ba%7D)%20=%200%0A"></p>
<p>内積演算の性質より</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A&amp;(%5Cpmb%20%7Ba%7D,%20%5Cpmb%20%7Bb%7D)%20=%20k%20%5C%7C%5Cpmb%20%7Ba%7D%5C%7C%5E2%5C%5C%0A&amp;%5CRightarrow%20k%20=%20%5Cfrac%7B(%5Cpmb%20%7Ba%7D,%20%5Cpmb%20%7Bb%7D)%7D%7B%5C%7C%5Cpmb%20%7Ba%7D%5C%7C%5E2%7D%20%5Clabel%7B#eq-inner-angle%7D%0A%5Cend%7Balign%7D%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctriangle%20BOB'"> は直角三角形なので <img src="https://latex.codecogs.com/png.latex?%5Cangle%20BOB'"> に対応する <img src="https://latex.codecogs.com/png.latex?%5Ccos%20%5Ctheta"> は</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ccos%20%5Ctheta%20=%20%5Cfrac%7Bk%5C%7C%5Cpmb%20a%5C%7C%7D%7B%5C%7C%5Cpmb%20b%5C%7C%7D%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ceqref%7B#eq-inner-angle%7D"> をもちいると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Ccos%20%5Ctheta%0A%20%20%20%20&amp;=%20%5Cfrac%7Bk%5C%7C%5Cpmb%20a%5C%7C%7D%7B%5C%7C%5Cpmb%20b%5C%7C%7D%5C%5C%0A%20%20%20%20&amp;=%20%5Cfrac%7B(%5Cpmb%20%7Ba%7D,%20%5Cpmb%20%7Bb%7D)%7D%7B%5C%7C%5Cpmb%20%7Ba%7D%5C%7C%5E2%7D%5Cfrac%7B%5C%7C%5Cpmb%20a%5C%7C%7D%7B%5C%7C%5Cpmb%20b%5C%7C%7D%5C%5C%0A%20%20%20%20&amp;=%20%5Cfrac%7B(%5Cpmb%20%7Ba%7D,%20%5Cpmb%20%7Bb%7D)%7D%7B%5C%7C%5Cpmb%20a%5C%7C%5C,%5C%7C%5Cpmb%20b%5C%7C%7D%0A%5Cend%7Balign%7D%0A"></p>
<p>と整理することができ，これは Definition&nbsp;1 と一致することがわかります．</p>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.patches <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> patches</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> cmath</span>
<span id="cb1-5"></span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define two vectors</span></span>
<span id="cb1-8">v0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb1-9">v1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb1-10">v2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>])</span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate the angle using the dot product</span></span>
<span id="cb1-13">dot_product <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.dot(v1, v2)</span>
<span id="cb1-14">norm_v1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linalg.norm(v1)</span>
<span id="cb1-15">norm_v2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linalg.norm(v2)</span>
<span id="cb1-16">cos_theta_0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.dot(v0, v1) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (norm_v1)</span>
<span id="cb1-17">cos_theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dot_product <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (norm_v1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> norm_v2)</span>
<span id="cb1-18">theta_rad_0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arccos(cos_theta_0)</span>
<span id="cb1-19">theta_rad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arccos(cos_theta)</span>
<span id="cb1-20">theta_deg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.degrees(theta_rad)</span>
<span id="cb1-21"></span>
<span id="cb1-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># define projection of B into A</span></span>
<span id="cb1-23">v3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  v1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> norm_v2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> cos_theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> norm_v1</span>
<span id="cb1-24"></span>
<span id="cb1-25"></span>
<span id="cb1-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the vectors</span></span>
<span id="cb1-27">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb1-28">ax.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb1-29"></span>
<span id="cb1-30">origin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb1-31">ax.quiver(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>origin, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>v1, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r'</span>, scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, scale_units<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xy'</span>, angles<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xy'</span>)</span>
<span id="cb1-32">ax.quiver(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>origin, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>v2, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'b'</span>, scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, scale_units<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xy'</span>, angles<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xy'</span>)</span>
<span id="cb1-33"></span>
<span id="cb1-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add angle arc using a circle segment</span></span>
<span id="cb1-35">angle_range <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(np.arccos(cos_theta_0), theta_rad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> np.arccos(cos_theta_0), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb1-36">arc_radius <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb1-37">arc_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> arc_radius <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.cos(angle_range)</span>
<span id="cb1-38">arc_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> arc_radius <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(angle_range)</span>
<span id="cb1-39">ax.plot(arc_x, arc_y, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'k--'</span>, linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-40">ax.plot((v2[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], v3[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]), (v2[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], v3[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'k--'</span>, linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-41"></span>
<span id="cb1-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add square box at B'</span></span>
<span id="cb1-43">theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.angle(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">complex</span>(v3[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], v3[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 60 degrees</span></span>
<span id="cb1-44">orthogonal_theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> np.pi <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 90° 直交</span></span>
<span id="cb1-45">offset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linalg.norm(v3)</span>
<span id="cb1-46">size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.15</span></span>
<span id="cb1-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 直角マークの位置を作成（60°方向に少し移動 → 90°方向に正方形を描く）</span></span>
<span id="cb1-48">base_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> offset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.cos(theta)</span>
<span id="cb1-49">base_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> offset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(theta)</span>
<span id="cb1-50">rect_dx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.cos(orthogonal_theta)</span>
<span id="cb1-51">rect_dy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(orthogonal_theta)</span>
<span id="cb1-52"></span>
<span id="cb1-53"></span>
<span id="cb1-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 小さな直角マーク（平行四辺形を回転して表現）</span></span>
<span id="cb1-55">right_angle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> patches.Polygon(</span>
<span id="cb1-56">    [</span>
<span id="cb1-57">        (base_x, base_y),</span>
<span id="cb1-58">        (base_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> rect_dx, base_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> rect_dy),</span>
<span id="cb1-59">        (</span>
<span id="cb1-60">            base_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> rect_dx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.cos(theta),</span>
<span id="cb1-61">            base_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> rect_dy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(theta),</span>
<span id="cb1-62">        ),</span>
<span id="cb1-63">        (base_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.cos(theta), base_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(theta)),</span>
<span id="cb1-64">    ],</span>
<span id="cb1-65">    closed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb1-66">    edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span id="cb1-67">    facecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb1-68">)</span>
<span id="cb1-69"></span>
<span id="cb1-70">ax.add_patch(right_angle)</span>
<span id="cb1-71"></span>
<span id="cb1-72"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Annotate angle</span></span>
<span id="cb1-73">ax.text(np.median(arc_x), np.median(arc_y), <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>theta_deg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.1f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">°"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)</span>
<span id="cb1-74">ax.text(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>origin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"O"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)</span>
<span id="cb1-75">ax.text(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>v1, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"A"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)</span>
<span id="cb1-76">ax.text(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>v2, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"B"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)</span>
<span id="cb1-77">ax.text(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>v3<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"B'"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)</span>
<span id="cb1-78"></span>
<span id="cb1-79"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot settings</span></span>
<span id="cb1-80">ax.set_xlim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>)</span>
<span id="cb1-81">ax.set_ylim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>)</span>
<span id="cb1-82">ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>)</span>
<span id="cb1-83"></span>
<span id="cb1-84">ax.set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Angle Between Vectors Using Inner Product"</span>)</span>
<span id="cb1-85">ax.set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"X"</span>)</span>
<span id="cb1-86">ax.set_ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Y"</span>)</span>
<span id="cb1-87">plt.show()</span></code></pre></div>
</details>
<div id="fig-plot-two-vec-angles" class="center quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot-two-vec-angles-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="9fbeb93e" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-04-07-inner-product/index_files/figure-html/cell-2-output-1.png" width="533" height="523" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-plot-two-vec-angles-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1
</figcaption>
</figure>
</div>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="thm-" class="custom_problem theorem">
<p><span class="theorem-title"><strong>Theorem 1</strong></span> <br></p>
<p>２つのベクトル <img src="https://latex.codecogs.com/png.latex?%5Cpmb%20a,%20%5Cpmb%20b"> の成分表示を <img src="https://latex.codecogs.com/png.latex?%5Cpmb%20a%20=%20(a_1,%20%5Ccdots,%20a_n),%20%5Cpmb%20b%20=%20(b_1,%20%5Ccdots,%20b_n)"> とするとき</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(%5Cpmb%20a,%20%5Cpmb%20b)%20=%20%5Csum_%7Bi=1%7D%5En%20a_ib_i%0A"></p>
<p>が成り立つ．ただし，証明にあたってノルムの定義は与えられているものとする</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5C%7C%5Cpmb%20a%5C%7C%20=%20%5Csqrt%7Ba_1%5E2%20+%20%5Ccdots%20+%20a_n%5E2%7D%0A"></p>
</div>
</div>
<!--::: {.callout-note collapse="true" icon=false}-->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5Cpmb%20a,%20%5Cpmb%20b"> のなす角を <img src="https://latex.codecogs.com/png.latex?%5Ctheta"> とすると，余弦定理より</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5C%7C%5Cpmb%20a%5C%7C%5E2%20+%20%5C%7C%5Cpmb%20b%5C%7C%5E2%20-%20%5C%7C%5Cpmb%20a%20-%20%5Cpmb%20b%5C%7C%5E2%20=%202%20%5C%7C%5Cpmb%20a%5C%7C%20%5C,%20%5C%7C%5Cpmb%20b%5C%7C%20%5Ccos%5Ctheta%0A%5Cend%7Balign%7D%0A"></p>
<p>ノルムの定義より</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bgather%7D%0A%5C%7C%5Cpmb%20a%5C%7C%5E2%20=%20a_1%5E2%20+%20%5Ccdots%20+%20a_n%5E2%5C%5C%0A%5C%7C%5Cpmb%20b%5C%7C%5E2%20=%20b_1%5E2%20+%20%5Ccdots%20+%20b_n%5E2%5C%5C%0A%5C%7C%5Cpmb%20a%20-%20%5Cpmb%20b%5C%7C%5E2%20=%20(a_1%20-%20b_1)%5E2%20+%20%5Ccdots%20+%20(a_n%20-%20b_n)%5E2%0A%5Cend%7Bgather%7D%0A"></p>
<p>また，内積の定義より</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5C%7C%5Cpmb%20a%5C%7C%20%5C,%20%5C%7C%5Cpmb%20b%5C%7C%20%5Ccos%5Ctheta%20=%20%5C%7C%5Cpmb%20a%5C%7C%20%5C,%20%5C%7C%5Cpmb%20b%5C%7C%5Cfrac%7B(%5Cpmb%20a,%20%5Cpmb%20b)%7D%7B%5C%7C%5Cpmb%20a%5C%7C%20%5C,%20%5C%7C%5Cpmb%20b%5C%7C%7D%20=%20(%5Cpmb%20a,%20%5Cpmb%20b)%0A"></p>
<p>従って，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5C%7C%5Cpmb%20a%5C%7C%5E2%20+%20%5C%7C%5Cpmb%20b%5C%7C%5E2%20-%20%5C%7C%5Cpmb%20a%20-%20%5Cpmb%20b%5C%7C%5E2%0A%20%20%20%20&amp;=%202%5Csum_i%20a_ib_i%5C%5C%0A%20%20%20%20&amp;=%202(%5Cpmb%20a,%20%5Cpmb%20b)%0A%5Cend%7Balign%7D%0A"></p>
<p>よって，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(%5Cpmb%20a,%20%5Cpmb%20b)%20=%20%5Csum_%7Bi=1%7D%5En%20a_ib_i%0A"></p>
</div>
</div>
</div>
<section id="内積の性質" class="level3">
<h3 class="anchored" data-anchor-id="内積の性質">内積の性質</h3>
<p><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20R%5En"> の属する<img src="https://latex.codecogs.com/png.latex?n">次元実ベクトル <img src="https://latex.codecogs.com/png.latex?%5Cpmb%20a%20=%20(a_1,%20%5Ccdots,%20a_n)%5ET,%20%5Cpmb%20b%20=%20(b_1,%20%5Ccdots,%20b_n)%5ET"> を考えます．この２つのベクトルの内積は上で確認したように</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(%5Cpmb%20a,%20%5Cpmb%20b)%20=%20%5Csum_%7Bi=1%7D%5En%20a_ib_i%0A"></p>
<p>となります．ここで，<img src="https://latex.codecogs.com/png.latex?%5Cpmb%20a,%20%5Cpmb%20b"> を <img src="https://latex.codecogs.com/png.latex?(n%20%5Ctimes%201)"> 行列とみなすと</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(%5Cpmb%20a,%20%5Cpmb%20b)%20=%20%5Cpmb%20a%5ET%5Cpmb%20b%0A"></p>
<p>と一致します．ここから<img src="https://latex.codecogs.com/png.latex?n">次元実ベクトルの内積について次の演算性質を確認することができます．</p>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="thm-inner-product" class="custom_problem theorem">
<p><span class="theorem-title"><strong>Theorem 2</strong></span> <br></p>
<p><img src="https://latex.codecogs.com/png.latex?h,%20k%20%5Cin%20%5Cmathbb%20R"> とすると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Ctext%7B%E5%AF%BE%E7%A7%B0%E6%80%A7:%7D%20%5Cquad&amp;%20(%5Cpmb%20a,%20%5Cpmb%20b)%20%20=%20(%5Cpmb%20b,%20%5Cpmb%20a)%5C%5C%0A%5Ctext%7B%E7%B7%9A%E5%BD%A2%E6%80%A7:%7D%20%5Cquad&amp;%20(h%5Cpmb%20a%20+%20k%5Cpmb%20a%5E%5Cprime,%20%5Cpmb%20b)%20%20=%20h(%5Cpmb%20a,%20%5Cpmb%20b)%20+%20k(%5Cpmb%20a%5E%5Cprime,%20%5Cpmb%20b)%5C%5C%0A&amp;%20(%5Cpmb%20a,%20h%5Cpmb%20b%20+%20k%5Cpmb%20b%5E%5Cprime)%20%20=%20h(%5Cpmb%20a,%20%5Cpmb%20b)%20+%20k(%5Cpmb%20a,%20%5Cpmb%20b%5E%5Cprime)%5C%5C%0A%5Clabel%7B#eq-positivity%7D%5Ctext%7B%E6%AD%A3%E5%80%A4%E6%80%A7:%7D%20%5Cquad&amp;%20(%5Cpmb%20a,%20%5Cpmb%20a)%20%20%5Cgeq%200%0A%5Cend%7Balign%7D%0A"></p>
</div>
</div>
<!--::: {.callout-note collapse="true" icon=false}-->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><strong> ▶&nbsp; 対称性</strong></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A(%5Cpmb%20a,%20%5Cpmb%20b)%0A%20%20%20%20&amp;=%20%5Cpmb%20a%5ET%5Cpmb%20b%5C%5C%0A%20%20%20%20&amp;=%20(%5Cpmb%20a%5ET%5Cpmb%20b)%5ET%5C%5C%0A%20%20%20%20&amp;=%20(%5Cpmb%20b%5ET%5Cpmb%20a)%5C%5C%0A%20%20%20%20&amp;=%20(%5Cpmb%20b,%20%5Cpmb%20a)%0A%5Cend%7Balign%7D%0A"></p>
<p><strong> ▶&nbsp; 線形性 </strong></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A(h%5Cpmb%20a%20+%20k%5Cpmb%20a%5E%5Cprime,%20%5Cpmb%20b)%0A%20%20%20%20&amp;=%20(h%5Cpmb%20a%20+%20k%5Cpmb%20a%5E%5Cprime)%5ET%5Cpmb%20b%5C%5C%0A%20%20%20%20&amp;=%20h%5Cpmb%20a%5ET%20%5Cpmb%20b%20+%20k%7B%5Cpmb%20a%5E%5Cprime%7D%5ET%20%5Cpmb%20b%5C%5C%0A%20%20%20%20&amp;=%20h(%5Cpmb%20a%5ET%20%5Cpmb%20b)%20+%20k(%7B%5Cpmb%20a%5E%5Cprime%7D%5ET%20%5Cpmb%20b)%5C%5C%0A%20%20%20%20&amp;=%20h(%5Cpmb%20a,%20%5Cpmb%20b)%20+%20k(%5Cpmb%20a%5E%5Cprime,%20%5Cpmb%20b)%0A%5Cend%7Balign%7D%0A"></p>
<p><strong> ▶&nbsp; 正値性</strong></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A(%5Cpmb%20a,%20%5Cpmb%20a)%0A%20%20%20%20&amp;=%20%5Cpmb%20a%5ET%5Cpmb%20a%5C%5C%0A%20%20%20%20&amp;=%20%5Csum_i%20a_i%5E2%0A%5Cend%7Balign%7D%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?a_i%5E2%20%5Cgeq%200%20%5C,%20(%5Cforall%20i%20%5Cin%20(1,%20%5Ccdots,%20n))"> であるので <img src="https://latex.codecogs.com/png.latex?(%5Cpmb%20a,%20%5Cpmb%20a)%20%5Cgeq%200"> が成立します．また等号成立条件は</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Aa_i%5E2%20=%200%20%5C,%20(%5Cforall%20i%20%5Cin%20(1,%20%5Ccdots,%20n))%20%5CLeftrightarrow%20a_i%20=%200%20%5C,%20(%5Cforall%20i%20%5Cin%20(1,%20%5Ccdots,%20n))%0A"></p>
<p>従って，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(%5Cpmb%20a,%20%5Cpmb%20a)%20=%200%20%5CLeftrightarrow%20%5Cpmb%20a%20=%20%5Cpmb%200%0A"></p>
</div>
</div>
</div>
<div class="nte- callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
🍵 計量ベクトル空間
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>内積の定義されたベクトル空間を計量ベクトル空間といいます．</li>
</ul>
</div>
</div>
</section>
<section id="ベクトルの長さ-ノルム" class="level3">
<h3 class="anchored" data-anchor-id="ベクトルの長さ-ノルム">ベクトルの長さ: ノルム</h3>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="def-" class="custom_problem theorem definition">
<p><span class="theorem-title"><strong>Definition 2</strong></span> <strong>: ノルム</strong> <br></p>
<p>計量ベクトル空間 <img src="https://latex.codecogs.com/png.latex?V"> の任意のベクトル <img src="https://latex.codecogs.com/png.latex?%5Cpmb%20a"> に対して，<img src="https://latex.codecogs.com/png.latex?%5Csqrt%7B(%5Cpmb%20a,%20%5Cpmb%20a)%7D"> をベクトル <img src="https://latex.codecogs.com/png.latex?%5Cpmb%20a"> の長さ, またはL2ノルムといい，<img src="https://latex.codecogs.com/png.latex?%5C%7C%5Cpmb%20a%5C%7C"> と表す．</p>
</div>
</div>
<p>内積の正値性 <img src="https://latex.codecogs.com/png.latex?%5Ceqref%7B#eq-positivity%7D"> より <img src="https://latex.codecogs.com/png.latex?%5C%7C%5Cpmb%20a%5C%7C%20%5Cgeq%200"> が成り立ち，<strong>長さ</strong> の概念（長さが負にならない）と対応していることがわかります．</p>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="thm-" class="custom_problem theorem">
<p><span class="theorem-title"><strong>Theorem 3</strong></span> <br></p>
<p>計量ベクトル空間 <img src="https://latex.codecogs.com/png.latex?V"> の内積と長さについて，<img src="https://latex.codecogs.com/png.latex?%5Cpmb%20a,%20%5Cpmb%20b%20%5Cin%20V,%20k%5Cin%20%5Cmathbb%20R"> としたとき以下が成り立つ</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A&amp;%5C%7C%5Cpmb%20a%5C%7C%20%5Cgeq%200%5C%5C%0A&amp;%5C%7Ck%5Cpmb%20a%5C%7C%20=%20%7Ck%5C%7C%7C%5Cpmb%20a%5C%7C%5C%5C%0A&amp;(%5Cpmb%20a,%5Cpmb%20b)%20=%20%5Cfrac%7B1%7D%7B2%7D%5C%7B%5C%7C%5Cpmb%20a%20+%20%5Cpmb%20b%5C%7C%5E2%20-%20%5C%7C%5Cpmb%20a%5C%7C%5E2%20-%20%5C%7C%5Cpmb%20b%5C%7C%5E2%5C%7D%20=%20%5Cfrac%7B1%7D%7B2%7D%5C%7B%5C%7C%5Cpmb%20a%5C%7C%5E2%20+%20%5C%7C%5Cpmb%20b%5C%7C%5E2%20-%20%5C%7C%5Cpmb%20a%20-%20%5Cpmb%20b%5C%7C%5E2%20%5C%7D%5C%5C%0A&amp;%5C%7C%5Cpmb%20a%20+%20%5Cpmb%20b%5C%7C%5E2%20+%20%5C%7C%5Cpmb%20a%20-%20%5Cpmb%20b%5C%7C%5E2%20=%202(%5C%7C%5Cpmb%20a%5C%7C%5E2%20+%20%5C%7C%5Cpmb%20b%5C%7C%5E2)%0A%5Cend%7Balign%7D%0A"></p>
</div>
</div>
<!--::: {.callout-note collapse="true" icon=false}-->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><strong> ▶&nbsp; <img src="https://latex.codecogs.com/png.latex?%5C%7Ck%5Cpmb%20a%5C%7C%20=%20%7Ck%5C%7C%7C%5Cpmb%20a%5C%7C"></strong></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5C%7Ck%5Cpmb%20a%5C%7C%5E2%0A%20%20%20%20&amp;=%20(k%5Cpmb%20a,%20k%5Cpmb%20a)%5C%5C%0A%20%20%20%20&amp;=%20k%5E2%20(%5Cpmb%20a,%20%5Cpmb%20a)%5C%5C%0A%20%20%20%20&amp;=%20k%5E2%20%5C%7C%5Cpmb%20a%5C%7C%5E2%0A%5Cend%7Balign%7D%0A"></p>
<p>従って，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5C%7Ck%5Cpmb%20a%5C%7C%0A%20%20%20%20&amp;=%20%5Csqrt%7B%5C%7Ck%5Cpmb%20a%5C%7C%5E2%7D%5C%5C%0A%20%20%20%20&amp;=%20%5Csqrt%7Bk%5E2%20%5C%7C%5Cpmb%20a%5C%7C%5E2%7D%5C%5C%0A%20%20%20%20&amp;=%20%7Ck%5C%7C%7C%5Cpmb%20a%5C%7C%0A%5Cend%7Balign%7D%0A"></p>
<p><strong> ▶&nbsp; <img src="https://latex.codecogs.com/png.latex?(%5Cpmb%20a,%5Cpmb%20b)%20=%20%5Cfrac%7B1%7D%7B2%7D%5C%7B%5C%7C%5Cpmb%20a%20+%20%5Cpmb%20b%5C%7C%5E2%20-%20%5C%7C%5Cpmb%20a%5C%7C%5E2%20-%20%5C%7C%5Cpmb%20b%5C%7C%5E2%5C%7D"></strong></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5C%7C%5Cpmb%20a%20+%20%5Cpmb%20b%5C%7C%5E2%0A%20%20%20%20&amp;=%20(%5Cpmb%20a%20+%20%5Cpmb%20b,%20%5Cpmb%20a%20+%20%5Cpmb%20b)%5C%5C%0A%20%20%20%20&amp;=%20(%5Cpmb%20a,%20%5Cpmb%20a)%20+%202(%5Cpmb%20a,%20%5Cpmb%20b)%20+%20(%5Cpmb%20b,%20%5Cpmb%20b)%5C%5C%0A%20%20%20%20&amp;=%20%5C%7C%5Cpmb%20a%5C%7C%5E2%20+%20%5C%7C%5Cpmb%20b%5C%7C%5E2%20+%202(%5Cpmb%20a,%20%5Cpmb%20b)%0A%5Cend%7Balign%7D%0A"></p>
<p>従って，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(%5Cpmb%20a,%5Cpmb%20b)%20=%20%5Cfrac%7B1%7D%7B2%7D%5C%7B%5C%7C%5Cpmb%20a%20+%20%5Cpmb%20b%5C%7C%5E2%20-%20%5C%7C%5Cpmb%20a%5C%7C%5E2%20-%20%5C%7C%5Cpmb%20b%5C%7C%5E2%5C%7D%0A"></p>
<p><strong> ▶&nbsp; <img src="https://latex.codecogs.com/png.latex?(%5Cpmb%20a,%5Cpmb%20b)%20=%20%5Cfrac%7B1%7D%7B2%7D%5C%7B%5C%7C%5Cpmb%20a%5C%7C%5E2%20+%20%5C%7C%5Cpmb%20b%5C%7C%5E2%20-%20%5C%7C%5Cpmb%20a%20-%20%5Cpmb%20b%5C%7C%5E2%20%5C%7D"></strong></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5C%7C%5Cpmb%20a%20-%20%5Cpmb%20b%5C%7C%5E2%0A%20%20%20%20&amp;=%20(%5Cpmb%20a%20-%20%5Cpmb%20b,%20%5Cpmb%20a%20-%20%5Cpmb%20b)%5C%5C%0A%20%20%20%20&amp;=%20%5C%7C%5Cpmb%20a%5C%7C%5E2%20+%20%5C%7C%5Cpmb%20b%5C%7C%5E2%20-2(%5Cpmb%20a,%20%5Cpmb%20b)%0A%5Cend%7Balign%7D%0A"></p>
<p>従って，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(%5Cpmb%20a,%5Cpmb%20b)%20=%20%5Cfrac%7B1%7D%7B2%7D%5C%7B%5C%7C%5Cpmb%20a%5C%7C%5E2%20+%20%5C%7C%5Cpmb%20b%5C%7C%5E2%20-%20%5C%7C%5Cpmb%20a%20-%20%5Cpmb%20b%5C%7C%5E2%20%5C%7D%0A"></p>
<p><strong> ▶&nbsp; <img src="https://latex.codecogs.com/png.latex?%5C%7C%5Cpmb%20a%20+%20%5Cpmb%20b%5C%7C%5E2%20+%20%5C%7C%5Cpmb%20a%20-%20%5Cpmb%20b%5C%7C%5E2%20=%202(%5C%7C%5Cpmb%20a%5C%7C%5E2%20+%20%5C%7C%5Cpmb%20b%5C%7C%5E2)"></strong></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5C%7C%5Cpmb%20a%20+%20%5Cpmb%20b%5C%7C%5E2%20&amp;%20=%20%5C%7C%5Cpmb%20a%5C%7C%5E2%20+%20%5C%7C%5Cpmb%20b%5C%7C%5E2%20%20+%202(%5Cpmb%20a,%20%5Cpmb%20b)%0A%5C%7C%5Cpmb%20a%20-%20%5Cpmb%20b%5C%7C%5E2%20&amp;%20=%20%5C%7C%5Cpmb%20a%5C%7C%5E2%20+%20%5C%7C%5Cpmb%20b%5C%7C%5E2%20-%202(%5Cpmb%20a,%20%5Cpmb%20b)%0A%5Cend%7Balign%7D%0A"></p>
<p>両辺を足し合わせると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5C%7C%5Cpmb%20a%20+%20%5Cpmb%20b%5C%7C%5E2%20+%20%5C%7C%5Cpmb%20a%20-%20%5Cpmb%20b%5C%7C%5E2%20=%202(%5C%7C%5Cpmb%20a%5C%7C%5E2%20+%20%5C%7C%5Cpmb%20b%5C%7C%5E2)%0A"></p>
</div>
</div>
</div>
<p><strong> ▶&nbsp; ピタゴラスの定理</strong></p>
<p><img src="https://latex.codecogs.com/png.latex?n"> 次元実ベクトル空間 <img src="https://latex.codecogs.com/png.latex?V"> に対して，<img src="https://latex.codecogs.com/png.latex?%5Cpmb%20a,%20%5Cpmb%20b%20%5Cin%20V"> を考えます．<img src="https://latex.codecogs.com/png.latex?%5Cpmb%20a%5Cperp%20%5Cpmb%20b"> が成立する場合，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5C%7C%5Cpmb%20a%20+%20%5Cpmb%20b%5C%7C%5E2%0A%20%20%20%20&amp;=%20(%5Cpmb%20a%20+%20%5Cpmb%20b,%20%5Cpmb%20a%20+%20%5Cpmb%20b)%5C%5C%0A%20%20%20%20&amp;=%20%5C%7C%5Cpmb%20a%5C%7C%5E2%20+%20%5C%7C%5Cpmb%20b%5C%7C%5E2%20+%202(%5Cpmb%20a,%20%5Cpmb%20b)%5C%5C%0A%20%20%20%20&amp;=%20%5C%7C%5Cpmb%20a%5C%7C%5E2%20+%20%5C%7C%5Cpmb%20b%5C%7C%5E2%0A%5Cend%7Balign%7D%0A"></p>
<p>これは <img src="https://latex.codecogs.com/png.latex?%5Cpmb%20a%5Cperp%20%5Cpmb%20b%20%5CLeftrightarrow%20(%5Cpmb%20a,%20%5Cpmb%20b)%20=%200"> であることからわかります．</p>
<p><strong> ▶&nbsp; 一般化されたピタゴラスの定理</strong></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cpmb%20a_1,%20%5Ccdots,%20%5Cpmb%20a_n%20%5Cin%20V"> が互いに直交している場合，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5C%7C%5Cpmb%20a_1%20+%20%5Ccdots%20+%20%5Cpmb%20a_n%20%5C%7C%5E2%20=%20%5C%7C%5Cpmb%20a_1%20%5C%7C%5E2%20+%20%5Ccdots%20+%20%5C%7C%5Cpmb%20a_n%20%5C%7C%5E2%0A"></p>
</section>
</section>
<section id="エルミート内積" class="level2">
<h2 class="anchored" data-anchor-id="エルミート内積">エルミート内積</h2>
<p>実数上のベクトル空間の内積に相当するものを複素数上のベクトル空間で考えます．<img src="https://latex.codecogs.com/png.latex?%5Cpmb%20a%20%5Cin%20%5Cmathbb%20C%5E2"> について実数上のベクトル空間の内積と同じように考えると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Cpmb%20a%20&amp;=%20(1%20+%202i,%200)%5C%5C%0A(%5Cpmb%20a,%20%5Cpmb%20a)%20&amp;=%201%20-%204%20+%204i%20=%20-3%20+%204i%0A%5Cend%7Balign%7D%0A"></p>
<p>となり，正値性 <img src="https://latex.codecogs.com/png.latex?(%5Cpmb%20a,%20%5Cpmb%20a)%5Cgeq%200"> が崩れてしまい，長さが定義できなくなるという問題が発生してしまいます．そこで <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C%5En"> 上のベクトル空間についての内積は</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(%5Cpmb%20a,%20%5Cpmb%20b)%20=%20%5Cpmb%20a%5ET%5Coverline%7B%5Cpmb%20b%7D%20=%20%20a_1%5Coverline%7Bb_1%7D%20+%20a_2%5Coverline%7Bb_2%7D%20+%20%5Ccdots%20+%20a_n%5Coverline%7Bb_n%7D%0A"></p>
<p>によって定義します(<img src="https://latex.codecogs.com/png.latex?%5Coverline%20b_j"> は <img src="https://latex.codecogs.com/png.latex?b_j"> の共役複素数)．このように定義した場合</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Property: エルミート内積の性質
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5Cpmb%20a,%20%5Cpmb%20b,%20%5Cpmb%20c%5Cin%20V">, <img src="https://latex.codecogs.com/png.latex?k%5Cin%20C"> のとき，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A&amp;(%5Cpmb%20a,%20%5Cpmb%20b)%20=%20%5Coverline%7B(%5Cpmb%20b,%20%5Cpmb%20a)%7D%5C%5C%0A&amp;(%5Cpmb%20a%20+%20%5Cpmb%20b,%20%5Cpmb%20c)%20=%20(%5Cpmb%20a,%20%5Cpmb%20c)%20+%20(%5Cpmb%20b,%20%5Cpmb%20c)%5C%5C%0A&amp;(%5Cpmb%20a,%20%5Cpmb%20b%20+%20%5Cpmb%20c)%20=%20(%5Cpmb%20a,%20%5Cpmb%20b)%20+%20(%5Cpmb%20a,%20%5Cpmb%20c)%5C%5C%0A&amp;(k%5Cpmb%20a,%20%5Cpmb%20b)%20=%20k(%5Cpmb%20a,%20%5Cpmb%20b)%5C%5C%0A&amp;(%5Cpmb%20a,%20k%5Cpmb%20b)%20=%20%5Coverline%20k(%5Cpmb%20a,%20%5Cpmb%20b)%5C%5C%0A&amp;(%5Cpmb%20a,%20%5Cpmb%20a)%20%5Cin%20%5Cmathbb%20R%20%5Ctext%7B%20%E3%81%A7%E3%81%82%E3%82%8A%20%7D%20(%5Cpmb%20a,%20%5Cpmb%20a)%20%5Cgeq%200,%20(%5Cpmb%20a,%20%5Cpmb%20a)%20=%200%20%5CLeftrightarrow%20%5Cpmb%20a%20=%20%5Cpmb%200%0A%5Cend%7Balign%7D%0A"></p>
</div>
</div>
<p>１つ目の性質はエルミート性や共役対称性と呼ばれますが，以下のように確認することができます</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Coverline%7B(%5Cpmb%20b,%20%5Cpmb%20a)%7D%0A%20%20%20%20&amp;=%20%5Csum_i%20%5Coverline%7Bb_i%20%5Coverline%7Ba_i%7D%7D%5C%5C%0A%20%20%20%20&amp;=%20%5Csum_i%20%5Coverline%7Bb_i%7D%20a_i%5C%5C%0A%20%20%20%20&amp;=%20%5Csum_i%20a_i%5Coverline%7Bb_i%7D%20%5C%5C%0A%20%20%20%20&amp;=%20(%5Cpmb%20a,%20%5Cpmb%20b)%0A%5Cend%7Balign%7D%0A"></p>
<p><strong> ▶&nbsp; <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C%5En"> における直交</strong></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C%5En"> の場合，内積 <img src="https://latex.codecogs.com/png.latex?(%5Cpmb%20a,%20%5Cpmb%20b)"> は一般に複素数であって実数とは限りません．そのため，ベクトルの成す角は <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20R%5En"> のようには定義できません． しかし，<img src="https://latex.codecogs.com/png.latex?(%5Cpmb%20a,%20%5Cpmb%20b)%20=%200"> のとき，<img src="https://latex.codecogs.com/png.latex?%5Cpmb%20a%5Cperp%20%5Cpmb%20b"> ということにすれば，直交という概念だけは定義できます．</p>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="thm-" class="custom_problem theorem">
<p><span class="theorem-title"><strong>Theorem 4</strong></span> <strong>: シュワルツの不等式</strong> <br></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C%5En"> の任意のベクトル <img src="https://latex.codecogs.com/png.latex?%5Cpmb%20a,%20%5Cpmb%20b"> に対し，次が成り立つ．</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5C%7C(%5Cpmb%20a,%20%5Cpmb%20b)%5C%7C%20%5Cleq%20%5C%7C%5Cpmb%20a%5C%7C%5C%7C%5Cpmb%20b%5C%7C%0A"></p>
</div>
</div>
<!--::: {.callout-note collapse="true" icon=false}-->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?x,%20y%20%5Cin%20%5Cmathbb%20C"> とすると，エルミート内積の正値性より</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A0%0A%20%20%20%20&amp;%5Cleq%20(x%5Cpmb%20a%20+%20y%5Cpmb%20b,%20x%5Cpmb%20a%20+%20y%5Cpmb%20b)%5C%5C%0A%20%20%20%20&amp;=%20%7Cx%7C%5E2(%5Cpmb%20a,%20%5Cpmb%20a)%20+%20x%20%5Coverline%20y%20(%5Cpmb%20a,%20%5Cpmb%20b)%20+%20%5Coverline%20x%20y%20(%5Cpmb%20b,%20%5Cpmb%20a)%20+%20%7Cy%7C%5E2(%5Cpmb%20b,%20%5Cpmb%20b)%0A%5Cend%7Balign%7D%0A"></p>
<p>ここで，<img src="https://latex.codecogs.com/png.latex?x%20=%20(%5Cpmb%20b,%20%5Cpmb%20b),%20y%20=%20-%20(%5Cpmb%20a,%20%5Cpmb%20b)"> とすると，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A&amp;%7Cx%7C%5E2(%5Cpmb%20a,%20%5Cpmb%20a)%20+%20x%20%5Coverline%20y%20(%5Cpmb%20a,%20%5Cpmb%20b)%20+%20%5Coverline%20x%20y%20(%5Cpmb%20b,%20%5Cpmb%20a)%20+%20%7Cy%7C%5E2(%5Cpmb%20b,%20%5Cpmb%20b)%5C%5C%0A%20%20%20%20&amp;=%20(%5Cpmb%20b,%20%5Cpmb%20b)%5Coverline%7B(%5Cpmb%20b,%20%5Cpmb%20b)%7D(%5Cpmb%20a,%20%5Cpmb%20a)%20-%20(%5Cpmb%20b,%20%5Cpmb%20b)%5Coverline%7B(%5Cpmb%20a,%20%5Cpmb%20b)%7D(%5Cpmb%20a,%20%5Cpmb%20b)%20-%20%5Coverline%7B(%5Cpmb%20b,%20%5Cpmb%20b)%7D(%5Cpmb%20a,%20%5Cpmb%20b)(%5Cpmb%20b,%20%5Cpmb%20a)%20+%20(%5Cpmb%20a,%20%5Cpmb%20b)%5Coverline%7B(%5Cpmb%20a,%20%5Cpmb%20b)%7D(%5Cpmb%20b,%20%5Cpmb%20b)%5C%5C%5C%0A%20%20%20%20&amp;=%20(%5Cpmb%20b,%20%5Cpmb%20b)(%5Cpmb%20b,%20%5Cpmb%20b)(%5Cpmb%20a,%20%5Cpmb%20a)%20-%20(%5Cpmb%20b,%20%5Cpmb%20b)%5C%7C(%5Cpmb%20a,%20%5Cpmb%20b)%5C%7C%5E2%20-%20(%5Cpmb%20b,%20%5Cpmb%20b)%5C%7C(%5Cpmb%20a,%20%5Cpmb%20b)%5C%7C%5E2%20+%20(%5Cpmb%20b,%20%5Cpmb%20b)%5C%7C(%5Cpmb%20a,%20%5Cpmb%20b)%5C%7C%5E2%5C%5C%0A%20%20%20%20&amp;=%202((%5Cpmb%20b,%20%5Cpmb%20b)(%5Cpmb%20b,%20%5Cpmb%20b)(%5Cpmb%20a,%20%5Cpmb%20a)%20-%20(%5Cpmb%20b,%20%5Cpmb%20b)%5C%7C(%5Cpmb%20a,%20%5Cpmb%20b)%5C%7C%5E2)%0A%5Cend%7Balign%7D%0A"></p>
<p>従って，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A0%20%5Cleq%20(%5Cpmb%20b,%20%5Cpmb%20b)%20%5C%7B(%5Cpmb%20b,%20%5Cpmb%20b)(%5Cpmb%20a,%20%5Cpmb%20a)%20-%20%5C%7C(%5Cpmb%20a,%20%5Cpmb%20b)%5C%7C%5E2%5C%7D%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cpmb%20b%20%5Cneq%20%5Cpmb%200"> なら <img src="https://latex.codecogs.com/png.latex?(%5Cpmb%20b,%20%5Cpmb%20b)%20%3E%200"> であるので</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5C%7C(%5Cpmb%20a,%20%5Cpmb%20b)%5C%7C%5E2%20%5Cleq%20%5C%7C%5Cpmb%20a%20%5C%7C%5E2%5C%7C%5Cpmb%20b%20%5C%7C%5E2%20%5CRightarrow%20%5C%7C(%5Cpmb%20a,%20%5Cpmb%20b)%5C%7C%20%5Cleq%20%5C%7C%5Cpmb%20a%5C%7C%5C%7C%5Cpmb%20b%5C%7C%0A"></p>
</div>
</div>
</div>
<div id="exm-" class="custom_problem theorem example">
<p><span class="theorem-title"><strong>Example 1</strong></span> <strong>: 関数空間</strong> <br></p>
<p>実数の区間 <img src="https://latex.codecogs.com/png.latex?%5Ba,%20b%5D"> で定義され，<img src="https://latex.codecogs.com/png.latex?K"> の値を取る連続関数全体の空間 <img src="https://latex.codecogs.com/png.latex?U"> において，<img src="https://latex.codecogs.com/png.latex?f,%20g%5Cin%20U"> に対し，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(f,%20g)%20=%20%5Cint%5Eb_a%20f(x)%20%5Coverline%7Bg(x)%7D%20dx%0A"></p>
<p>と定めると，これは内積となる．内積となることからSchwarzの不等式が適応できるので，次の不等式を得ることができます</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5C%7C(f,%20g)%5C%7C%20&amp;%5Cleq%20%5Csqrt%7B(f,%20f)%7D%5Csqrt%7B(g,%20g)%7D%5C%5C%5B5pt%5D%0A%5CRightarrow%20%5Cleft%5C%7C%5Cint%5Eb_a%20f(x)%20%5Coverline%7Bg(x)%7D%20dx%5Cright%5C%7C%0A%20%20%20%20&amp;%5Cleq%20%5Csqrt%7B%5Cint%5Eb_a%20f(x)%20%5Coverline%7Bf(x)%7D%20dx%7D%5Csqrt%7B%5Cint%5Eb_a%20g(x)%20%5Coverline%7Bg(x)%7D%20dx%7D%5C%5C%5B5pt%5D%0A%20%20%20%20&amp;=%20%5Csqrt%7B%5Cint%5Eb_a%20%5C%7Cf(x)%5C%7C%5E2%20dx%7D%5Csqrt%7B%5Cint%5Eb_a%20%5C%7Cg(x)%5C%7C%5E2%20dx%7D%5C%5C%0A%5Cend%7Balign%7D%0A"></p>
</div>
<hr>


</section>

 ]]></description>
  <category>線形代数</category>
  <category>複素数</category>
  <guid>https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-04-07-inner-product/</guid>
  <pubDate>Mon, 07 Apr 2025 00:00:00 GMT</pubDate>
</item>
<item>
  <title>三角関数の加法定理</title>
  <dc:creator>Ryo Nakagami</dc:creator>
  <link>https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-03-05-addition-theorem/</link>
  <description><![CDATA[ 





<section id="加法定理" class="level2">
<h2 class="anchored" data-anchor-id="加法定理">加法定理</h2>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="thm-" class="custom_problem theorem">
<p><span class="theorem-title"><strong>Theorem 1</strong></span> : 加法定理 <br></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Csin%20(%5Calpha%20+%20%5Cbeta)%20&amp;=%20%5Csin%20%5Calpha%20%5Ccos%20%5Cbeta%20+%20%5Ccos%20%5Calpha%20%5Csin%20%5Cbeta%5C%5C%0A%5Ccos%20(%5Calpha%20+%20%5Cbeta)%20&amp;=%20%5Ccos%20%5Calpha%20%5Ccos%20%5Cbeta%20-%20%5Csin%20%5Calpha%20%5Csin%20%5Cbeta%0A%5Cend%7Balign%7D%0A"></p>
</div>
</div>
<p>「咲いたコスモス，コスモス咲いた」なり「<del>しこってこすってこすってしこって</del>」と語呂合わせで加法定理を覚えたりしますが，ここでは加法定理を図形的に考えてみたいと思います．</p>
<div id="fig-plot" class="center quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<iframe src="./kahoteiri.html" width="1000" height="400"></iframe>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1
</figcaption>
</figure>
</div>
<p>Figure&nbsp;1 のように半径 <img src="https://latex.codecogs.com/png.latex?1"> の単位円周上に <img src="https://latex.codecogs.com/png.latex?%5Cangle%20DOB%20=%20%5Calpha%20+%20%5Cbeta"> となる点 <img src="https://latex.codecogs.com/png.latex?B"> をとります． 同じく <img src="https://latex.codecogs.com/png.latex?%5Cangle%20AOD%20=%20%5Calpha"> となるように点をとると，<img src="https://latex.codecogs.com/png.latex?%5Cangle%20BOA%20=%20%5Cbeta"> となります．このとき，点 <img src="https://latex.codecogs.com/png.latex?B"> の <img src="https://latex.codecogs.com/png.latex?y"> 成分は <img src="https://latex.codecogs.com/png.latex?%5Csin(%5Calpha%20+%20%5Cbeta)"> となります．</p>
<p>点 <img src="https://latex.codecogs.com/png.latex?B"> から直線 <img src="https://latex.codecogs.com/png.latex?OA"> 上に垂線を下ろし，その交点を <img src="https://latex.codecogs.com/png.latex?C"> とすると <img src="https://latex.codecogs.com/png.latex?OB%20=%201"> より</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0ABC%20&amp;%20=%20%5Csin%5Cbeta%5C%5C%0AOC%20&amp;=%20%5Ccos%5Cbeta%0A%5Cend%7Balign%7D%0A"></p>
<p>となることがわかります．点 <img src="https://latex.codecogs.com/png.latex?C"> から垂線を下ろし，<img src="https://latex.codecogs.com/png.latex?x"> 軸との交点を <img src="https://latex.codecogs.com/png.latex?E">, <img src="https://latex.codecogs.com/png.latex?B"> から直線 <img src="https://latex.codecogs.com/png.latex?CE"> との交点を <img src="https://latex.codecogs.com/png.latex?F"> とすると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0ACE%20&amp;=%20%5Csin%20%5Calpha%5Ccos%5Cbeta%5C%5C%0ACF%20&amp;=%20%5Ccos%5Calpha%5Csin%5Cbeta%0A%5Cend%7Balign%7D%0A"></p>
<p>したがって，<img src="https://latex.codecogs.com/png.latex?CE%20+%20CF%20=%20%5Csin(%5Calpha%20+%20%5Cbeta)"> となることから</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Csin%20(%5Calpha%20+%20%5Cbeta)%20=%20%5Csin%20%5Calpha%20%5Ccos%20%5Cbeta%20+%20%5Ccos%20%5Calpha%20%5Csin%20%5Cbeta%0A"></p>
<p>となることが図形的にわかります．同様に</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0AOE%20&amp;=%20%5Ccos%5Calpha%5Ccos%5Cbeta%5C%5C%0ABF&amp;=%20%5Csin%5Calpha%5Csin%5Cbeta%0A%5Cend%7Balign%7D%0A"></p>
<p>より</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ccos(%5Calpha%20+%20%5Cbeta)%20=%20OE%20-%20BF%20=%20%5Ccos%5Calpha%5Ccos%5Cbeta%20-%20%5Csin%5Calpha%5Csin%5Cbeta%0A"></p>
<p><strong> ▶&nbsp; ２角の差 <img src="https://latex.codecogs.com/png.latex?%5Calpha%20-%20%5Cbeta"> の場合</strong></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Csin(-%5Cbeta)%20=%20-%5Csin(%5Cbeta)"> および <img src="https://latex.codecogs.com/png.latex?%5Ccos(-%5Cbeta)%20=%20%5Ccos%5Cbeta"> より</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Csin%20(%5Calpha%20-%20%5Cbeta)%0A%20%20%20%20&amp;=%20%5Csin%20(%5Calpha%20%20+%20(-%5Cbeta))%5C%5C%0A%20%20%20%20&amp;=%20%5Csin%20%5Calpha%20%5Ccos%20(-%5Cbeta)%20+%20%5Ccos%20%5Calpha%20%5Csin%20(-%5Cbeta)%5C%5C%0A%20%20%20%20&amp;=%20%5Csin%20%5Calpha%20%5Ccos%20%5Cbeta%20-%20%5Ccos%20%5Calpha%20%5Csin%20%5Cbeta%0A%5Cend%7Balign%7D%0A"></p>
<p>同様に</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Ccos%20(%5Calpha%20-%20%5Cbeta)%0A%20%20%20%20&amp;=%20%5Ccos%20(%5Calpha%20%20+%20(-%5Cbeta))%5C%5C%0A%20%20%20%20&amp;=%20%5Ccos%20%5Calpha%20%5Ccos%20(-%5Cbeta)%20-%20%5Csin%20%5Calpha%20%5Csin%20(-%5Cbeta)%5C%5C%0A%20%20%20%20&amp;=%20%5Ccos%20%5Calpha%20%5Ccos%20%5Cbeta%20+%20%5Csin%20%5Calpha%20%5Csin%20%5Cbeta%0A%5Cend%7Balign%7D%0A"></p>
<p>以上より</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Csin%20(%5Calpha%20%5Cpm%20%5Cbeta)%20&amp;=%20%5Csin%20%5Calpha%20%5Ccos%20%5Cbeta%20%5Cpm%20%5Ccos%20%5Calpha%20%5Csin%20%5Cbeta%5C%5C%0A%5Ccos%20(%5Calpha%20%5Cpm%20%5Cbeta)%20&amp;=%20%5Ccos%20%5Calpha%20%5Ccos%20%5Cbeta%20%5Cmp%20%5Csin%20%5Calpha%20%5Csin%20%5Cbeta%0A%5Cend%7Balign%7D%0A"></p>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<p><strong>📘 REMARKS</strong> <br></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Csin%20%5Ctheta"> は奇関数，<img src="https://latex.codecogs.com/png.latex?%5Ccos%20%5Ctheta"> は偶関数であることに留意すると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Ctext%7B%E5%A5%87%E9%96%A2%E6%95%B0%7D%20%5Ctimes%20%5Ctext%7B%E5%81%B6%E9%96%A2%E6%95%B0%7D%20&amp;=%20%5Ctext%7B%E5%A5%87%E9%96%A2%E6%95%B0%7D%5C%5C%0A%5Ctext%7B%E5%81%B6%E9%96%A2%E6%95%B0%7D%20%5Ctimes%20%5Ctext%7B%E5%81%B6%E9%96%A2%E6%95%B0%7D%20&amp;=%20%5Ctext%7B%E5%81%B6%E9%96%A2%E6%95%B0%7D%5C%5C%0A%5Ctext%7B%E5%81%B6%E9%96%A2%E6%95%B0%7D%20+%20%5Ctext%7B%E5%81%B6%E9%96%A2%E6%95%B0%7D%20&amp;=%20%5Ctext%7B%E5%81%B6%E9%96%A2%E6%95%B0%7D%5C%5C%0A%5Ctext%7B%E5%A5%87%E9%96%A2%E6%95%B0%7D%20+%20%5Ctext%7B%E5%A5%87%E9%96%A2%E6%95%B0%7D%20&amp;=%20%5Ctext%7B%E5%A5%87%E9%96%A2%E6%95%B0%7D%0A%5Cend%7Balign%7D%0A"></p>
<p>であるので，加法定理のRHSとLHSがそれぞれ対応していることがわかります．</p>
</div>
<section id="オイラーの公式と加法定理" class="level3">
<h3 class="anchored" data-anchor-id="オイラーの公式と加法定理">オイラーの公式と加法定理</h3>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="thm-" class="custom_problem theorem">
<p><span class="theorem-title"><strong>Theorem 2</strong></span> <strong>: オイラーの公式</strong> <br></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cexp(i%5Ctheta)%20=%20%5Ccos%5Ctheta%20+%20i%5Csin%5Ctheta%0A"></p>
</div>
</div>
<!--::: {.callout-note collapse="true" icon=false}-->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
オイラーの公式を用いた加法定理の導出
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Cexp(i(%5Calpha%20+%20%5Cbeta))%0A%20%20%20%20&amp;=%20%5Cexp(i%5Calpha)%5Cexp(i%5Cbeta)%5C%5C%0A%20%20%20%20&amp;=%20(%5Ccos%5Calpha%20+%20i%5Csin%5Calpha)(%5Ccos%5Cbeta%20+%20i%5Csin%5Cbeta)%5C%5C%0A%20%20%20%20&amp;=%20%5Ccos%5Calpha%5Ccos%5Cbeta%20-%20%5Csin%5Calpha%5Csin%5Cbeta%20+%20i(%5Csin%5Calpha%5Ccos%5Cbeta%20+%20%5Ccos%5Calpha%5Csin%5Cbeta)%0A%5Cend%7Balign%7D%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cexp(i(%5Calpha%20+%20%5Cbeta))%20=%20%5Ccos(%5Calpha%20+%20%5Cbeta)%20+%20i%5Csin(%5Calpha%20+%20%5Cbeta)"> であることから実部と虚部の比較より</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Csin%20(%5Calpha%20+%20%5Cbeta)%20&amp;=%20%5Csin%20%5Calpha%20%5Ccos%20%5Cbeta%20+%20%5Ccos%20%5Calpha%20%5Csin%20%5Cbeta%5C%5C%0A%5Ccos%20(%5Calpha%20+%20%5Cbeta)%20&amp;=%20%5Ccos%20%5Calpha%20%5Ccos%20%5Cbeta%20-%20%5Csin%20%5Calpha%20%5Csin%20%5Cbeta%0A%5Cend%7Balign%7D%0A"></p>
<p>二角の差の場合は</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cexp(i(%5Calpha%20-%20%5Cbeta))=%20%5Cexp(i%5Calpha)%5Cexp(-i%5Cbeta)%0A"></p>
<p>から同様に示すことが出来ます．</p>
</div>
</div>
</div>
</section>
<section id="正接の加法定理" class="level3">
<h3 class="anchored" data-anchor-id="正接の加法定理">正接の加法定理</h3>
<!--::: {.callout-note collapse="true" icon=false}-->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>正弦と余弦の加法定理より</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Ctan(%5Calpha%20%5Cpm%20%5Cbeta)%0A%20%20%20%20&amp;=%20%5Cfrac%7B%5Csin(%5Calpha%20%5Cpm%20%5Cbeta)%7D%7B%5Ccos(%5Calpha%20%5Cpm%20%5Cbeta)%7D%5C%5C%0A%20%20%20%20&amp;=%20%5Cfrac%7B%5Csin%20%5Calpha%20%5Ccos%20%5Cbeta%20%5Cpm%20%5Ccos%20%5Calpha%20%5Csin%20%5Cbeta%7D%7B%5Ccos%20%5Calpha%20%5Ccos%20%5Cbeta%20%5Cmp%20%5Csin%20%5Calpha%20%5Csin%20%5Cbeta%7D%0A%5Cend%7Balign%7D%0A"></p>
<p>分子と分母を <img src="https://latex.codecogs.com/png.latex?%5Ccos%20%5Calpha%20%5Ccos%20%5Cbeta"> で割ると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Ctan(%5Calpha%20%5Cpm%20%5Cbeta)%20=%20%5Cfrac%7B%5Ctan%20%5Calpha%20%5Cpm%20%5Ctan%20%5Cbeta%7D%7B1%20%5Cmp%20%5Ctan%20%5Calpha%20%5Ctan%20%5Cbeta%7D%0A%5Cend%7Balign%7D%0A"></p>
</div>
</div>
</div>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="exr-" class="custom_problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1</strong></span> <br></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctan%201%5E%5Ccirc"> が無理数であることを示せ</p>
</div>
</div>
<!--::: {.callout-note collapse="true" icon=false}-->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5Ctan%201%5E%5Ccirc"> がとある有理数 <img src="https://latex.codecogs.com/png.latex?a"> であると仮定すると，加法定理より</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctan%202%5E%5Ccirc%20=%20%5Cfrac%7B2a%7D%7B1%20-%20a%5E2%7D%0A"></p>
<p>となり，有理数の四則演算は有理数で閉じていることから <img src="https://latex.codecogs.com/png.latex?%5Ctan%202%5E%5Ccirc"> も有理数であることがわかる．同様に <img src="https://latex.codecogs.com/png.latex?4%5E%5Ccirc,%208%5E%5Ccirc,%2016%5E%5Ccirc,%2032%5E%5Ccirc"> も有理数であることがわかる．</p>
<p>ここで，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctan%2030%5E%5Ccirc%20=%20%5Cfrac%7B%5Csqrt%7B3%7D%7D%7B3%7D%0A"></p>
<p>より <img src="https://latex.codecogs.com/png.latex?%5Ctan%2030%5E%5Ccirc"> は無理数であることに着目する．一方，<img src="https://latex.codecogs.com/png.latex?%5Ctan%2030%5E%5Ccirc"> は加法定理より</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Ctan%2030%5E%5Ccirc%0A%20%20%20%20&amp;=%20%5Ctan%20(32%5E%5Ccirc%20-%202%5E%5Ccirc)%5C%5C%0A%20%20%20%20&amp;=%20%5Cfrac%7B%5Ctan%2032%5E%5Ccirc%20+%20%5Ctan%202%5E%5Ccirc%7D%7B1%20+%20%5Ctan%2032%5E%5Ccirc%5Ctan%202%5E%5Ccirc%7D%0A%5Cend%7Balign%7D%0A"></p>
<p>このとき，<img src="https://latex.codecogs.com/png.latex?%5Ctan%2032%5E%5Ccirc,%20%5Ctan%202%5E%5Ccirc"> はともに有理数であるので， <img src="https://latex.codecogs.com/png.latex?%5Ctan%2030%5E%5Ccirc"> は無理数であることと矛盾． したがって，<img src="https://latex.codecogs.com/png.latex?%5Ctan%201%5E%5Ccirc"> は無理数である．</p>
</div>
</div>
</div>
</section>
</section>
<section id="倍角の公式とサインカーブ" class="level2">
<h2 class="anchored" data-anchor-id="倍角の公式とサインカーブ">倍角の公式とサインカーブ</h2>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="thm-" class="custom_problem theorem">
<p><span class="theorem-title"><strong>Theorem 3</strong></span> <strong>: 倍角の公式</strong> <br></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Csin%202%5Ctheta%20&amp;=%202%5Csin%5Ctheta%5Ccos%5Ctheta%5C%5C%0A%5Ccos%202%5Ctheta%20&amp;=%20%5Ccos%5E2%5Ctheta%20-%20%5Csin%5E2%5Ctheta%5C%5C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20&amp;=%201%20-%202%5Csin%5E2%5Ctheta%20=%202%5Ccos%5E2%5Ctheta%20-%201%5C%5C%0A%5Ctan%202%5Ctheta%20&amp;=%20%5Cfrac%7B2%5Ctan%5Ctheta%7D%7B1%20-%20%5Ctan%5E2%5Ctheta%7D%0A%5Cend%7Balign%7D%0A"></p>
</div>
</div>
<p><img src="https://latex.codecogs.com/png.latex?y%20=%20%5Csin%20x"> は振幅 <img src="https://latex.codecogs.com/png.latex?1"> で周期 <img src="https://latex.codecogs.com/png.latex?2%5Cpi"> の周期関数ですが，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ay%20=%20%5Calpha%5Csin%20%5Cbeta%20x%20%5Cquad%20%5Calpha%20%3E%200,%20%5Cbeta%20%3E%200%0A"></p>
<p>と変形すると，振幅 <img src="https://latex.codecogs.com/png.latex?%5Calpha"> で周期 <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20%5Cfrac%7B2%5Cpi%7D%7B%5Cbeta%7D"> の周期関数となります．</p>
<div id="82f61be9" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.ticker <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> ticker</span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the x values</span></span>
<span id="cb1-6">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.pi, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.pi, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>)</span>
<span id="cb1-7"></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the y values for both functions</span></span>
<span id="cb1-9">y1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.sin(x)</span>
<span id="cb1-10">y2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.sin(x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-11">y3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x)</span>
<span id="cb1-12"></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the plot</span></span>
<span id="cb1-14">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb1-15">plt.plot(x, y1, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$y = \sin(x)$"</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b"</span>)</span>
<span id="cb1-16">plt.plot(x, y2, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$y = \sin(x/2)$"</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"r"</span>, linestyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--"</span>)</span>
<span id="cb1-17">plt.plot(x, y3, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$y = 3\sin(2x)$"</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray"</span>, linestyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--"</span>)</span>
<span id="cb1-18"></span>
<span id="cb1-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add labels, title, and legend</span></span>
<span id="cb1-20">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>)</span>
<span id="cb1-21">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>)</span>
<span id="cb1-22">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Comparison of $y = \sin(x)$ and $y = \sin(x/2)$, $y = 3\sin(2x)$"</span>)</span>
<span id="cb1-23">plt.axhline(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb1-24">plt.axvline(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb1-25">plt.legend()</span>
<span id="cb1-26">plt.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb1-27"></span>
<span id="cb1-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set x-ticks to multiples of pi</span></span>
<span id="cb1-29">xticks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.pi, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.pi, np.pi <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-30">xtick_labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb1-31">    <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$-2\pi$"</span>,</span>
<span id="cb1-32">    <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$-\frac{3\pi}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{2}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">$"</span>,</span>
<span id="cb1-33">    <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$-\pi$"</span>,</span>
<span id="cb1-34">    <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$-\frac{\pi}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{2}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">$"</span>,</span>
<span id="cb1-35">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0"</span>,</span>
<span id="cb1-36">    <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$\frac{\pi}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{2}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">$"</span>,</span>
<span id="cb1-37">    <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$\pi$"</span>,</span>
<span id="cb1-38">    <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$\frac{3\pi}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{2}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">$"</span>,</span>
<span id="cb1-39">    <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$2\pi$"</span>,</span>
<span id="cb1-40">]</span>
<span id="cb1-41">plt.xticks(xticks, xtick_labels)</span>
<span id="cb1-42"></span>
<span id="cb1-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Show the plot</span></span>
<span id="cb1-44">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-03-05-addition-theorem/index_files/figure-html/cell-2-output-1.png" width="810" height="532" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>次に，<img src="https://latex.codecogs.com/png.latex?y%20=%20%5Csin%20x%20%5Ccos%20x"> のグラフを考えてみます．加法定理より</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Csin%202x%0A%20%20%20%20&amp;=%20%5Csin%20(x%20+%20x)%5C%5C%0A%20%20%20%20&amp;=%202%5Csin%20x%5Ccos%20x%0A%5Cend%7Balign%7D%0A"></p>
<p>であることから</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Csin%20x%20%5Ccos%20x%20=%20%5Cfrac%7B1%7D%7B2%7D%5Csin%202x%0A"></p>
<p>つまり，<img src="https://latex.codecogs.com/png.latex?y%20=%20%5Csin%20x%20%5Ccos%20x"> のグラフは振幅 <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20%5Cfrac%7B1%7D%7B2%7D">，周期 <img src="https://latex.codecogs.com/png.latex?%5Cpi"> のサインカーブとなることがわかります．</p>
<div id="93f628f3" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb2-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb2-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.ticker <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> ticker</span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the x values</span></span>
<span id="cb2-6">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.pi, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.pi, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>)</span>
<span id="cb2-7"></span>
<span id="cb2-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the y values for both functions</span></span>
<span id="cb2-9">y1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.sin(x) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.cos(x)</span>
<span id="cb2-10">y2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.sin(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb2-11"></span>
<span id="cb2-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the plot</span></span>
<span id="cb2-13">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb2-14">plt.plot(x, y1, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$y = \sin(x)$"</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b"</span>)</span>
<span id="cb2-15">plt.plot(x, y2, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$y = \frac</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{1}{2}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">\sin(2x)$"</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray"</span>, linestyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--"</span>)</span>
<span id="cb2-16"></span>
<span id="cb2-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add labels, title, and legend</span></span>
<span id="cb2-18">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>)</span>
<span id="cb2-19">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>)</span>
<span id="cb2-20">plt.axhline(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb2-21">plt.axvline(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb2-22">plt.legend()</span>
<span id="cb2-23">plt.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb2-24"></span>
<span id="cb2-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set x-ticks to multiples of pi</span></span>
<span id="cb2-26">xticks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.pi, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.pi, np.pi <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb2-27">xtick_labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb2-28">    <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$-2\pi$"</span>,</span>
<span id="cb2-29">    <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$-\frac{3\pi}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{2}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">$"</span>,</span>
<span id="cb2-30">    <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$-\pi$"</span>,</span>
<span id="cb2-31">    <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$-\frac{\pi}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{2}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">$"</span>,</span>
<span id="cb2-32">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0"</span>,</span>
<span id="cb2-33">    <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$\frac{\pi}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{2}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">$"</span>,</span>
<span id="cb2-34">    <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$\pi$"</span>,</span>
<span id="cb2-35">    <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$\frac{3\pi}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{2}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">$"</span>,</span>
<span id="cb2-36">    <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$2\pi$"</span>,</span>
<span id="cb2-37">]</span>
<span id="cb2-38">plt.xticks(xticks, xtick_labels)</span>
<span id="cb2-39"></span>
<span id="cb2-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Show the plot</span></span>
<span id="cb2-41">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-03-05-addition-theorem/index_files/figure-html/cell-3-output-1.png" width="823" height="511" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="thm-" class="custom_problem theorem">
<p><span class="theorem-title"><strong>Theorem 4</strong></span> <strong>: 半角の公式</strong> <br></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Csin%5E2%20%5Cfrac%7B%5Ctheta%7D%7B2%7D%20&amp;=%20%5Cfrac%7B1%20-%20%5Ccos%5Ctheta%7D%7B2%7D%5C%5C%0A%5Ccos%5E2%20%5Cfrac%7B%5Ctheta%7D%7B2%7D%20&amp;=%20%5Cfrac%7B1%20+%20%5Ccos%5Ctheta%7D%7B2%7D%5C%5C%0A%5Ctan%5E2%20%5Cfrac%7B%5Ctheta%7D%7B2%7D%20&amp;=%20%5Cfrac%7B1%20-%20%5Ccos%5Ctheta%7D%7B1%20+%20%5Ccos%5Ctheta%7D%0A%5Cend%7Balign%7D%0A"></p>
</div>
</div>
<div id="exm-" class="custom_problem theorem example">
<p><span class="theorem-title"><strong>Example 1</strong></span> <br></p>
<p><img src="https://latex.codecogs.com/png.latex?y%20=%20%5Csin%5E2%20x"> について考えてみます．正弦関数は奇関数であるので，<img src="https://latex.codecogs.com/png.latex?%5Csin%5E2%20x"> は偶関数になるはずです．半角の公式を用いると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Csin%5E2%20x%20=%20%5Cfrac%7B1%20-%20%5Ccos%202x%7D%7B2%7D%0A"></p>
<p>となるので，振幅 <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%5Cfrac%7B1%7D%7B2%7D">, 周期 <img src="https://latex.codecogs.com/png.latex?%5Cpi"> のコサインカーブを <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%5Cfrac%7B1%7D%7B2%7D"> 平行移動したものであることがわかります．</p>
<div id="d11d3229" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb3-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb3-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.ticker <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> ticker</span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the x values</span></span>
<span id="cb3-6">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.pi, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.pi, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>)</span>
<span id="cb3-7"></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the y values for both functions</span></span>
<span id="cb3-9">y1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> np.cos(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb3-10">y2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.cos(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x)</span>
<span id="cb3-11"></span>
<span id="cb3-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the plot</span></span>
<span id="cb3-13">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb3-14">plt.plot(x, y1, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$y = \sin^2(x)$"</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b"</span>)</span>
<span id="cb3-15">plt.plot(x, y2, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$y = \cos(x)$"</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray"</span>, linestyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--"</span>)</span>
<span id="cb3-16"></span>
<span id="cb3-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add labels, title, and legend</span></span>
<span id="cb3-18">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>)</span>
<span id="cb3-19">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>)</span>
<span id="cb3-20">plt.axhline(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb3-21">plt.axvline(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb3-22">plt.legend( loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'lower right'</span>,)</span>
<span id="cb3-23">plt.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb3-24"></span>
<span id="cb3-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set x-ticks to multiples of pi</span></span>
<span id="cb3-26">xticks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.pi, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.pi, np.pi <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb3-27">xtick_labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb3-28">    <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$-2\pi$"</span>,</span>
<span id="cb3-29">    <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$-\frac{3\pi}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{2}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">$"</span>,</span>
<span id="cb3-30">    <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$-\pi$"</span>,</span>
<span id="cb3-31">    <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$-\frac{\pi}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{2}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">$"</span>,</span>
<span id="cb3-32">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0"</span>,</span>
<span id="cb3-33">    <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$\frac{\pi}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{2}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">$"</span>,</span>
<span id="cb3-34">    <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$\pi$"</span>,</span>
<span id="cb3-35">    <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$\frac{3\pi}</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{2}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">$"</span>,</span>
<span id="cb3-36">    <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$2\pi$"</span>,</span>
<span id="cb3-37">]</span>
<span id="cb3-38">plt.xticks(xticks, xtick_labels)</span>
<span id="cb3-39"></span>
<span id="cb3-40"></span>
<span id="cb3-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Show the plot</span></span>
<span id="cb3-42">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-03-05-addition-theorem/index_files/figure-html/cell-4-output-1.png" width="683" height="511" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<hr>
</section>
<section id="和積の公式" class="level2">
<h2 class="anchored" data-anchor-id="和積の公式">和積の公式</h2>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="thm-" class="custom_problem theorem">
<p><span class="theorem-title"><strong>Theorem 5</strong></span> <strong>: 正弦関数の和積の公式</strong> <br></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Csin%20%5Calpha%20+%20%5Csin%5Cbeta%20&amp;=%202%20%5Csin%20%5Cfrac%7B%5Calpha+%5Cbeta%7D%7B2%7D%5Ccos%20%5Cfrac%7B%5Calpha-%5Cbeta%7D%7B2%7D%5C%5C%0A%5Csin%20%5Calpha%20-%20%5Csin%5Cbeta%20&amp;=%202%20%5Ccos%20%5Cfrac%7B%5Calpha+%5Cbeta%7D%7B2%7D%5Csin%20%5Cfrac%7B%5Calpha-%5Cbeta%7D%7B2%7D%5C%5C%0A%5Ccos%20%5Calpha%20+%20%5Ccos%5Cbeta%20&amp;=%202%20%5Ccos%20%5Cfrac%7B%5Calpha+%5Cbeta%7D%7B2%7D%5Ccos%20%5Cfrac%7B%5Calpha-%5Cbeta%7D%7B2%7D%5C%5C%0A%5Ccos%20%5Calpha%20-%20%5Ccos%5Cbeta%20&amp;=%20-2%20%5Csin%20%5Cfrac%7B%5Calpha+%5Cbeta%7D%7B2%7D%5Csin%20%5Cfrac%7B%5Calpha-%5Cbeta%7D%7B2%7D%0A%5Cend%7Balign%7D%0A"></p>
</div>
</div>
<!--::: {.callout-note collapse="true" icon=false}-->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>加法定理より</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Csin%20(%5Cgamma%20+%20%5Cdelta)%0A%20%20%20%20&amp;=%20%5Csin%5Cgamma%20%5Ccos%5Cdelta%20+%20%5Ccos%5Cgamma%20%5Csin%5Cdelta%5C%5C%0A%5Csin%20(%5Cgamma%20-%20%5Cdelta)%0A%20%20%20%20&amp;=%20%5Csin%5Cgamma%20%5Ccos%5Cdelta%20-%20%5Ccos%5Cgamma%20%5Csin%5Cdelta%0A%5Cend%7Balign%7D%0A"></p>
<p>これを整理すると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Csin%20(%5Cgamma%20+%20%5Cdelta)%20+%20%5Csin%20(%5Cgamma%20-%20%5Cdelta)%20&amp;=%202%5Csin%5Cgamma%20%5Ccos%5Cdelta%5C%5C%0A%5Csin%20(%5Cgamma%20+%20%5Cdelta)%20-%20%5Csin%20(%5Cgamma%20-%20%5Cdelta)%20&amp;=%202%5Ccos%5Cgamma%20%5Csin%5Cdelta%0A%5Cend%7Balign%7D%0A"></p>
<p>ここで，<img src="https://latex.codecogs.com/png.latex?%5Cgamma%20+%20%5Cdelta%20=%20%5Calpha,%20%5Cgamma%20-%20%5Cdelta%20=%20%5Cbeta"> とおくと</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bgather%7D%0A%5Cgamma%20=%20%5Cfrac%7B%20%5Calpha%20+%20%5Cbeta%7D%7B2%7D,%20%5Cquad%20%5Cdelta%20=%20%5Cfrac%7B%5Calpha%20-%20%5Cbeta%7D%7B2%7D%0A%5Cend%7Bgather%7D%0A"></p>
<p>となるので</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Csin%20%5Calpha%20+%20%5Csin%5Cbeta%20&amp;=%202%20%5Csin%20%5Cfrac%7B%5Calpha+%5Cbeta%7D%7B2%7D%5Ccos%20%5Cfrac%7B%5Calpha-%5Cbeta%7D%7B2%7D%5C%5C%0A%5Csin%20%5Calpha%20-%20%5Csin%5Cbeta%20&amp;=%202%20%5Ccos%20%5Cfrac%7B%5Calpha+%5Cbeta%7D%7B2%7D%5Csin%20%5Cfrac%7B%5Calpha-%5Cbeta%7D%7B2%7D%0A%5Cend%7Balign%7D%0A"></p>
<p>余弦関数も同様に</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Ccos%20(%5Cgamma%20+%20%5Cdelta)%0A%20%20%20%20&amp;=%20%5Ccos%5Cgamma%20%5Ccos%5Cdelta%20-%20%5Csin%5Cgamma%20%5Csin%5Cdelta%5C%5C%0A%5Ccos%20(%5Cgamma%20-%20%5Cdelta)%0A%20%20%20%20&amp;=%20%5Ccos%5Cgamma%20%5Ccos%5Cdelta%20+%20%5Csin%5Cgamma%20%5Csin%5Cdelta%0A%5Cend%7Balign%7D%0A"></p>
<p>であるので</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Ccos%20(%5Cgamma%20+%20%5Cdelta)%20+%20%5Ccos%20(%5Cgamma%20-%20%5Cdelta)%20&amp;=%202%5Ccos%5Cgamma%20%5Ccos%5Cdelta%5C%5C%0A%5Ccos%20(%5Cgamma%20+%20%5Cdelta)%20-%20%5Ccos%20(%5Cgamma%20-%20%5Cdelta)%20&amp;=%20-2%5Csin%5Cgamma%20%5Csin%5Cdelta%0A%5Cend%7Balign%7D%0A"></p>
<p>から導くことができます．</p>
</div>
</div>
</div>
<div id="exm-addtive-and-product" class="custom_problem theorem example">
<p><span class="theorem-title"><strong>Example 2</strong></span> <br></p>
<p><img src="https://latex.codecogs.com/png.latex?x%20+%20y%20+%20z%20=%20%5Cpi"> を満たす実数 <img src="https://latex.codecogs.com/png.latex?x,%20y,%20z"> について</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Csin%20x%20+%20%5Csin%20y%20+%20%5Csin%20z%20=%204%20%5Ccos%5Cfrac%7Bx%7D%7B2%7D%5Ccos%5Cfrac%7By%7D%7B2%7D%5Ccos%5Cfrac%7Bz%7D%7B2%7D%0A"></p>
<p>が成り立ちます．LHSを式変形すると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Csin%20x%20+%20%5Csin%20y%20+%20%5Csin%20z%0A%20%20%20%20&amp;=%20%5Csin%20x%20+%20%5Csin%20y%20+%20%5Csin%20(%5Cpi%20-%20(x%20+%20y))%5C%5C%0A%20%20%20%20&amp;=%20%5Csin%20x%20+%20%5Csin%20y%20+%20%5Csin%20(x%20+%20y)%5C%5C%0A%20%20%20%20&amp;=%202%5Csin%5Cfrac%7Bx+y%7D%7B2%7D%5Ccos%5Cfrac%7Bx-y%7D%7B2%7D%20+%202%5Csin%5Cfrac%7Bx+y%7D%7B2%7D%5Ccos%5Cfrac%7Bx+y%7D%7B2%7D%5C%5C%0A%20%20%20%20&amp;=%202%5Csin%5Cfrac%7Bx+y%7D%7B2%7D%5Cleft(%5Ccos%5Cfrac%7Bx-y%7D%7B2%7D%20+%20%5Ccos%5Cfrac%7Bx+y%7D%7B2%7D%5Cright)%5C%5C%0A%20%20%20%20&amp;=%202%5Csin%5Cfrac%7Bx+y%7D%7B2%7D%5Ctimes%202%5Ccos%5Cfrac%7B%5Cfrac%7Bx-y%7D%7B2%7D%20+%20%5Cfrac%7Bx-y%7D%7B2%7D%7D%7B2%7D%5Ccos%5Cfrac%7B%5Cfrac%7Bx-y%7D%7B2%7D%20-%20%5Cfrac%7Bx-y%7D%7B2%7D%7D%7B2%7D%5C%5C%0A%20%20%20%20&amp;=4%5Csin%5Cfrac%7Bx+y%7D%7B2%7D%5Ccos%5Cfrac%7Bx%7D%7B2%7D%5Ccos%5Cfrac%7B-y%7D%7B2%7D%5C%5C%0A%20%20%20%20&amp;=4%5Csin%5Cfrac%7B%5Cpi-z%7D%7B2%7D%5Ccos%5Cfrac%7Bx%7D%7B2%7D%5Ccos%5Cfrac%7By%7D%7B2%7D%5C%5C%0A%20%20%20%20&amp;=4%5Ccos%5Cfrac%7Bz%7D%7B2%7D%5Ccos%5Cfrac%7Bx%7D%7B2%7D%5Ccos%5Cfrac%7By%7D%7B2%7D%0A%5Cend%7Balign%7D%0A"></p>
</div>
<hr>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<ul>
<li><a href="../../posts/2025-02-27-how-to-compute-tan75/index.html">Regmonkey Datascience Blog &gt; tangent 75°の図形的計算</a></li>
<li><a href="../2025-03-04-incircle-of-triangle/">Regmonkey Datascience Blog &gt; 三角形の内接円</a></li>
</ul>


</section>

 ]]></description>
  <category>三角関数</category>
  <guid>https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-03-05-addition-theorem/</guid>
  <pubDate>Wed, 05 Mar 2025 00:00:00 GMT</pubDate>
</item>
<item>
  <title>いろいろな三角不等式</title>
  <dc:creator>Ryo Nakagami</dc:creator>
  <link>https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-03-03-triangle-inequality/</link>
  <description><![CDATA[ 





<section id="シュワルツの不等式と三角不等式" class="level2">
<h2 class="anchored" data-anchor-id="シュワルツの不等式と三角不等式">シュワルツの不等式と三角不等式</h2>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="thm-" class="custom_problem theorem">
<p><span class="theorem-title"><strong>Theorem 1</strong></span> <strong>: シュワルツの不等式</strong> <br></p>
<p>任意の２つのベクトル <img src="https://latex.codecogs.com/png.latex?%5Cpmb%7Ba%7D,%20%5Cpmb%7Bb%7D"> に対して，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cvert%20(%5Cpmb%7Ba%7D,%20%5Cpmb%7Bb%7D)%5Cvert%20%5Cleq%20%7C%7C%5Cpmb%7Ba%7D%7C%7C%5C,%7C%7C%5Cpmb%7Bb%7D%7C%7C%0A"></p>
<p>等号が成り立つのは <img src="https://latex.codecogs.com/png.latex?%5Cpmb%20a%20=%20k%5Cpmb%20b"> または, <img src="https://latex.codecogs.com/png.latex?%5Cpmb%20b%20=%20k%5E%5Cprime%5Cpmb%20a"> が成り立つ場合に限る(<img src="https://latex.codecogs.com/png.latex?k,k%5E%5Cprime%20%5Cin%20%5Cmathbf%20R">)．</p>
</div>
</div>
<!--::: {.callout-note collapse="true" icon=false}-->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><strong> ▶&nbsp; <img src="https://latex.codecogs.com/png.latex?%5Cpmb%20b%20=%20%5Cpmb%200"> のとき</strong></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cpmb%20b%20=%20%5Cpmb%200"> のときは等号が成り立つことは自明．</p>
<p><strong> ▶&nbsp; <img src="https://latex.codecogs.com/png.latex?%5Cpmb%20b%20%5Cneq%20%5Cpmb%200"> のとき</strong></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20k%20=%20%5Cfrac%7B(%5Cpmb%20a,%20%5Cpmb%20b)%7D%7B%7C%7C%5Cpmb%20b%7C%7C%5E2%7D"> とおくと，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%7C%7C%5Cpmb%20a%20-%20k%5Cpmb%20b%7C%7C%5E2%0A%20%20%20%20&amp;=%20%7C%7C%5Cpmb%20a%7C%7C%5E2%20-%202k(%5Cpmb%20a,%20%5Cpmb%20b)%20+%20k%5E2%20%7C%7C%5Cpmb%20b%7C%7C%5E2%5C%5C%0A%20%20%20%20&amp;=%20%7C%7C%5Cpmb%20a%7C%7C%5E2%20-%202%5Cfrac%7B(%5Cpmb%20a,%20%5Cpmb%20b)%5E2%7D%7B%7C%7C%5Cpmb%20b%7C%7C%5E2%7D%20+%20%5Cfrac%7B(%5Cpmb%20a,%20%5Cpmb%20b)%5E2%7D%7B%7C%7C%5Cpmb%20b%7C%7C%5E2%7D%5C%5C%0A%20%20%20%20&amp;=%20%7C%7C%5Cpmb%20a%7C%7C%5E2%20-%20%5Cfrac%7B(%5Cpmb%20a,%20%5Cpmb%20b)%5E2%7D%7B%7C%7C%5Cpmb%20b%7C%7C%5E2%7D%0A%5Cend%7Balign%7D%0A"></p>
<p>ここで，<img src="https://latex.codecogs.com/png.latex?%7C%7C%5Cpmb%20a%20-%20k%5Cpmb%20b%7C%7C%5E2%20%5Cgeq%200"> であるので</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%7C%7C%5Cpmb%20a%7C%7C%5E2%20%5Cgeq%20%5Cfrac%7B(%5Cpmb%20a,%20%5Cpmb%20b)%5E2%7D%7B%7C%7C%5Cpmb%20b%7C%7C%5E2%7D%0A"></p>
<p>これを整理すると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%7C%7C%5Cpmb%20a%7C%7C%5E2%7C%7C%5Cpmb%20b%7C%7C%5E2%20%5Cgeq%20(%5Cpmb%20a,%20%5Cpmb%20b)%5E2%20%5CRightarrow%20%7C%7C%5Cpmb%20a%7C%7C%5C,%7C%7C%5Cpmb%20b%7C%7C%20%5Cgeq%20%7C(%5Cpmb%20a,%20%5Cpmb%20b)%7C%0A"></p>
<p>等号成立が成立するとき <img src="https://latex.codecogs.com/png.latex?%7C%7C%5Cpmb%20a%20-%20k%5Cpmb%20b%7C%7C%5E2%20=%200"> であるので，<img src="https://latex.codecogs.com/png.latex?%5Cpmb%20a%20=%20k%5Cpmb%20b"> が必要条件であることがわかります．</p>
<p><strong> ▶&nbsp; <img src="https://latex.codecogs.com/png.latex?%5Cpmb%20a%20=%20k%5Cpmb%20b"> の十分条件性 </strong></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%7C%7C%5Cpmb%20a%7C%7C%5C,%7C%7C%5Cpmb%20b%7C%7C%0A%20%20%20%20&amp;=%20%7Ck%7C%7C%7C%5Cpmb%20b%7C%7C%5C,%7C%7C%5Cpmb%20b%7C%7C%5C%5C%0A%20%20%20%20&amp;=%20%7Ck%7C%7C%7C%5Cpmb%20b%7C%7C%5E2%0A%5Cend%7Balign%7D%0A"></p>
<p>また</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%7C(%5Cpmb%20a,%20%5Cpmb%20b)%7C%0A%20%20%20%20&amp;=%20%7Ck%7C(%5Cpmb%20b,%20%5Cpmb%20b)%5C%5C%0A%20%20%20%20&amp;=%20%7Ck%7C%7C%7C%5Cpmb%20b%7C%7C%5E2%0A%5Cend%7Balign%7D%0A"></p>
<p>したがって，<img src="https://latex.codecogs.com/png.latex?%7C%5Cpmb%20a%7C%7C%5C,%7C%7C%5Cpmb%20b%7C%7C%20=%20%7C(%5Cpmb%20a,%20%5Cpmb%20b)%7C"> が成り立つことがわかります．</p>
</div>
</div>
</div>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="thm-" class="custom_problem theorem">
<p><span class="theorem-title"><strong>Theorem 2</strong></span> <strong>: シュワルツの不等式と三角不等式</strong> <br></p>
<p>任意の２つのベクトル <img src="https://latex.codecogs.com/png.latex?%5Cpmb%7Ba%7D,%20%5Cpmb%7Bb%7D"> に対して，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%7C%7C%5Cpmb%7Ba%7D%20+%20%5Cpmb%7Bb%7D%7C%7C%20%5Cleq%20%7C%7C%5Cpmb%7Ba%7D%7C%7C%5C,%20%7C%7C%5Cpmb%7Bb%7D%7C%7C%0A"></p>
<p>等号が成り立つのは <img src="https://latex.codecogs.com/png.latex?%5Cpmb%20a%20=%20k%5Cpmb%20b,%20k%5Cgeq%200"> または, <img src="https://latex.codecogs.com/png.latex?%5Cpmb%20b%20=%20k%5E%5Cprime%5Cpmb%20a,%20k%5E%5Cprime%5Cgeq%200"> が成り立つ場合に限る．</p>
</div>
</div>
<!--::: {.callout-note collapse="true" icon=false}-->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>シュワルツの不等式を用いると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%7C%7C%5Cpmb%7Ba%7D%20+%20%5Cpmb%7Bb%7D%7C%7C%5E2%0A%20%20%20%20&amp;=%20%7C%7C%5Cpmb%7Ba%7D%7C%7C%5E2%20+%202(%5Cpmb%7Ba%7D,%5Cpmb%7Bb%7D)%20+%20%7C%7C%5Cpmb%7Bb%7D%7C%7C%5E2%5C%5C%0A%20%20%20%20&amp;%5Cleq%20%7C%7C%5Cpmb%7Ba%7D%7C%7C%5E2%20+%202%7C%7C%5Cpmb%7Ba%7D%7C%7C%5C,%7C%7C%5Cpmb%7Bb%7D%7C%7C%20+%20%7C%7C%5Cpmb%7Bb%7D%7C%7C%5E2%5C%5C%0A%20%20%20%20&amp;=%20(%7C%7C%5Cpmb%7Ba%7D%7C%7C%20+%20%7C%7C%5Cpmb%7Bb%7D%7C%7C)%5E2%0A%5Cend%7Balign%7D%0A"></p>
<p>したがって，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%7C%7C%5Cpmb%7Ba%7D%20+%20%5Cpmb%7Bb%7D%7C%7C%20%5Cleq%20%7C%7C%5Cpmb%7Ba%7D%7C%7C%5C,%20%7C%7C%5Cpmb%7Bb%7D%7C%7C%0A"></p>
<p>等号成立はシュワルツの不等式の等号が成立し，かつ</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(%5Cpmb%7Ba%7D,%5Cpmb%7Bb%7D)%20%5Cgeq%200%0A"></p>
<p>が成立するときとなるので， <img src="https://latex.codecogs.com/png.latex?%5Cpmb%20a%20=%20k%5Cpmb%20b,%20k%5Cgeq%200"> または, <img src="https://latex.codecogs.com/png.latex?%5Cpmb%20b%20=%20k%5E%5Cprime%5Cpmb%20a,%20k%5E%5Cprime%5Cgeq%200"> が成り立つ場合に限ることがわかる．</p>
</div>
</div>
</div>
</section>
<section id="複素数と三角不等式" class="level2">
<h2 class="anchored" data-anchor-id="複素数と三角不等式">複素数と三角不等式</h2>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="thm-" class="custom_problem theorem">
<p><span class="theorem-title"><strong>Theorem 3</strong></span> <br></p>
<p>複素平面上に2点 <img src="https://latex.codecogs.com/png.latex?z%20=%20a_1%20+%20b_1i,%20w%20=%20a_2%20+%20b_2i"> をとったとき，次の不等式が成立する</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bgather%7D%0A%5Cvert%20z%20+%20w%20%5Cvert%20%5Cleq%20%5Cvert%20z%5Cvert%20+%20%5Cvert%20w%20%5Cvert%5C%5C%0A%5Cvert%20z%5Cvert%20-%20%5Cvert%20w%20%5Cvert%20%5Cleq%20%5Cvert%20z%20-%20w%20%5Cvert%0A%5Cend%7Bgather%7D%0A"></p>
<p>これを三角不等式と呼ぶ．</p>
</div>
</div>
<!--::: {.callout-note collapse="true" icon=false}-->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>注意: この証明は平面空間における三角不等式を前提にしているのでトートロジー疑惑が有ります</p>
<div id="01d03079" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the complex numbers</span></span>
<span id="cb1-5">alpha1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">4j</span></span>
<span id="cb1-6">alpha2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">2j</span></span>
<span id="cb1-7">alpha3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> alpha1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> alpha2</span>
<span id="cb1-8">alpha4 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> alpha1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> alpha2</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract the real and imaginary parts</span></span>
<span id="cb1-11">a1_real, a1_imag <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> alpha1.real, alpha1.imag</span>
<span id="cb1-12">a2_real, a2_imag <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> alpha2.real, alpha2.imag</span>
<span id="cb1-13">a3_real, a3_imag <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> alpha3.real, alpha3.imag</span>
<span id="cb1-14">a4_real, a4_imag <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> alpha4.real, alpha4.imag</span>
<span id="cb1-15"></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the plot</span></span>
<span id="cb1-17">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots()</span>
<span id="cb1-18"></span>
<span id="cb1-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the vectors</span></span>
<span id="cb1-20">ax.quiver(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, a1_real, a1_imag, angles<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"xy"</span>, scale_units<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"xy"</span>, scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"k"</span>)</span>
<span id="cb1-21">ax.quiver(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, a2_real, a2_imag, angles<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"xy"</span>, scale_units<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"xy"</span>, scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"k"</span>)</span>
<span id="cb1-22">ax.quiver(</span>
<span id="cb1-23">    a1_real,</span>
<span id="cb1-24">    a1_imag,</span>
<span id="cb1-25">    a2_real,</span>
<span id="cb1-26">    a2_imag,</span>
<span id="cb1-27">    angles<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"xy"</span>,</span>
<span id="cb1-28">    scale_units<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"xy"</span>,</span>
<span id="cb1-29">    linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb1-30">    scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb1-31">    edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray"</span>,</span>
<span id="cb1-32">    color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray"</span>,</span>
<span id="cb1-33">)</span>
<span id="cb1-34">ax.quiver(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, a3_real, a3_imag, angles<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"xy"</span>, scale_units<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"xy"</span>, scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"k"</span>)</span>
<span id="cb1-35">ax.quiver(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, a4_real, a4_imag, angles<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"xy"</span>, scale_units<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"xy"</span>, scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"k"</span>)</span>
<span id="cb1-36">ax.quiver(</span>
<span id="cb1-37">    a1_real,</span>
<span id="cb1-38">    a1_imag,</span>
<span id="cb1-39">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>a2_real,</span>
<span id="cb1-40">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>a2_imag,</span>
<span id="cb1-41">    angles<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"xy"</span>,</span>
<span id="cb1-42">    scale_units<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"xy"</span>,</span>
<span id="cb1-43">    linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb1-44">    scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb1-45">    edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray"</span>,</span>
<span id="cb1-46">    color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray"</span>,</span>
<span id="cb1-47">)</span>
<span id="cb1-48"></span>
<span id="cb1-49"></span>
<span id="cb1-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add point</span></span>
<span id="cb1-51">ax.text(a1_real, a1_imag <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$z$"</span>)</span>
<span id="cb1-52">ax.text(a2_real, a2_imag, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$w$"</span>)</span>
<span id="cb1-53">ax.text(a3_real, a3_imag, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$z+w$"</span>)</span>
<span id="cb1-54">ax.text(a4_real, a4_imag <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$z-w$"</span>)</span>
<span id="cb1-55"></span>
<span id="cb1-56"></span>
<span id="cb1-57"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set the plot limits</span></span>
<span id="cb1-58">ax.set_xlim(a4_real <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(a1_real, a3_real) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb1-59">ax.set_ylim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(a1_imag, a3_imag) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb1-60"></span>
<span id="cb1-61"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add grid, labels, and legend</span></span>
<span id="cb1-62">ax.grid()</span>
<span id="cb1-63">ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"equal"</span>)</span>
<span id="cb1-64">ax.set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Real Part"</span>)</span>
<span id="cb1-65">ax.set_ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Imaginary Part"</span>)</span>
<span id="cb1-66"></span>
<span id="cb1-67"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add title</span></span>
<span id="cb1-68">ax.set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Complex Number Vectors"</span>)</span>
<span id="cb1-69"></span>
<span id="cb1-70"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Show the plot</span></span>
<span id="cb1-71">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-03-03-triangle-inequality/index_files/figure-html/cell-2-output-1.png" width="573" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>原点と <img src="https://latex.codecogs.com/png.latex?z,%20z+w"> を頂点とする三角形を考えます．このときそれぞれの辺の長さは <img src="https://latex.codecogs.com/png.latex?%5Cvert%20z%5Cvert,%20%5Cvert%20w%5Cvert,%20%5Cvert%20z%20+%20w%5Cvert"> となります．</p>
<p>三角形の二辺の和は他の１辺の長さより長いので</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cvert%20z%20+%20w%20%5Cvert%20%5Cleq%20%5Cvert%20z%5Cvert%20+%20%5Cvert%20w%20%5Cvert%0A"></p>
<p>が成立する．</p>
<p>同様に<img src="https://latex.codecogs.com/png.latex?z,%20z-w"> を頂点とする三角形についても</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cvert%20z%20%5Cvert%20%5Cleq%20%5Cvert%20z%20+%20w%20%5Cvert%20+%20%5Cvert%20w%20%5Cvert%0A"></p>
<p>が成り立つので，これを整理すると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cvert%20z%5Cvert%20-%20%5Cvert%20w%20%5Cvert%20%5Cleq%20%5Cvert%20z%20-%20w%20%5Cvert%0A"></p>
</div>
</div>
</div>
<!--::: {.callout-note collapse="true" icon=false}-->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof 2
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>複素数の絶対値と共役複素数の関係より</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Cvert%20%20z%20+%20w%20%5Cvert%5E2%0A%20%20%20%20&amp;=%20(z%20+%20w)(%5Cbar%20z%20+%20%5Cbar%20w)%5C%5C%0A%20%20%20%20&amp;=%20z%5Cbar%20z%20+%20w%5Cbar%20w%20+%20w%5Cbar%20z%20+%20z%5Cbar%20w%5C%5C%0A%20%20%20%20&amp;=%20%5Cvert%20z%5Cvert%5E2%20+%20%5Cvert%20w%5Cvert%5E2%20+%20w%20%5Coverline%20z%20+%20z%20%5Coverline%20w%5C%5C%0A%20%20%20%20&amp;=%20%5Cvert%20z%5Cvert%5E2%20+%20%5Cvert%20w%5Cvert%5E2%20+%20w%20%5Coverline%20z%20+%20%5Coverline%7B%5Coverline%20z%20w%7D%5C%5C%0A%20%20%20%20&amp;=%20%5Cvert%20z%5Cvert%5E2%20+%20%5Cvert%20w%5Cvert%5E2%20+%202%5Coperatorname%7BRe%7Dw%20%5Coverline%20z%5C%5C%0A%20%20%20%20&amp;%5Cleq%20%5Cvert%20z%5Cvert%5E2%20+%20%5Cvert%20w%5Cvert%5E2%20+%202%5Cvert%20w%20%5Coverline%20z%5Cvert%5C%5C%0A%20%20%20%20&amp;=%20%5Cvert%20z%5Cvert%5E2%20+%20%5Cvert%20w%5Cvert%5E2%20+%202%5Cvert%20w%5Cvert%20%5Cvert%5Coverline%20z%5Cvert%5C%5C%0A%20%20%20%20&amp;=%20%5Cvert%20z%5Cvert%5E2%20+%20%5Cvert%20w%5Cvert%5E2%20+%202%5Cvert%20w%5Cvert%20%5Cvert%20z%5Cvert%5C%5C%0A%20%20%20%20&amp;=%20(%5Cvert%20z%20%5Cvert%20+%20%5Cvert%20w%20%5Cvert)%5E2%0A%5Cend%7Balign%7D%0A"></p>
<p>したがって，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cvert%20%20z%20+%20w%20%5Cvert%20%5Cleq%20%5Cvert%20z%20%5Cvert%20+%20%5Cvert%20w%20%5Cvert%0A"></p>
</div>
</div>
</div>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="thm-" class="custom_problem theorem">
<p><span class="theorem-title"><strong>Theorem 4</strong></span> <br></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C%5En"> の任意のベクトル <img src="https://latex.codecogs.com/png.latex?%5Cpmb%20a,%20%5Cpmb%20b"> に対し，次が成立する</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%7C%7C%5Cpmb%20a%20+%20%5Cpmb%20b%7C%7C%20%5Cleq%20%7C%7C%5Cpmb%20a%7C%7C%20+%20%7C%7C%5Cpmb%20b%7C%7C%0A"></p>
</div>
</div>
<!--::: {.callout-note collapse="true" icon=false}-->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%7C%7C%5Cpmb%20a%20+%20%5Cpmb%20b%7C%7C%5E2%0A%20%20%20%20&amp;=%20(%5Cpmb%20a%20+%20%5Cpmb%20b,%20%5Cpmb%20a%20+%20%5Cpmb%20b)%5C%5C%0A%20%20%20%20&amp;=%20%7C%7C%5Cpmb%20a%7C%7C%5E2%20+%20%7C%7C%5Cpmb%20b%7C%7C%5E2%20+%20(%5Cpmb%20a,%20%5Cpmb%20b)%20+%20(%5Cpmb%20b,%20%5Cpmb%20a)%0A%5Cend%7Balign%7D%0A"></p>
<p>ここでシュワルツの不等式より</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%7C(%5Cpmb%20a,%20%5Cpmb%20b)%7C%20&amp;%5Cleq%20%7C%7C%5Cpmb%20a%7C%7C%5C,%7C%7C%5Cpmb%20b%7C%7C%5C%5C%0A%7C(%5Cpmb%20b,%20%5Cpmb%20a)%7C%20&amp;%5Cleq%20%7C%7C%5Cpmb%20b%7C%7C%5C,%7C%7C%5Cpmb%20a%7C%7C%20=%20%7C%7C%5Cpmb%20a%7C%7C%5C,%7C%7C%5Cpmb%20b%7C%7C%0A%5Cend%7Balign%7D%0A"></p>
<p>従って，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%7C%7C%5Cpmb%20a%7C%7C%5E2%20+%20%7C%7C%5Cpmb%20b%7C%7C%5E2%20+%20(%5Cpmb%20a,%20%5Cpmb%20b)%20+%20(%5Cpmb%20b,%20%5Cpmb%20a)%0A%20%20%20%20&amp;%5Cleq%20%7C%7C%5Cpmb%20a%7C%7C%5E2%20+%20%7C%7C%5Cpmb%20b%7C%7C%5E2%20%20+%202%20%7C%7C%5Cpmb%20a%7C%7C%5C,%7C%7C%5Cpmb%20b%7C%7C%5C%5C%0A%20%20%20%20&amp;=%20(%7C%7C%5Cpmb%20a%7C%7C%20+%20%7C%7C%5Cpmb%20b%7C%7C)%5E2%0A%5Cend%7Balign%7D%0A"></p>
<p>よって，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bgather%7D%0A%7C%7C%5Cpmb%20a%20+%20%5Cpmb%20b%7C%7C%5E2%20%5Cleq%20(%7C%7C%5Cpmb%20a%7C%7C%20+%20%7C%7C%5Cpmb%20b%7C%7C)%5E2%5C%5C%0A%5CRightarrow%20%7C%7C%5Cpmb%20a%20+%20%5Cpmb%20b%7C%7C%20%5Cleq%20%7C%7C%5Cpmb%20a%7C%7C%20+%20%7C%7C%5Cpmb%20b%7C%7C%0A%5Cend%7Bgather%7D%0A"></p>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>複素数</category>
  <category>幾何</category>
  <category>線形代数</category>
  <guid>https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-03-03-triangle-inequality/</guid>
  <pubDate>Mon, 03 Mar 2025 00:00:00 GMT</pubDate>
</item>
<item>
  <title>敵の砲台の座標を探せ 1/N</title>
  <dc:creator>Ryo Nakagami</dc:creator>
  <link>https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-03-02-find-coordinates/</link>
  <description><![CDATA[ 





<section id="円の式" class="level2">
<h2 class="anchored" data-anchor-id="円の式">円の式</h2>
<p><img src="https://latex.codecogs.com/png.latex?(a,%20b)"> を中心点とする半径 <img src="https://latex.codecogs.com/png.latex?r"> の円をplotすることを考えます．</p>
<p>半径 <img src="https://latex.codecogs.com/png.latex?r"> の円の中心点の座標が原点 <img src="https://latex.codecogs.com/png.latex?(0,%200)"> にある場合，円周上の点 <img src="https://latex.codecogs.com/png.latex?P%20=%20(x,%20y)"> は，<img src="https://latex.codecogs.com/png.latex?P"> から <img src="https://latex.codecogs.com/png.latex?x"> 軸に下ろした垂線と <img src="https://latex.codecogs.com/png.latex?x"> 軸が交わる点を <img src="https://latex.codecogs.com/png.latex?Q"> としたとき <img src="https://latex.codecogs.com/png.latex?%5Ctriangle%20OPQ"> は斜辺 <img src="https://latex.codecogs.com/png.latex?r">，高さ <img src="https://latex.codecogs.com/png.latex?y">, 底辺の長さ <img src="https://latex.codecogs.com/png.latex?x"> となる直角三角形を構成するので，三平方の定理より</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ar%5E2%20=%20x%5E2%20+%20y%5E2%0A"></p>
<p>これが円上の座標が満たす方程式となります．原点を中心点とする場合を考えましたが，中心が <img src="https://latex.codecogs.com/png.latex?(a,%20b)">，半径 <img src="https://latex.codecogs.com/png.latex?r"> の円の式は同様の方法で</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ar%5E2%20=%20(x%20-%20a)%5E2%20+%20(y%20-%20b)%5E2%20%5Clabel%7B#eq-circle%7D%0A"></p>
<p>と表すことが出来ます．</p>
<div id="27af7924" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.tri <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> mtri</span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set params</span></span>
<span id="cb1-6">R <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-7">O <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-8"></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># variables</span></span>
<span id="cb1-10">theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.pi, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>)</span>
<span id="cb1-11">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.cos(theta) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> R <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> O[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb1-12">y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.sin(theta) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> R <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> O[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb1-13"></span>
<span id="cb1-14">A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>], y[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>])</span>
<span id="cb1-15">triangles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]]</span>
<span id="cb1-16">x_trinagle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [O[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]]</span>
<span id="cb1-17">y_trinagle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [O[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], O[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]</span>
<span id="cb1-18">triang <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mtri.Triangulation(x_trinagle, y_trinagle, triangles)</span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot</span></span>
<span id="cb1-21">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb1-22">ax.grid()</span>
<span id="cb1-23">ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"equal"</span>)</span>
<span id="cb1-24">ax.set_xlim(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>)</span>
<span id="cb1-25">ax.set_ylim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>)</span>
<span id="cb1-26"></span>
<span id="cb1-27"></span>
<span id="cb1-28">ax.plot(x, y)</span>
<span id="cb1-29">ax.scatter(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>O, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"k"</span>)</span>
<span id="cb1-30">ax.scatter(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>A, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"k"</span>)</span>
<span id="cb1-31">ax.text(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>O, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"O"</span>,  ha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>, va<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bottom'</span>)</span>
<span id="cb1-32">ax.text(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>A, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A = ($x_1, y_1$)"</span>, ha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'left'</span>, va<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bottom'</span>)</span>
<span id="cb1-33">ax.text(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.35</span>, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"r"</span>)</span>
<span id="cb1-34">ax.text(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$x_1 - 2$"</span>, ha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>, va<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bottom'</span>)</span>
<span id="cb1-35">ax.text(A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.35</span>, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$y_1 - 1$"</span>, ha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'left'</span>, va<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bottom'</span>)</span>
<span id="cb1-36"></span>
<span id="cb1-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add lines</span></span>
<span id="cb1-38">ax.triplot(triang, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ko-'</span>)</span>
<span id="cb1-39"></span>
<span id="cb1-40"></span>
<span id="cb1-41">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-03-02-find-coordinates/index_files/figure-html/cell-2-output-1.png" width="515" height="490" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="点を通る円の方程式" class="level3">
<h3 class="anchored" data-anchor-id="点を通る円の方程式">３点を通る円の方程式</h3>
<div id="02c03fb2" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set params</span></span>
<span id="cb2-2">R <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span></span>
<span id="cb2-3">O <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># variables</span></span>
<span id="cb2-6">theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.pi, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>)</span>
<span id="cb2-7">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.cos(theta) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> R <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> O[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb2-8">y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.sin(theta) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> R <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> O[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb2-9"></span>
<span id="cb2-10">P <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-11">Q <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb2-12">R <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb2-13"></span>
<span id="cb2-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot</span></span>
<span id="cb2-15">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb2-16">ax.grid()</span>
<span id="cb2-17">ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"equal"</span>)</span>
<span id="cb2-18"></span>
<span id="cb2-19">ax.plot(x, y)</span>
<span id="cb2-20">ax.scatter(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>O, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"k"</span>)</span>
<span id="cb2-21">ax.scatter(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>P, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"k"</span>)</span>
<span id="cb2-22">ax.scatter(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>Q, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"k"</span>)</span>
<span id="cb2-23">ax.scatter(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>R, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"k"</span>)</span>
<span id="cb2-24">ax.text(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>O, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"O"</span>,  ha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>, va<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bottom'</span>)</span>
<span id="cb2-25">ax.text(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>P, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P"</span>,  ha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>, va<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bottom'</span>)</span>
<span id="cb2-26">ax.text(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>Q, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Q"</span>, ha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'left'</span>, va<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bottom'</span>)</span>
<span id="cb2-27">ax.text(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>R, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, ha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'left'</span>, va<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bottom'</span>)</span>
<span id="cb2-28"></span>
<span id="cb2-29"></span>
<span id="cb2-30">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-03-02-find-coordinates/index_files/figure-html/cell-3-output-1.png" width="492" height="485" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>３点 <img src="https://latex.codecogs.com/png.latex?P%20=%20(1,%20-1),%20Q%20=%20(3,%203),%20R%20=%20(1,%202)"> が与えられたとして，この３点を通る円を求める問題を考えます．</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ceqref%7B#eq-circle%7D"> を展開すると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ax%5E2%20+%20y%5E2%20-%202ax%20-%202by%20+%20a%5E2%20+%20b%5E2%20=%20r%5E2%0A"></p>
<p>これを整理して</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ax%5E2%20+%20y%5E2%20+%20Ax%20+%20By%20+%20C%20=%200%20%5Clabel%7B#eq-basemodel%7D%0A"></p>
<p>と変形します．ここで，<img src="https://latex.codecogs.com/png.latex?P%20=%20(1,%20-1),%20Q%20=%20(3,%203),%20R%20=%20(1,%202)"> の情報を用いると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bgather%7D%0A2%20+%20A%20-%20B%20+%20C%20=%200%5C%5C%0A18%20+%203A%20+%203B%20+%20C%20=%200%5C%5C%0A5%20+%20A%20+2B%20+%20C%20=%200%0A%5Cend%7Bgather%7D%0A"></p>
<p>という <img src="https://latex.codecogs.com/png.latex?A,B,C"> についての連立方程式を得ることが出来ます．これを解くと</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%20=%20-6,%20B%20=%20-1,%20C%20=%203%0A"></p>
<p>従って，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(x%20-%203)%5E2%20+%20(y%20-%200.5)%5E2%20=%202.5%5E2%20%5Clabel%7B#eq-ans1%7D%0A"></p>
<section id="外接円から求める" class="level4">
<h4 class="anchored" data-anchor-id="外接円から求める">外接円から求める</h4>
<p>点 <img src="https://latex.codecogs.com/png.latex?P,%20Q,%20R"> からなる三角形の外接円として求めたい円を捉えることも出来ます． 外接円の円心は三角形の各線分の垂直二等分線の交点として求めることが出来ます．</p>
<div id="415c58ba" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> func_pq(x):</span>
<span id="cb3-2">    a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb3-3">    b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb3-4"></span>
<span id="cb3-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b</span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> func_pr(x):</span>
<span id="cb3-8">    a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> R[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> R[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb3-9">    b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> R[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> R[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb3-10"></span>
<span id="cb3-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b</span>
<span id="cb3-12"></span>
<span id="cb3-13">x_lin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>])</span>
<span id="cb3-14">triangles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]]</span>
<span id="cb3-15">x_trinagle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], R[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]]</span>
<span id="cb3-16">y_trinagle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], R[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]</span>
<span id="cb3-17">triang <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mtri.Triangulation(x_trinagle, y_trinagle, triangles)</span>
<span id="cb3-18"></span>
<span id="cb3-19"></span>
<span id="cb3-20"></span>
<span id="cb3-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot</span></span>
<span id="cb3-22">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb3-23">ax.grid()</span>
<span id="cb3-24">ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"equal"</span>)</span>
<span id="cb3-25">ax.set_xlim(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span>
<span id="cb3-26">ax.set_ylim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>)</span>
<span id="cb3-27">ax.plot(x_lin, func_pq(x_lin), label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PQ Perpendicular bisector'</span>, linestyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gray'</span>)</span>
<span id="cb3-28">ax.plot(x_lin, func_pr(x_lin), label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PR Perpendicular bisector'</span>, linestyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">':'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gray'</span>)</span>
<span id="cb3-29"></span>
<span id="cb3-30"></span>
<span id="cb3-31">ax.plot(x, y)</span>
<span id="cb3-32">ax.scatter(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>O, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"k"</span>)</span>
<span id="cb3-33">ax.scatter(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>P, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"k"</span>)</span>
<span id="cb3-34">ax.scatter(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>Q, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"k"</span>)</span>
<span id="cb3-35">ax.scatter(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>R, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"k"</span>)</span>
<span id="cb3-36">ax.text(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>O, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"O"</span>,  ha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>, va<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bottom'</span>)</span>
<span id="cb3-37">ax.text(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>P, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P"</span>,  ha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>, va<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bottom'</span>)</span>
<span id="cb3-38">ax.text(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>Q, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Q"</span>, ha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'left'</span>, va<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bottom'</span>)</span>
<span id="cb3-39">ax.text(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>R, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>, ha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'left'</span>, va<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bottom'</span>)</span>
<span id="cb3-40"></span>
<span id="cb3-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add lines</span></span>
<span id="cb3-42">ax.triplot(triang, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ko-'</span>)</span>
<span id="cb3-43"></span>
<span id="cb3-44">plt.legend(loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center left'</span>, bbox_to_anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>))</span>
<span id="cb3-45">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-03-02-find-coordinates/index_files/figure-html/cell-4-output-1.png" width="718" height="485" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><img src="https://latex.codecogs.com/png.latex?PQ"> の垂直二等分線 <img src="https://latex.codecogs.com/png.latex?f(x)"> は</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0Af(x)%0A%20%20%20%20&amp;=%20-%5Cfrac%7BP_x%20-%20Q_x%7D%7BP_y%20-%20Q_y%7Dx%20+%20%5Cfrac%7BP_y%20+%20Q_y%7D%7B2%7D%20+%20%5Cfrac%7BP_x%20-%20Q_x%7D%7BP_y%20-%20Q_y%7D%20%5Cfrac%7BP_x%20+%20Q_y%7D%7B2%7D%5C%5C%0A%20%20%20%20&amp;=%20-%5Cfrac%7BP_x%20-%20Q_x%7D%7BP_y%20-%20Q_y%7Dx%20+%20%5Cfrac%7BP_x%5E2%20-%20Q_x%5E2%20+%20P_y%5E2%20-%20Q_y%5E2%7D%7B2(P_y%20-%20Q_y)%7D%0A%5Cend%7Balign%7D%0A"></p>
<p>同様に <img src="https://latex.codecogs.com/png.latex?PR"> の垂直二等分線 <img src="https://latex.codecogs.com/png.latex?g(x)"> は</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0Ag(x)%0A%20%20%20%20&amp;=%20-%5Cfrac%7BP_x%20-%20R_x%7D%7BP_y%20-%20R_y%7Dx%20+%20%5Cfrac%7BP_y%20+%20R_y%7D%7B2%7D%20+%20%5Cfrac%7BP_x%20-%20R_x%7D%7BP_y%20-%20R_y%7D%20%5Cfrac%7BP_x%20+%20R_y%7D%7B2%7D%5C%5C%0A%20%20%20%20&amp;=%20-%5Cfrac%7BP_x%20-%20R_x%7D%7BP_y%20-%20R_y%7Dx%20+%20%5Cfrac%7BP_x%5E2%20-%20R_x%5E2%20+%20P_y%5E2%20-%20R_y%5E2%7D%7B2(P_y%20-%20R_y)%7D%0A%5Cend%7Balign%7D%0A"></p>
<p>ここから <img src="https://latex.codecogs.com/png.latex?f(x),%20g(x)"> が交差する点を求めることで外接円の円心を求めることが出来ます．</p>
<p>少しめんどくさいので，数値計算で説いてみると</p>
<div id="842d2e9a" class="cell" data-execution_count="4">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb4-2">b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb4-3">c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> R[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> R[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb4-4">d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> R[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> R[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb4-5"></span>
<span id="cb4-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>((d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>b)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>c), a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>b)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>c) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>3.0 0.5</code></pre>
</div>
</div>
<p><img src="https://latex.codecogs.com/png.latex?%5Ceqref%7B#eq-ans1%7D"> と一致する計算結果となることが確かめられました．</p>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<p><strong>📘 REMARKS</strong> <br></p>
<p>上記の垂直二等分線の交点を <img src="https://latex.codecogs.com/png.latex?(x_0,%20y_0)"> としたとき，整理すると以下のようになります．</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%20=%20%5Cleft(%5Cbegin%7Barray%7D%7Bcc%7D%0AR_y%20-%20Q_y%20&amp;%20-(P_y%20-%20Q_y)%5C%5C%0A-(R_x%20-%20Q_x)%20&amp;%20P_x%20-%20Q_x%5C%5C%0A%5Cend%7Barray%7D%5Cright)%0A"></p>
<p>としたとき，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cleft(%5Cbegin%7Barray%7D%7Bc%7D%0Ax_0%5C%5C%0Ay_0%0A%5Cend%7Barray%7D%5Cright)%0A%20%20%20%20=%20%5Cfrac%7B1%7D%7B%5Coperatorname%7Bdet%7DA%7D%20A%5Cleft(%5Cbegin%7Barray%7D%7Bc%7D%0A(P_x%5E2%20-%20Q_x%5E2%20+%20P_y%5E2%20-%20Q_y%5E2)/2%5C%5C%0A(R_x%5E2%20-%20Q_x%5E2%20+%20R_y%5E2%20-%20Q_y%5E2)/2%0A%5Cend%7Barray%7D%5Cright)%0A"></p>
<p>実際に計算してみると</p>
<div id="fb672541" class="cell" data-execution_count="5">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">A_array <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([[R[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>(P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])], [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>(R[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]), P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]]])</span>
<span id="cb6-2">B_array <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(</span>
<span id="cb6-3">    [</span>
<span id="cb6-4">        [(P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb6-5">        [(R[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> R[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb6-6">    ]</span>
<span id="cb6-7">)</span>
<span id="cb6-8"></span>
<span id="cb6-9">result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.ravel((A_array <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span> B_array) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> np.linalg.det(A_array))</span>
<span id="cb6-10">radius <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.sqrt(np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>((np.array(P) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> result) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb6-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"中心点 = (</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>result<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">), 半径 = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>radius<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>中心点 = ([3.  0.5]), 半径 = 2.5</code></pre>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="敵の砲台の座標を探せ" class="level2">
<h2 class="anchored" data-anchor-id="敵の砲台の座標を探せ">敵の砲台の座標を探せ</h2>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="exr-" class="custom_problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1</strong></span> <br></p>
<p>とある固定の１地点から自軍領地に対して敵が砲撃をかけてきているとします. 敵の砲台は角度のみを調整できるだけで，砲撃予定距離 <img src="https://latex.codecogs.com/png.latex?r"> は一定とします．ただし，実際の砲撃距離は風向などの外乱要因によってノイズが混じっているとします．</p>
<p>とある日に敵から50回の攻撃を受けたとき，その砲台座標を推定してください．砲撃のノイズは<img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7Bi.i.d%7D">とする．</p>
</div>
</div>
<p><img src="https://latex.codecogs.com/png.latex?%5Ceqref%7B#eq-basemodel%7D"> より</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0Az_i%20=%20-%20x_i%5E2%20-%20y_i%5E2%0A%5Cend%7Balign%7D%0A"></p>
<p>と定義すると，<img src="https://latex.codecogs.com/png.latex?e_i"> をresidualとして</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Az_i%20=%20%5Cbeta_0%20+%20%5Cbeta_1%20x_i%20+%20%5Cbeta_2%20y_i%20+%20e_i%0A"></p>
<p>について <img src="https://latex.codecogs.com/png.latex?(%5Cbeta_0,%20%5Cbeta_1,%20%5Cbeta_2)"> をLinear modelで推定し，その推定値を <img src="https://latex.codecogs.com/png.latex?(%5Chat%5Cbeta_0,%20%5Chat%5Cbeta_1,%20%5Chat%5Cbeta_2)"> と表せば 敵の砲台の推定座標 <img src="https://latex.codecogs.com/png.latex?(%5Chat%20x,%20%5Chat%20y)"> 及び推定距離 <img src="https://latex.codecogs.com/png.latex?%5Chat%20r"> は</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Chat%20x%20&amp;=%20-%5Chat%5Cbeta_1/2%5C%5C%0A%5Chat%20y%20&amp;=%20-%5Chat%5Cbeta_2/2%5C%5C%0A%5Chat%20r%20&amp;=%20%5Csqrt%7B%5Chat%20x%5E2%20+%20%5Chat%20y%5E2%20-%20%5Chat%5Cbeta_0%7D%0A%5Cend%7Balign%7D%0A"></p>
<p>と計算できそうに思えます．</p>
<p><strong> ▶&nbsp; Data Generating Process</strong></p>
<ul>
<li>敵の砲台の座標は <img src="https://latex.codecogs.com/png.latex?(0,%200)"></li>
<li>敵は <img src="https://latex.codecogs.com/png.latex?(0,%200)"> の地点から砲撃距離 <img src="https://latex.codecogs.com/png.latex?20"> で攻撃してくる</li>
<li>実際の砲撃距離 <img src="https://latex.codecogs.com/png.latex?r%20%5Csim%20N(20,%201)"></li>
<li>砲撃角度は <img src="https://latex.codecogs.com/png.latex?%5Cleft%5B%5Cdisplaystyle%7B%5Cfrac%7B%5Cpi%7D%7B3%7D,%20%5Cfrac%7B%5Cpi%7D%7B2%7D%7D%5Cright%5D"> の範囲で一様分布で定まる</li>
</ul>
<p>というData Generating Processとします．</p>
<div id="b073eeae" class="cell" data-execution_count="6">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> gdp(x_0: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>, y_0: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>, noise: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, radius: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,  attack_num: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>):</span>
<span id="cb8-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># params</span></span>
<span id="cb8-3">    theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.uniform(np.pi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> , np.pi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> , attack_num)</span>
<span id="cb8-4">    r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> radius <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> np.random.normal(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, noise, attack_num)</span>
<span id="cb8-5"></span>
<span id="cb8-6">    x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.cos(theta) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x_0</span>
<span id="cb8-7">    y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.sin(theta) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y_0</span>
<span id="cb8-8"></span>
<span id="cb8-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> x, y</span></code></pre></div>
</details>
</div>
<p>このGDPに従う形で攻撃されたとするとき，その散布図は以下のようになります．</p>
<div id="bff2800a" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">np.random.seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb9-2"></span>
<span id="cb9-3">x_attack, y_attack <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gdp(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb9-4"></span>
<span id="cb9-5">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots()</span>
<span id="cb9-6">ax.scatter(x_attack, y_attack)</span>
<span id="cb9-7">ax.set_xlim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>([np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(x_attack), np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(y_attack)]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb9-8">ax.set_ylim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>([np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(x_attack), np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(y_attack)]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb9-9">ax.grid()</span>
<span id="cb9-10">ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>)</span>
<span id="cb9-11">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-03-02-find-coordinates/index_files/figure-html/cell-8-output-1.png" width="415" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><strong> ▶&nbsp; OLS Monte Carlo Simulation</strong></p>
<p>OLSによるパラメータ推定値を <img src="https://latex.codecogs.com/png.latex?1,000"> 回simulationし，その組み合わせをkde plotしたものが以下となります．x座標についてバイアスがあることがわかります． 砲撃距離に関しても不自然な推定値となっています．</p>
<div id="f48f3156" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb10-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> statsmodels.api <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> sm</span>
<span id="cb10-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> seaborn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> sns</span>
<span id="cb10-4"></span>
<span id="cb10-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> gpd_dataframe(x: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, y: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, noise: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>):</span>
<span id="cb10-6">    x_attack, y_attack <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gdp(x, y, noise)</span>
<span id="cb10-7">    df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(</span>
<span id="cb10-8">        {</span>
<span id="cb10-9">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x_coordinate"</span>: x_attack,</span>
<span id="cb10-10">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y_coordinate"</span>: y_attack,</span>
<span id="cb10-11">        }</span>
<span id="cb10-12">    )</span>
<span id="cb10-13"></span>
<span id="cb10-14">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> df</span>
<span id="cb10-15"></span>
<span id="cb10-16"></span>
<span id="cb10-17"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> ols_solver(</span>
<span id="cb10-18">    df: pd.DataFrame, xy_columns: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">tuple</span>[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x_coordinate"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y_coordinate"</span>)</span>
<span id="cb10-19">):</span>
<span id="cb10-20">    Y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>(df[xy_columns[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> df[xy_columns[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]</span>
<span id="cb10-21">    X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sm.add_constant(df.loc[:, xy_columns])</span>
<span id="cb10-22"></span>
<span id="cb10-23">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># regression</span></span>
<span id="cb10-24">    model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sm.OLS(Y, X)</span>
<span id="cb10-25">    results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model.fit()</span>
<span id="cb10-26"></span>
<span id="cb10-27">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># convert estimates to target params</span></span>
<span id="cb10-28">    x_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>results.params[xy_columns[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb10-29">    y_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>results.params[xy_columns[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb10-30">    r_hat_sqr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (x_hat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y_hat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> results.params[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'const'</span>])</span>
<span id="cb10-31">    r_hat <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.sqrt(r_hat_sqr) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> r_hat_sqr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> np.nan</span>
<span id="cb10-32"></span>
<span id="cb10-33">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> [x_hat, y_hat, r_hat]</span>
<span id="cb10-34"></span>
<span id="cb10-35"></span>
<span id="cb10-36"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> estimator_simulator(func, noise: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span>: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>):</span>
<span id="cb10-37">    res <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">map</span>(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> x: func(gpd_dataframe(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, noise)), <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span>)))</span>
<span id="cb10-38">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> np.array(res)</span>
<span id="cb10-39"></span>
<span id="cb10-40">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb10-41"></span>
<span id="cb10-42">ols_res <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> estimator_simulator(ols_solver)</span>
<span id="cb10-43">sns.kdeplot(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ols_res[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ols_res[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], cmap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Blues"</span>, fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, ax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb10-44">sns.kdeplot(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ols_res[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], cmap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Blues"</span>, fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, ax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb10-45"></span>
<span id="cb10-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Show the plot</span></span>
<span id="cb10-47">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimated x coordinate"</span>)</span>
<span id="cb10-48">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimated y coordinate"</span>)</span>
<span id="cb10-49">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>)</span>
<span id="cb10-50">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OLS 2D Density Plot</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">with 1000 iterations"</span>)</span>
<span id="cb10-51">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Raidus Density Plot</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">with 1000 iterations"</span>)</span>
<span id="cb10-52">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-03-02-find-coordinates/index_files/figure-html/cell-9-output-1.png" width="600" height="467" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>そもそも <img src="https://latex.codecogs.com/png.latex?r_i%20=%2020%20+%20%5Cepsilon_i"> と決定されていますが</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbeta_0%20=%20a%5E2%20+%20b%5E2%20-%20(r%20+%20%5Cepsilon_i)%5E2%0A"></p>
<p>で決定されており，これを踏まえて OLSのモデルを見てみると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Az_i%20=%20%5Cleft(a%5E2%20+%20b%5E2%20-%20r%5E2%20-%20%5Cepsilon_i%5E2%20-%202r%5Cepsilon%20%5Cright)%20-%202ax_i%20-%202by_i%0A"></p>
<p>となるので，そもそもunbiasedな推定量になっていないと判断できます</p>
<p><strong> ▶&nbsp; Regression with MLE</strong></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ceqref%7B#eq-circle%7D"> に則り，もっと直接的に</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AL(%5Cbeta)%20=%20(%5Csqrt%7B(x_i%20-%20%5Cbeta_1)%5E2%20+%20(y_i%20-%20%5Cbeta_2)%5E2%7D%20-%20%5Cbeta_0)%5E2%0A"></p>
<p>を最小する形でパラメーターを推定してみます．このとき．residualが<img src="https://latex.codecogs.com/png.latex?N(0,%20%5Csigma)"> に従うならばLikelihoodは</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(X_i%5Cvert%20%5Cbeta,%20%5Csigma)%20=%20%5Cfrac%7B1%7D%7B%5Csqrt%7B2%5Cpi%7D%5Csigma%7D%5Cexp%5Cleft(-%5Cfrac%7BL(%5Cbeta)%7D%7B2%5Csigma%5E2%7D%5Cright)%0A"></p>
<p>と表せるので，これを用いて解いてみます．</p>
<div id="02b92397" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb11-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> scipy.optimize <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> minimize</span>
<span id="cb11-3"></span>
<span id="cb11-4"></span>
<span id="cb11-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> lik(parameters, x, y):</span>
<span id="cb11-6">    x_0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> parameters[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb11-7">    y_0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> parameters[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb11-8">    r_0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> parameters[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb11-9">    sigma <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> parameters[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]</span>
<span id="cb11-10">    g_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (np.sqrt((np.sqrt((x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x_0) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y_0) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> r_0)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb11-11"></span>
<span id="cb11-12">    L <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(x) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.log(sigma<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> sigma<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(g_x)</span>
<span id="cb11-13">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> L</span>
<span id="cb11-14"></span>
<span id="cb11-15"></span>
<span id="cb11-16"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> mle_solver(</span>
<span id="cb11-17">    df: pd.DataFrame, xy_columns: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">tuple</span>[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x_coordinate"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y_coordinate"</span>)</span>
<span id="cb11-18">):</span>
<span id="cb11-19"></span>
<span id="cb11-20">    x_attack <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df[xy_columns[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]].values</span>
<span id="cb11-21">    y_attack <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df[xy_columns[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]].values</span>
<span id="cb11-22">    lik_model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> minimize(</span>
<span id="cb11-23">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> params: lik(params, x_attack, y_attack),</span>
<span id="cb11-24">        np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb11-25">        method<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L-BFGS-B"</span>,</span>
<span id="cb11-26">    )</span>
<span id="cb11-27">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> lik_model[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>]</span>
<span id="cb11-28"></span>
<span id="cb11-29"></span>
<span id="cb11-30">mle_res <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> estimator_simulator(mle_solver)</span>
<span id="cb11-31"></span>
<span id="cb11-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot</span></span>
<span id="cb11-33">fig, axes<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb11-34"></span>
<span id="cb11-35">sns.kdeplot(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>mle_res[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>mle_res[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], cmap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Blues"</span>, fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, ax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>axes[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb11-36">sns.kdeplot(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>mle_res[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], cmap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Blues"</span>, fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, ax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>axes[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb11-37"></span>
<span id="cb11-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Show the plot</span></span>
<span id="cb11-39">axes[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimated x coordinate"</span>)</span>
<span id="cb11-40">axes[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimated y coordinate"</span>)</span>
<span id="cb11-41">axes[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MLE 2D Density Plot</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">with 1000 iterations"</span>)</span>
<span id="cb11-42">axes[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"equal"</span>)</span>
<span id="cb11-43">axes[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Raidus Density Plot</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">with 1000 iterations"</span>)</span>
<span id="cb11-44"></span>
<span id="cb11-45">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-03-02-find-coordinates/index_files/figure-html/cell-10-output-1.png" width="553" height="467" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>定式化は正しいはずですが，<img src="https://latex.codecogs.com/png.latex?(x_0,%20y_0,%20r_0)"> は効率的な推定量となっていない疑いがあることが読み取れます．</p>
<p>次に，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AL(%5Cbeta)%20=%20%5Csqrt%7B(x_i%20-%20%5Cbeta_1)%5E2%20+%20(y_i%20-%20%5Cbeta_2)%5E2%20-%20%5Cbeta_0%5E2%7D%20%5Clabel%7B#eq-mle%7D%0A"></p>
<p>をLoss functionとして推定してみます．</p>
<div id="a82b273e" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb12-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> scipy.optimize <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> minimize</span>
<span id="cb12-3"></span>
<span id="cb12-4"></span>
<span id="cb12-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> lik(parameters, x, y):</span>
<span id="cb12-6">    x_0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> parameters[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb12-7">    y_0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> parameters[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb12-8">    r_0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> parameters[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb12-9">    sigma <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> parameters[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]</span>
<span id="cb12-10">    g_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x_0) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y_0) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> r_0<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb12-11"></span>
<span id="cb12-12">    L <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(x) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.log(sigma<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> sigma<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(g_x)</span>
<span id="cb12-13">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> L</span>
<span id="cb12-14"></span>
<span id="cb12-15"></span>
<span id="cb12-16"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> mle_solver(</span>
<span id="cb12-17">    df: pd.DataFrame, xy_columns: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">tuple</span>[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x_coordinate"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y_coordinate"</span>)</span>
<span id="cb12-18">):</span>
<span id="cb12-19"></span>
<span id="cb12-20">    x_attack <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df[xy_columns[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]].values</span>
<span id="cb12-21">    y_attack <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df[xy_columns[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]].values</span>
<span id="cb12-22">    lik_model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> minimize(</span>
<span id="cb12-23">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> params: lik(params, x_attack, y_attack),</span>
<span id="cb12-24">        np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb12-25">        method<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L-BFGS-B"</span>,</span>
<span id="cb12-26">    )</span>
<span id="cb12-27">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> lik_model[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>]</span>
<span id="cb12-28"></span>
<span id="cb12-29"></span>
<span id="cb12-30">mle_res <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> estimator_simulator(mle_solver)</span>
<span id="cb12-31"></span>
<span id="cb12-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot</span></span>
<span id="cb12-33">fig, axes<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb12-34"></span>
<span id="cb12-35">sns.kdeplot(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>mle_res[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>mle_res[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], cmap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Blues"</span>, fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, ax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>axes[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb12-36">sns.kdeplot(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>mle_res[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], cmap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Blues"</span>, fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, ax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>axes[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb12-37"></span>
<span id="cb12-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Show the plot</span></span>
<span id="cb12-39">axes[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimated x coordinate"</span>)</span>
<span id="cb12-40">axes[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimated y coordinate"</span>)</span>
<span id="cb12-41">axes[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MLE 2D Density Plot</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">with 1000 iterations"</span>)</span>
<span id="cb12-42">axes[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"equal"</span>)</span>
<span id="cb12-43">axes[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Raidus Density Plot</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">with 1000 iterations"</span>)</span>
<span id="cb12-44"></span>
<span id="cb12-45">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-03-02-find-coordinates/index_files/figure-html/cell-11-output-1.png" width="540" height="467" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>先程よりは精度良く推定できているように見えますが，<img src="https://latex.codecogs.com/png.latex?%5Ceqref%7B#eq-mle%7D"> は</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AL(%5Cbeta)%20=%20%5Csqrt%7B%5Cepsilon_i%5E2%20+%202%5Cbeta_0%20%5Cepsilon_i%7D%0A"></p>
<p>となるので，そもそもMLEの定式化が間違っていることがわかります．また，<img src="https://latex.codecogs.com/png.latex?%5Cbeta_0"> が大きいほどresidualが大きくなる傾向があることから，unbiasedな推定量は得られていないことがわかります．</p>
<p><strong> ▶&nbsp; Regression with stan</strong></p>
<p>cmdstanを用いて砲台座標を推定する例を紹介します．まずstan modelを以下のように設定します．</p>
<ul>
<li>砲撃距離のノイズについて <img src="https://latex.codecogs.com/png.latex?N(0,%201)"> であることが既にわかっている状況を想定</li>
<li>予定砲撃距離 <img src="https://latex.codecogs.com/png.latex?r_0"> は <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BUniform%7D(2,%2030)"> の事前分布がある</li>
</ul>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode stan code-with-copy"><code class="sourceCode stan"><span id="cb13-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">data</span> {</span>
<span id="cb13-2">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span>&lt;<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lower</span>=<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>&gt; N;  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Number of data points</span></span>
<span id="cb13-3">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">array</span>[N] <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">real</span> y; <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// outcomes</span></span>
<span id="cb13-4">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">array</span>[N] <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">real</span> x; <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// outcomes</span></span>
<span id="cb13-5">}</span>
<span id="cb13-6"></span>
<span id="cb13-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">parameters</span> {</span>
<span id="cb13-8">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">real</span>&lt;<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lower</span>=<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>&gt; r_0; <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// probability of success</span></span>
<span id="cb13-9">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">real</span> x_0;             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Center x-coordinate</span></span>
<span id="cb13-10">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">real</span> y_0;             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Center y-coordinate</span></span>
<span id="cb13-11">}</span>
<span id="cb13-12"></span>
<span id="cb13-13"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">model</span> {</span>
<span id="cb13-14">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// priors</span></span>
<span id="cb13-15">    r_0 ~ uniform(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>);</span>
<span id="cb13-16">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">real</span> sigma = <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>;</span>
<span id="cb13-17"></span>
<span id="cb13-18">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// objective loss</span></span>
<span id="cb13-19">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">array</span>[N] <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">real</span> circle_equation;</span>
<span id="cb13-20">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:N) {</span>
<span id="cb13-21">        circle_equation[i] = sqrt((x[i] - x_0)^<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> + (y[i] - y_0)^<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) - r_0;</span>
<span id="cb13-22">    }</span>
<span id="cb13-23"></span>
<span id="cb13-24">    circle_equation ~ normal(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, sigma);</span>
<span id="cb13-25">}</span></code></pre></div>
<p>その後，このモデルを用いて推定したものが以下となります．</p>
<div id="3944aa10" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> cmdstanpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> CmdStanModel</span>
<span id="cb14-2"></span>
<span id="cb14-3">df_stan <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gpd_dataframe(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb14-4">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb14-5">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"N"</span>: df_stan.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],</span>
<span id="cb14-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>: df_stan.y_coordinate.values,</span>
<span id="cb14-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>: df_stan.x_coordinate.values,</span>
<span id="cb14-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sigma"</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb14-9">}</span>
<span id="cb14-10"></span>
<span id="cb14-11">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> CmdStanModel(stan_file<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"./stanmodel.stan"</span>)</span>
<span id="cb14-12">fit <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model.sample(data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>data, seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb14-13">fit.summary()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>07:53:50 - cmdstanpy - INFO - compiling stan file /home/runner/work/regmonkey-datascience-blog/regmonkey-datascience-blog/posts/2025-03-02-find-coordinates/stanmodel.stan to exe file /home/runner/work/regmonkey-datascience-blog/regmonkey-datascience-blog/posts/2025-03-02-find-coordinates/stanmodel
07:53:58 - cmdstanpy - INFO - compiled model executable: /home/runner/work/regmonkey-datascience-blog/regmonkey-datascience-blog/posts/2025-03-02-find-coordinates/stanmodel
07:53:58 - cmdstanpy - INFO - CmdStan start processing</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"2e60e1c3bb394bd9a11d90d019984855","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c92c7b66777043cf8807a87d6c986ad1","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"2a0c36674f5240158f34495c6bd21531","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"fd781c10e577437e958949383e899ad8","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                                                                                                                                                                                                                                                                                </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>07:53:59 - cmdstanpy - INFO - CmdStan done processing.
07:53:59 - cmdstanpy - WARNING - Some chains may have failed to converge.
    Chain 1 had 310 divergent transitions (31.0%)
    Chain 2 had 341 divergent transitions (34.1%)
    Chain 3 had 293 divergent transitions (29.3%)
    Chain 4 had 321 divergent transitions (32.1%)
    Use the "diagnose()" method on the CmdStanMCMC object to see further information.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Mean</th>
<th data-quarto-table-cell-role="th">MCSE</th>
<th data-quarto-table-cell-role="th">StdDev</th>
<th data-quarto-table-cell-role="th">MAD</th>
<th data-quarto-table-cell-role="th">5%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">95%</th>
<th data-quarto-table-cell-role="th">ESS_bulk</th>
<th data-quarto-table-cell-role="th">ESS_tail</th>
<th data-quarto-table-cell-role="th">R_hat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">lp__</td>
<td>-22.627700</td>
<td>0.044143</td>
<td>1.21901</td>
<td>0.873029</td>
<td>-25.04740</td>
<td>-22.267300</td>
<td>-21.44630</td>
<td>886.927</td>
<td>1292.320</td>
<td>1.00150</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">r_0</td>
<td>20.167700</td>
<td>0.429917</td>
<td>6.21166</td>
<td>7.274600</td>
<td>9.15979</td>
<td>20.889900</td>
<td>29.01690</td>
<td>208.132</td>
<td>258.641</td>
<td>1.01910</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">x_0</td>
<td>0.151580</td>
<td>0.131551</td>
<td>1.88887</td>
<td>1.973310</td>
<td>-3.05708</td>
<td>0.195963</td>
<td>3.10467</td>
<td>199.726</td>
<td>234.533</td>
<td>1.02554</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">y_0</td>
<td>-0.299075</td>
<td>0.419656</td>
<td>6.11452</td>
<td>7.154340</td>
<td>-8.93022</td>
<td>-1.015920</td>
<td>10.49850</td>
<td>220.609</td>
<td>278.533</td>
<td>1.01959</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Credible intervalを見ると <img src="https://latex.codecogs.com/png.latex?(0,%200)"> は推定区間に含まれている一方，Mean, Medianともに <img src="https://latex.codecogs.com/png.latex?y_0"> の方は乖離した値が推定されてしまっています．</p>


</section>

 ]]></description>
  <category>幾何</category>
  <guid>https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-03-02-find-coordinates/</guid>
  <pubDate>Sun, 02 Mar 2025 00:00:00 GMT</pubDate>
</item>
<item>
  <title>ヘロンの公式の導出</title>
  <dc:creator>Ryo Nakagami</dc:creator>
  <link>https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-03-01-herons-formula/</link>
  <description><![CDATA[ 





<section id="辺から三角形の面積を求める" class="level2">
<h2 class="anchored" data-anchor-id="辺から三角形の面積を求める">3辺から三角形の面積を求める</h2>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="thm-" class="custom_problem theorem">
<p><span class="theorem-title"><strong>Theorem 1</strong></span> <strong>: ヘロンの公式</strong> <br></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctriangle%20ABC"> の3辺の長さがそれぞれ <img src="https://latex.codecogs.com/png.latex?a,%20b,%20c"> で与えられているとき，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0As%20=%20%5Cfrac%7B1%7D%7B2%7D(a%20+%20b%20+%20c)%0A"></p>
<p>とおくと，<img src="https://latex.codecogs.com/png.latex?%5Ctriangle%20ABC"> の面積 <img src="https://latex.codecogs.com/png.latex?S"> は</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AS%20=%20%5Csqrt%7Bs(s-a)(s-b)(s-c)%7D%0A"></p>
</div>
</div>
<!--::: {.callout-note collapse="true" icon=false}-->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
余弦定理を用いた証明
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>3辺の長さがわかっているので，余弦定理より</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0Aa%5E2%20&amp;=%20b%5E2%20+%20c%5E2%20-%202bc%5Ccos%20A%5C%5C%0A%5CRightarrow%20&amp;%5Ccos%20A%20=%20%5Cfrac%7Bb%5E2+c%5E2-a%5E2%7D%7B2bc%7D%0A%5Cend%7Balign%7D%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Csin%5E2%20A%20+%20%5Ccos%5E2%20A%20=%201"> より</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Csin%20A%20=%20%5Csqrt%7B1%20-%20%5Ccos%5E2%20A%7D%0A"></p>
<p>従って，面積 <img src="https://latex.codecogs.com/png.latex?S"> は</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AS%20=%20%5Cfrac%7B1%7D%7B2%7Dbc%5Csqrt%7B1%20-%20%5Ccos%5E2%20A%7D%0A"></p>
<p>これを展開すると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0AS%0A%20%20%20%20&amp;=%20%5Cfrac%7B1%7D%7B2%7Dbc%5Csqrt%7B1%20-%20%5Ccos%5E2%20A%7D%5C%5C%0A%20%20%20%20&amp;=%20%5Cfrac%7B1%7D%7B2%7Dbc%5Csqrt%7B1%20-%20%5Cfrac%7B(b%5E2+c%5E2-a%5E2)%5E2%7D%7B4b%5E2c%5E2%7D%7D%5C%5C%0A%20%20%20%20&amp;=%20%5Cfrac%7B1%7D%7B2%7D%5Csqrt%7Bb%5E2c%5E2%20-%20%5Cleft(%5Cfrac%7B(b%5E2+c%5E2-a%5E2)%7D%7B2%7D%5Cright)%5E2%7D%5C%5C%0A%20%20%20%20&amp;=%20%5Cfrac%7B1%7D%7B2%7D%5Csqrt%7B%5Cleft(-%5Cfrac%7Bb%5E2+c%5E2-a%5E2-2bc%7D%7B2%7D%5Cright)%5Cleft(%5Cfrac%7Bb%5E2+c%5E2-a%5E2+2bc%7D%7B2%7D%5Cright)%7D%5C%5C%0A%20%20%20%20&amp;=%20%5Cfrac%7B1%7D%7B2%7D%5Csqrt%7B%5Cleft(-%5Cfrac%7B(b-c)%5E2-a%5E2%7D%7B2%7D%5Cright)%5Cleft(%5Cfrac%7B(b+c)%5E2-a%5E2%7D%7B2%7D%5Cright)%7D%5C%5C%0A%20%20%20%20&amp;=%20%5Cfrac%7B1%7D%7B2%7D%5Csqrt%7B%5Cfrac%7B(a+b-c)(a+c-b)%7D%7B2%7D%5Cfrac%7B(a+b+c)(b+c-a)%7D%7B2%7D%7D%5C%5C%0A%20%20%20%20&amp;=%20%5Csqrt%7B%5Cfrac%7B(a+b-c)%7D%7B2%7D%5Cfrac%7B(a+c-b)%7D%7B2%7D%5Cfrac%7B(a+b+c)%7D%7B2%7D%5Cfrac%7B(b+c-a)%7D%7B2%7D%7D%5C%5C%0A%20%20%20%20&amp;=%20%5Csqrt%7Bs(s-a)(s-b)(s-c)%7D%0A%5Cend%7Balign%7D%0A"></p>
</div>
</div>
</div>
<!--::: {.callout-note collapse="true" icon=false}-->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
三角形の傍接円からのヘロンの公式
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>下記のように <img src="https://latex.codecogs.com/png.latex?%5Ctriangle%20ABC"> について内心 <img src="https://latex.codecogs.com/png.latex?D"> と傍心 <img src="https://latex.codecogs.com/png.latex?G"> を考えます．</p>
<iframe src="./herons_formula_001.html" width="100%" height="480"></iframe>
<p>前準備として <img src="https://latex.codecogs.com/png.latex?%5Ctriangle%20ABC"> のそれぞれの角の対辺を <img src="https://latex.codecogs.com/png.latex?a,%20b,%20c"> として</p>
<p><img src="https://latex.codecogs.com/png.latex?%0As%20=%20%5Cfrac%7B1%7D%7B2%7D(a%20+%20b%20+%20c)%0A"></p>
<p>と変数 <img src="https://latex.codecogs.com/png.latex?s"> を定義します．また，内接円の性質（各頂点の内角の二等分線上に内心が存在）より</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0AAH%20&amp;=%20AN%5C%5C%0ACN%20&amp;=%20CI%5C%5C%0ABH%20&amp;=%20BI%0A%5Cend%7Balign%7D%0A"></p>
<p>従って，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0AAH%20&amp;=%20s%20-%20a%5C%5C%0ABH%20&amp;=%20s%20-%20b%5C%5C%0ACN%20&amp;=%20s%20=%20c%0A%5Cend%7Balign%7D%0A"></p>
<p>傍接円の傍心 <img src="https://latex.codecogs.com/png.latex?G"> は</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?%5Cangle%20A"> の二等分線上</li>
<li><img src="https://latex.codecogs.com/png.latex?B"> と <img src="https://latex.codecogs.com/png.latex?C">の外角の二等分線上</li>
</ul>
<p>に存在することから</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AAL%20=%20AE%0A"></p>
<p>また，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0AAL%20+%20AE%0A%20%20%20%20&amp;=%20(AC%20+%20CL)%20+%20(AB%20+%20BE)%5C%5C%0A%20%20%20%20&amp;=%20(AC%20+%20CO)%20+%20(AB%20+%20BO)%5C%5C%0A%20%20%20%20&amp;=%20%20a%20+%20b%20+%20c%5C%5C%0A%20%20%20%20&amp;=%202s%0A%5Cend%7Balign%7D%0A"></p>
<p>従って，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AAL%20=%20AE%20=%20s%0A"></p>
<p>内接円の内心 <img src="https://latex.codecogs.com/png.latex?D"> が <img src="https://latex.codecogs.com/png.latex?%5Cangle%20B,%20%5Cangle%20C"> の二等分線上に存在するので</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A180%5E%5Ccirc%0A%20%20%20%20&amp;=%202%5Cangle%20HBD%20+%202%5Cangle%20EBG%5C%5C%0A%5CRightarrow%20&amp;%2090%5E%5Ccirc%20=%20%5Cangle%20HBD%20+%20%5Cangle%20EBG%0A%5Cend%7Balign%7D%0A"></p>
<p>従って，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Cangle%20BDH%20&amp;=%20%5Cangle%20EBG%0A%5Cangle%20HBD%20&amp;=%20%5Cangle%20BGE%0A%5Cend%7Balign%7D%0A"></p>
<p>ここから</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctriangle%20HBD%20%5Csim%20%5Ctriangle%20EGB%0A"></p>
<p>これより</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7Bs%20-%20b%7D%7Br_1%7D=%5Cfrac%7Br_2%7D%7Bs%20-%20c%7D%0A"></p>
<p>これを整理すると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ar_1r_2%20=%20(s-b)(s-c)%20%5Clabel%7B#eq-1%7D%0A"></p>
<p>また，<img src="https://latex.codecogs.com/png.latex?%5Ctriangle%20HDE"> と <img src="https://latex.codecogs.com/png.latex?%5Ctriangle%20HDO"> の面積が等しいことから</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Asr_1%20=%20(s-a)r_2%20%20%5Clabel%7B#eq-2%7D%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ceqref%7B#eq-1%7D">, <img src="https://latex.codecogs.com/png.latex?%5Ceqref%7B#eq-2%7D"> を 掛け合わせて <img src="https://latex.codecogs.com/png.latex?r_2"> を両辺から除して <img src="https://latex.codecogs.com/png.latex?s"> を両辺にかけると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0As%5E2r_1%5E2%20=%20s(s-a)(s-b)(s-c)%0A"></p>
<p>従って</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Asr_1%20=%20%5Csqrt%7Bs(s-a)(s-b)(s-c)%7D%0A"></p>
<p>LHSは <img src="https://latex.codecogs.com/png.latex?%5Ctriangle%20ABC"> の面積と一致するので，これでヘロンの公式が示された．</p>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>幾何</category>
  <guid>https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-03-01-herons-formula/</guid>
  <pubDate>Sat, 01 Mar 2025 00:00:00 GMT</pubDate>
</item>
<item>
  <title>カバリエリの原理</title>
  <dc:creator>Ryo Nakagami</dc:creator>
  <link>https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-02-28-cavalieri-principle/</link>
  <description><![CDATA[ 





<section id="カバリエリの原理" class="level2">
<h2 class="anchored" data-anchor-id="カバリエリの原理">カバリエリの原理</h2>
<p>一辺長さ <img src="https://latex.codecogs.com/png.latex?2"> の正方形を底面として高さ3の直方体と，それをちょっとずつねじる形でずらした立体を以下のように考えます． 右図において，<img src="https://latex.codecogs.com/png.latex?xy"> 平面に並行な各断面はどれも等しく一辺の長さ <img src="https://latex.codecogs.com/png.latex?2"> の正方形で，その面積は <img src="https://latex.codecogs.com/png.latex?4"> となってるとします．</p>
<p>このとき，カバリエリの原理よりどちらの立体像の体積は等しいことが言えます．</p>
<div id="80ccfab9" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> mpl_toolkits.mplot3d.art3d <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Poly3DCollection</span>
<span id="cb1-4"></span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> plot_cuboid(data, length<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, height<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, ax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>):</span>
<span id="cb1-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> ax <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb1-8">        fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.figure()</span>
<span id="cb1-9">        ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fig.add_subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">111</span>, projection<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"3d"</span>)</span>
<span id="cb1-10">    poly3d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Poly3DCollection(data, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"k"</span>)</span>
<span id="cb1-11">    ax.add_collection3d(poly3d)</span>
<span id="cb1-12"></span>
<span id="cb1-13">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set limits</span></span>
<span id="cb1-14">    max_dim <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(length, width, height)</span>
<span id="cb1-15">    ax.set_xlim([<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>max_dim, max_dim])</span>
<span id="cb1-16">    ax.set_ylim([<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>max_dim, max_dim])</span>
<span id="cb1-17">    ax.set_zlim([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1</span>])</span>
<span id="cb1-18">    ax.set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"X"</span>)</span>
<span id="cb1-19">    ax.set_ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Y"</span>)</span>
<span id="cb1-20">    ax.set_zlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Z"</span>)</span>
<span id="cb1-21"></span>
<span id="cb1-22"></span>
<span id="cb1-23"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> twisted_cuboid(</span>
<span id="cb1-24">    length<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, height<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, twist_angle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>np.pi <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, num_segments<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span></span>
<span id="cb1-25">):</span>
<span id="cb1-26">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the base (bottom) of the cuboid</span></span>
<span id="cb1-27">    base_vertices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(</span>
<span id="cb1-28">        [</span>
<span id="cb1-29">            [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>length <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],</span>
<span id="cb1-30">            [length <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],</span>
<span id="cb1-31">            [length <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],</span>
<span id="cb1-32">            [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>length <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],</span>
<span id="cb1-33">        ]</span>
<span id="cb1-34">    )</span>
<span id="cb1-35"></span>
<span id="cb1-36">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the top face with a twist</span></span>
<span id="cb1-37">    rotation_matrix <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(</span>
<span id="cb1-38">        [</span>
<span id="cb1-39">            [np.cos(twist_angle), <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>np.sin(twist_angle), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],</span>
<span id="cb1-40">            [np.sin(twist_angle), np.cos(twist_angle), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],</span>
<span id="cb1-41">            [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb1-42">        ]</span>
<span id="cb1-43">    )</span>
<span id="cb1-44">    top_vertices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> base_vertices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span> rotation_matrix.T <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, height])</span>
<span id="cb1-45"></span>
<span id="cb1-46">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Interpolate between base and top vertices</span></span>
<span id="cb1-47">    vertices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb1-48">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(num_segments <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>):</span>
<span id="cb1-49">        t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> num_segments</span>
<span id="cb1-50">        interpolated_vertices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> t) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> base_vertices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> top_vertices</span>
<span id="cb1-51">        vertices.append(interpolated_vertices)</span>
<span id="cb1-52">    vertices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.vstack(vertices)</span>
<span id="cb1-53"></span>
<span id="cb1-54">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define faces</span></span>
<span id="cb1-55">    faces <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb1-56">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(num_segments):</span>
<span id="cb1-57">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>):</span>
<span id="cb1-58">            next_j <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (j <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb1-59">            faces.append(</span>
<span id="cb1-60">                [</span>
<span id="cb1-61">                    vertices[i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> j],</span>
<span id="cb1-62">                    vertices[i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> next_j],</span>
<span id="cb1-63">                    vertices[(i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> next_j],</span>
<span id="cb1-64">                    vertices[(i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> j],</span>
<span id="cb1-65">                ]</span>
<span id="cb1-66">            )</span>
<span id="cb1-67"></span>
<span id="cb1-68">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> faces</span>
<span id="cb1-69"></span>
<span id="cb1-70"></span>
<span id="cb1-71"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> cuboid(length<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, height<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, num_segments<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, ax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>):</span>
<span id="cb1-72">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the base (bottom) of the cuboid</span></span>
<span id="cb1-73">    base_vertices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(</span>
<span id="cb1-74">        [</span>
<span id="cb1-75">            [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>length <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],</span>
<span id="cb1-76">            [length <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],</span>
<span id="cb1-77">            [length <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],</span>
<span id="cb1-78">            [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>length <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],</span>
<span id="cb1-79">        ]</span>
<span id="cb1-80">    )</span>
<span id="cb1-81"></span>
<span id="cb1-82">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the top face without a twist</span></span>
<span id="cb1-83">    top_vertices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> base_vertices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, height])</span>
<span id="cb1-84"></span>
<span id="cb1-85">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Interpolate between base and top vertices</span></span>
<span id="cb1-86">    vertices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb1-87">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(num_segments <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>):</span>
<span id="cb1-88">        t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> num_segments</span>
<span id="cb1-89">        interpolated_vertices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> t) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> base_vertices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> top_vertices</span>
<span id="cb1-90">        vertices.append(interpolated_vertices)</span>
<span id="cb1-91">    vertices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.vstack(vertices)</span>
<span id="cb1-92"></span>
<span id="cb1-93">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define faces</span></span>
<span id="cb1-94">    faces <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb1-95">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(num_segments):</span>
<span id="cb1-96">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>):</span>
<span id="cb1-97">            next_j <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (j <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb1-98">            faces.append(</span>
<span id="cb1-99">                [</span>
<span id="cb1-100">                    vertices[i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> j],</span>
<span id="cb1-101">                    vertices[i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> next_j],</span>
<span id="cb1-102">                    vertices[(i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> next_j],</span>
<span id="cb1-103">                    vertices[(i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> j],</span>
<span id="cb1-104">                ]</span>
<span id="cb1-105">            )</span>
<span id="cb1-106"></span>
<span id="cb1-107">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> faces</span>
<span id="cb1-108"></span>
<span id="cb1-109"></span>
<span id="cb1-110"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># compute points</span></span>
<span id="cb1-111">cuboid_records <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cuboid()</span>
<span id="cb1-112">twisted_cuboid_records <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> twisted_cuboid()</span>
<span id="cb1-113"></span>
<span id="cb1-114"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plots</span></span>
<span id="cb1-115">fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb1-116">ax1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fig.add_subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">121</span>, projection<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"3d"</span>)</span>
<span id="cb1-117">ax2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fig.add_subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">122</span>, projection<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"3d"</span>)</span>
<span id="cb1-118"></span>
<span id="cb1-119">plot_cuboid(cuboid_records, ax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ax1)</span>
<span id="cb1-120">plot_cuboid(twisted_cuboid_records, ax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ax2)</span>
<span id="cb1-121"></span>
<span id="cb1-122">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-02-28-cavalieri-principle/index_files/figure-html/cell-2-output-1.png" width="929" height="435" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="thm-" class="custom_problem theorem">
<p><span class="theorem-title"><strong>Theorem 1</strong></span> <strong>: カバリエリの原理</strong> <br></p>
<p>2つの立体について，平行な平面で切った切り口を比べる．互いの面積がいつも等しいならば，この２つの立体の体積は等しい．</p>
</div>
</div>
<p>半径 <img src="https://latex.codecogs.com/png.latex?r"> の円を底面とする高さ <img src="https://latex.codecogs.com/png.latex?h"> の円柱を考えます． なお <img src="https://latex.codecogs.com/png.latex?h%20=%20r"> とします．この円柱から，半径 <img src="https://latex.codecogs.com/png.latex?r"> の円を底面とする円錐を以下のように抜き取った立体を作ります（以降，穴あき円柱と呼ぶ）．</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-02-28-cavalieri-principle/cavalieri_example.png" class="img-fluid figure-img"></p>
<figcaption>カバリエリの原理</figcaption>
</figure>
</div>
<p>この穴開き円柱の体積は</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Cpi%20r%5E2%5Ctimes%20h%20-%20%5Cpi%20r%5E2%5Ctimes%20%5Cfrac%7Bh%7D%7B3%7D%0A%20%20%20%20&amp;=%20%5Cfrac%7B2%7D%7B3%7D%20%5Cpi%20r%5E2%20h%0A%5Cend%7Balign%7D%0A"></p>
<p>一方，半径 <img src="https://latex.codecogs.com/png.latex?r"> の半球の体積は</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Cfrac%7B1%7D%7B2%7D%20%5Ctimes%20%5Cfrac%7B4%7D%7B3%7D%5Cpi%20r%5E3%20=%20%5Cfrac%7B2%7D%7B3%7D%20%5Cpi%20r%5E2h%0A%5Cend%7Balign%7D%0A"></p>
<p>２つの立体の体積が一致することがわかります．これをカバリエリの原理を使って確かめてみます．</p>
<p>まず穴あき円錐について，高さ <img src="https://latex.codecogs.com/png.latex?a%20%5Cin%20%5B0,%20h%5D"> における断面積（緑色の部分）は</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ar%5E2%5Cpi%20-%20%5Cleft(%5Cfrac%7Ba%7D%7Br%7Dr%5Cright)%5E2%5Cpi%20=%20(r%5E2%20-%20a%5E2)%5Cpi%0A"></p>
<p>半球の方は，ピタゴラスの定理より高さ <img src="https://latex.codecogs.com/png.latex?a"> のときの半径が <img src="https://latex.codecogs.com/png.latex?%5Csqrt%7Br%5E2%20-%20a%5E2%7D"> と求まるので</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(%5Csqrt%7Br%5E2%20-%20a%5E2%7D)%5E2%5Cpi%20=%20(r%5E2%20-%20a%5E2)%5Cpi%0A"></p>
<p>従って，２つの立体について任意の高さ <img src="https://latex.codecogs.com/png.latex?a%20%5Cin%20%5B0,%20h%5D"> において互いの面積がいつも等しいことがわかります．</p>
<section id="ずらし変形で面積を求める" class="level3">
<h3 class="anchored" data-anchor-id="ずらし変形で面積を求める">ずらし変形で面積を求める</h3>
<p>半径 <img src="https://latex.codecogs.com/png.latex?r">, 弧の長さ <img src="https://latex.codecogs.com/png.latex?l"> の扇形の面積を求めたいとします．扇形に対し，分割交互ずらしをして以下のように長方形へ極限等積変形を実施します．</p>
<div id="6b216a53" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb2-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb2-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> matplotlib.patches <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Wedge, Polygon</span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Parameters</span></span>
<span id="cb2-6">r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># radius</span></span>
<span id="cb2-7">l <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># arc length</span></span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate the angle of the sector</span></span>
<span id="cb2-10">theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> l <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> r  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># in radians</span></span>
<span id="cb2-11">divide_num <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb2-12"></span>
<span id="cb2-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the sector</span></span>
<span id="cb2-14">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the original sector</span></span>
<span id="cb2-17">sector <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Wedge(</span>
<span id="cb2-18">    (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), r, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, np.degrees(theta), facecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightblue"</span>, edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span></span>
<span id="cb2-19">)</span>
<span id="cb2-20">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].add_patch(sector)</span>
<span id="cb2-21">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_xlim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>)</span>
<span id="cb2-22">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_ylim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, l)</span>
<span id="cb2-23">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"equal"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"box"</span>)</span>
<span id="cb2-24">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Original Sector"</span>)</span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Divide the sector into four parts</span></span>
<span id="cb2-27">angles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, theta, divide_num<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-28"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(divide_num):</span>
<span id="cb2-29">    wedge <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Wedge(</span>
<span id="cb2-30">        (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb2-31">        r,</span>
<span id="cb2-32">        np.degrees(angles[i]),</span>
<span id="cb2-33">        np.degrees(angles[i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb2-34">        facecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb2-35">        edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span id="cb2-36">    )</span>
<span id="cb2-37">    ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].add_patch(wedge)</span>
<span id="cb2-38"></span>
<span id="cb2-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Rearrange the parts into a parallelogram</span></span>
<span id="cb2-40"></span>
<span id="cb2-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the parallelogram by shifting the parts</span></span>
<span id="cb2-42"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(divide_num):</span>
<span id="cb2-43">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb2-44">        sector <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Wedge(</span>
<span id="cb2-45">            (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, np.sin(theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> divide_num) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)), r, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, np.degrees(theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> divide_num), facecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightblue"</span>, edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span></span>
<span id="cb2-46">        )</span>
<span id="cb2-47">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb2-48">        sector <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Wedge(</span>
<span id="cb2-49">            (np.cos(theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> divide_num), np.sin(theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> divide_num) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> )),</span>
<span id="cb2-50">            r,</span>
<span id="cb2-51">            np.degrees(np.pi),</span>
<span id="cb2-52">            np.degrees(theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> divide_num <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> np.pi),</span>
<span id="cb2-53">            facecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightblue"</span>,</span>
<span id="cb2-54">            edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span id="cb2-55">        )</span>
<span id="cb2-56">    ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].add_patch(sector)</span>
<span id="cb2-57">    </span>
<span id="cb2-58"></span>
<span id="cb2-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add info</span></span>
<span id="cb2-60">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].text(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.01</span>, l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Height = $l/2$"</span>, horizontalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span>)</span>
<span id="cb2-61"></span>
<span id="cb2-62">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_xlim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>)</span>
<span id="cb2-63">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_ylim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, l)</span>
<span id="cb2-64">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"equal"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"box"</span>)</span>
<span id="cb2-65">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rearranged into Parallelogram"</span>)</span>
<span id="cb2-66"></span>
<span id="cb2-67">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-02-28-cavalieri-principle/index_files/figure-html/cell-3-output-1.png" width="974" height="249" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>上の図では４分割ですが，これを細かくすると横の長さ <img src="https://latex.codecogs.com/png.latex?r">, 縦の長さ <img src="https://latex.codecogs.com/png.latex?l/2"> の長方形へ変形することができるとみなせるので</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AS%20=%20%5Cfrac%7Bl%7D%7B2%7Dr%0A"></p>
<p>と計算することが出来ます．半径 <img src="https://latex.codecogs.com/png.latex?r">, 弧の長さ <img src="https://latex.codecogs.com/png.latex?l%20=%202%5Cpi%20r"> のとき，扇形は円になりますが，その円の面積も同様に</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AS%20=%20%5Cfrac%7B2%5Cpi%20r%7D%7B2%7Dr%20=%20r%5E2%20%5Cpi%0A"></p>
<p>と計算でき，円の面積の公式と一致することがわかります</p>
<div id="0f3f94d7" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb3-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb3-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> matplotlib.patches <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Wedge, Polygon</span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Parameters</span></span>
<span id="cb3-6">r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># radius</span></span>
<span id="cb3-7">l <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>np.pi <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> r  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># arc length</span></span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate the angle of the sector</span></span>
<span id="cb3-10">theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> l <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> r  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># in radians</span></span>
<span id="cb3-11">divide_num <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb3-12"></span>
<span id="cb3-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the sector</span></span>
<span id="cb3-14">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb3-15"></span>
<span id="cb3-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the original sector</span></span>
<span id="cb3-17">sector <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Wedge(</span>
<span id="cb3-18">    (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), r, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, np.degrees(theta), facecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightblue"</span>, edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span></span>
<span id="cb3-19">)</span>
<span id="cb3-20">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].add_patch(sector)</span>
<span id="cb3-21">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_xlim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>, r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>)</span>
<span id="cb3-22">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_ylim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>, r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>)</span>
<span id="cb3-23">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"equal"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"box"</span>)</span>
<span id="cb3-24">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Original Sector"</span>)</span>
<span id="cb3-25"></span>
<span id="cb3-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Divide the sector into four parts</span></span>
<span id="cb3-27">angles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, theta, divide_num<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-28"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(divide_num):</span>
<span id="cb3-29">    wedge <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Wedge(</span>
<span id="cb3-30">        (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb3-31">        r,</span>
<span id="cb3-32">        np.degrees(angles[i]),</span>
<span id="cb3-33">        np.degrees(angles[i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb3-34">        facecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb3-35">        edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span id="cb3-36">    )</span>
<span id="cb3-37">    ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].add_patch(wedge)</span>
<span id="cb3-38"></span>
<span id="cb3-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Rearrange the parts into a parallelogram</span></span>
<span id="cb3-40"></span>
<span id="cb3-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the parallelogram by shifting the parts</span></span>
<span id="cb3-42"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(divide_num):</span>
<span id="cb3-43">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb3-44">        sector <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Wedge(</span>
<span id="cb3-45">            (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, np.sin(theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> divide_num) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> r), r, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, np.degrees(theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> divide_num), facecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightblue"</span>, edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span></span>
<span id="cb3-46">        )</span>
<span id="cb3-47">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb3-48">        sector <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Wedge(</span>
<span id="cb3-49">            (np.cos(theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> divide_num)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> r, np.sin(theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> divide_num) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> )),</span>
<span id="cb3-50">            r,</span>
<span id="cb3-51">            np.degrees(np.pi),</span>
<span id="cb3-52">            np.degrees(theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> divide_num <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> np.pi),</span>
<span id="cb3-53">            facecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightblue"</span>,</span>
<span id="cb3-54">            edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span id="cb3-55">        )</span>
<span id="cb3-56">    ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].add_patch(sector)</span>
<span id="cb3-57">    </span>
<span id="cb3-58"></span>
<span id="cb3-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add info</span></span>
<span id="cb3-60">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].text(r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Height = $r\pi$"</span>, horizontalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span>)</span>
<span id="cb3-61"></span>
<span id="cb3-62">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_xlim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>)</span>
<span id="cb3-63">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_ylim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.05</span>)</span>
<span id="cb3-64">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"equal"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"box"</span>)</span>
<span id="cb3-65">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rearranged into Parallelogram"</span>)</span>
<span id="cb3-66"></span>
<span id="cb3-67">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-02-28-cavalieri-principle/index_files/figure-html/cell-4-output-1.png" width="883" height="505" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="パイン形とずらし面積" class="level3">
<h3 class="anchored" data-anchor-id="パイン形とずらし面積">パイン形とずらし面積</h3>
<p>半径 <img src="https://latex.codecogs.com/png.latex?2">, 弧の長さが <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20L%20=%20%5Cfrac%7B2%7D%7B3%7D%5Cpi"> の扇形から，半径 <img src="https://latex.codecogs.com/png.latex?2/3">, 弧の長さが <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20l%20=%20%5Cfrac%7B2%7D%7B9%7D%5Cpi"> の扇形を除いたパイン形を考えます．このパイン形に対して，「分割交互ずらし」を適用して極限を取ると，底辺の長さ <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20%5Cfrac%7B4%7D%7B3%7D">，高さ</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctext%7Bheight%7D%20=%20%5Cfrac%7Bl%20+%20L%7D%7B2%7D%20=%20%5Cfrac%7B4%7D%7B9%7D%5Cpi%0A"></p>
<p>の長方形へ収束します．このとき，このパイン型の面積は</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AS%20=%20%5Cfrac%7Bl%20+%20L%7D%7B2%7D%5Ctimes%20%5Cfrac%7B4%7D%7B3%7D%20=%20%5Cfrac%7B16%7D%7B27%7D%5Cpi%0A"></p>
<div id="1154e612" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb4-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb4-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> shapely.geometry <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Polygon</span>
<span id="cb4-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> shapely.affinity <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> translate</span>
<span id="cb4-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> shapely.ops <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> unary_union</span>
<span id="cb4-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> shapely.affinity <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rotate</span>
<span id="cb4-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> geopandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> gpd</span>
<span id="cb4-8"></span>
<span id="cb4-9"></span>
<span id="cb4-10"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> create_sector(center, radius, angle_start, angle_end, num_points<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>):</span>
<span id="cb4-11">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Creates a sector shape as a polygon using Shapely."""</span></span>
<span id="cb4-12">    angles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(np.radians(angle_start), np.radians(angle_end), num_points)</span>
<span id="cb4-13">    outer_arc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb4-14">        (center[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> radius <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.cos(a), center[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> radius <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(a)) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> a <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> angles</span>
<span id="cb4-15">    ]</span>
<span id="cb4-16">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> Polygon([center] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> outer_arc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> [center])  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Close the polygon</span></span>
<span id="cb4-17"></span>
<span id="cb4-18"></span>
<span id="cb4-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Parameters</span></span>
<span id="cb4-20">divide_num <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb4-21">ring_sector_list <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb4-22">outer_radius <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb4-23">angle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> divide_num</span>
<span id="cb4-24"></span>
<span id="cb4-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(divide_num):</span>
<span id="cb4-26">    center <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-27">    inner_radius <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> outer_radius <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb4-28">    angle_start, angle_end <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> angle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> i, angle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Angle in degrees</span></span>
<span id="cb4-29"></span>
<span id="cb4-30">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create outer and inner sectors</span></span>
<span id="cb4-31">    outer_sector <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_sector(center, outer_radius, angle_start, angle_end)</span>
<span id="cb4-32">    inner_sector <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_sector(center, inner_radius, angle_start, angle_end)</span>
<span id="cb4-33"></span>
<span id="cb4-34">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Subtract inner sector from outer sector to get the ring shape</span></span>
<span id="cb4-35">    ring_sector <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> outer_sector.difference(inner_sector)</span>
<span id="cb4-36">    ring_sector_list.append(ring_sector)</span>
<span id="cb4-37"></span>
<span id="cb4-38"></span>
<span id="cb4-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot</span></span>
<span id="cb4-40">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb4-41"></span>
<span id="cb4-42"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> ring_sector <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ring_sector_list:</span>
<span id="cb4-43">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot using GeoPandas</span></span>
<span id="cb4-44">    gdf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gpd.GeoSeries([ring_sector])</span>
<span id="cb4-45">    gdf.plot(ax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightblue"</span>, edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>)</span>
<span id="cb4-46"></span>
<span id="cb4-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Formatting</span></span>
<span id="cb4-48">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_xlim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, outer_radius <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb4-49">ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].set_ylim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, outer_radius <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb4-50"></span>
<span id="cb4-51">gdf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gpd.GeoSeries([ring_sector_list[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]])</span>
<span id="cb4-52">rotated_gdf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gpd.GeoSeries(rotate(ring_sector_list[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>, origin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>))</span>
<span id="cb4-53"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(ring_sector_list)):</span>
<span id="cb4-54">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot using GeoPandas</span></span>
<span id="cb4-55">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb4-56">        gdf_tmp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gdf.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">apply</span>(</span>
<span id="cb4-57">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> geom: translate(</span>
<span id="cb4-58">                geom, xoff<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, yoff<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>np.sin(np.radians(angle))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb4-59">            )</span>
<span id="cb4-60">        )</span>
<span id="cb4-61">        gdf_tmp.plot(ax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightblue"</span>, edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>)</span>
<span id="cb4-62">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb4-63">        gdf_tmp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rotated_gdf.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">apply</span>(</span>
<span id="cb4-64">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> geom: translate(</span>
<span id="cb4-65">                geom, xoff<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, yoff<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>np.sin(np.radians(angle))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> np.sin(np.radians(angle))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb4-66">            ))</span>
<span id="cb4-67">        gdf_tmp.plot(ax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ax[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightblue"</span>, edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>)</span>
<span id="cb4-68"></span>
<span id="cb4-69"></span>
<span id="cb4-70">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-02-28-cavalieri-principle/index_files/figure-html/cell-5-output-1.png" width="962" height="466" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="線分の運動とずらし面積" class="level2">
<h2 class="anchored" data-anchor-id="線分の運動とずらし面積">線分の運動とずらし面積</h2>
<p>野球グラウンドをならすときトンボという道具を使ったりします．このトンボを引きづる用な形でグラウンドを適当に歩くと，トンボがなす線分がグラウンドを通過することで図形が出来ます． 線分の運動の観点から，この図形の面積を求める方法をここでは紹介します．</p>
<div id="23a7e48c" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> scipy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> interpolate</span>
<span id="cb5-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb5-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb5-4"></span>
<span id="cb5-5">N <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb5-6"></span>
<span id="cb5-7">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, N)</span>
<span id="cb5-8"></span>
<span id="cb5-9">y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb5-10">    np.sin(x)</span>
<span id="cb5-11">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> np.cos(x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb5-12">)</span>
<span id="cb5-13"></span>
<span id="cb5-14">dydx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.cos(x) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x</span>
<span id="cb5-15">dydx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.where(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(dydx) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-10</span>, dydx, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb5-16"></span>
<span id="cb5-17"></span>
<span id="cb5-18">upper_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb5-19">upper_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb5-20">lower_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb5-21">lower_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb5-22"></span>
<span id="cb5-23"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(N):</span>
<span id="cb5-24">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> dydx[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb5-25">        dy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>dydx[i])</span>
<span id="cb5-26">        dist <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.sqrt(dy<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb5-27">        dx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> dist</span>
<span id="cb5-28">        dy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> dist</span>
<span id="cb5-29">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> dydx[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb5-30">        dy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>dydx[i])</span>
<span id="cb5-31">        dist <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.sqrt(dy<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb5-32">        dx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> dist</span>
<span id="cb5-33">        dy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> dist</span>
<span id="cb5-34">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb5-35">        dx, dy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb5-36">    </span>
<span id="cb5-37">    upper_y.append(y[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dy)</span>
<span id="cb5-38">    upper_x.append(x[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dx)</span>
<span id="cb5-39">    lower_y.append(y[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> dy)</span>
<span id="cb5-40">    lower_x.append(x[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> dx)</span>
<span id="cb5-41"></span>
<span id="cb5-42">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots()</span>
<span id="cb5-43"></span>
<span id="cb5-44">ax.plot(x, y, label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Trajectory of the center point'</span>)</span>
<span id="cb5-45">ax.plot(upper_x, upper_y, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gray'</span>, linestyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--'</span>)</span>
<span id="cb5-46">ax.plot(lower_x, lower_y, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gray'</span>, linestyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--'</span>)</span>
<span id="cb5-47"></span>
<span id="cb5-48">ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'box'</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ensure the x and y axes have the same ratio</span></span>
<span id="cb5-49"></span>
<span id="cb5-50">ax.set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Trajectory of a bar with length 0.2"</span>)</span>
<span id="cb5-51"></span>
<span id="cb5-52">plt.legend()</span>
<span id="cb5-53">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-02-28-cavalieri-principle/index_files/figure-html/cell-6-output-1.png" width="582" height="291" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>一般に，大きさのある物体（剛体という）の運動は，「並進運動」と「回転運動」の合成で表されます．長さ <img src="https://latex.codecogs.com/png.latex?0.2"> のトンボがグラウンドを並進運動と回転運動で通過する際に描かれる図形をplotしたものが上の図となります． 灰色の点線がそれぞれトンボの両端の軌跡を描いており，青の実線がトンボの中心点の軌跡となります．トンボがならしたグラウンドの面積は灰色で囲まれたエリアとなります．</p>
<p><strong> ▶&nbsp; <code>shapely.Polygon</code>を用いた面積の計算</strong></p>
<p>上記で中心点の軌跡から両端の軌跡の座標を計算してあるので，それらを用いて <code>shapely.Polygon</code> をまず定義します．</p>
<div id="857c07b6" class="cell" data-execution_count="6">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># shapely.Polygonの設定</span></span>
<span id="cb6-2">polygon_coords <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(upper_x, upper_y)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(lower_x[::<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], lower_y[::<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]))</span>
<span id="cb6-3">polygon <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Polygon(polygon_coords)</span>
<span id="cb6-4"></span>
<span id="cb6-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the polygon</span></span>
<span id="cb6-6">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots()</span>
<span id="cb6-7">x, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> polygon.exterior.xy</span>
<span id="cb6-8">ax.plot(x, y, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>)</span>
<span id="cb6-9">ax.fill(x, y, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'lightblue'</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb6-10">ax.set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Shapely Polygon from Upper and Lower Coordinates"</span>)</span>
<span id="cb6-11">ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'box'</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ensure the x and y axes have the same ratio</span></span>
<span id="cb6-12">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-02-28-cavalieri-principle/index_files/figure-html/cell-7-output-1.png" width="582" height="291" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>その後，<code>Polygon</code> によって定義された図形の面積を計算すれば良いので</p>
<div id="8c3bcb80" class="cell" data-execution_count="7">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">polygon.area</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>1.2470071445781767</code></pre>
</div>
</div>
<p><strong> ▶&nbsp; 曲線の長さの公式と線分の移動</strong></p>
<p>詳しい説明はのちの機会としますが，線分が履く面積は</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctext%7B%E7%B7%9A%E5%88%86%E3%81%8C%E3%81%AF%E3%81%8F%E9%9D%A2%E7%A9%8D%7D%20=%20%5Ctext%7B%E4%B8%AD%E7%82%B9%E3%81%AE%E7%A7%BB%E5%8B%95%E8%B7%9D%E9%9B%A2%7D%20%5Ctimes%20%5Ctext%7B%E7%B7%9A%E5%88%86%E3%81%AE%E9%95%B7%E3%81%95%7D%0A"></p>
<p>で計算することが出来ます．線分の長さは <img src="https://latex.codecogs.com/png.latex?0.2"> とわかっているので，「<strong>中点の移動距離</strong>」を求めれば面積が求まりそうなことがわかります．</p>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="thm-" class="custom_problem theorem">
<p><span class="theorem-title"><strong>Theorem 2</strong></span> <strong>: 曲線の長さ</strong> <br></p>
<p><img src="https://latex.codecogs.com/png.latex?y=f(x)"> で表される曲線の <img src="https://latex.codecogs.com/png.latex?x%20%5Cin%20%5Ba,%20b%5D"> の部分の長さ <img src="https://latex.codecogs.com/png.latex?L"> は，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AL%20=%20%5Cint%5Eb_a%20%5Csqrt%7B1%20+%20f%5E%5Cprime(x)%5E2%7D%20dx%0A"></p>
<p>​（ただし，<img src="https://latex.codecogs.com/png.latex?f(x)"> は微分可能で <img src="https://latex.codecogs.com/png.latex?f%5E%5Cprime(x)"> は連続とする）</p>
</div>
</div>
<p>点 <img src="https://latex.codecogs.com/png.latex?x"> から<img src="https://latex.codecogs.com/png.latex?%5CDelta%20x"> 動いたとき，<img src="https://latex.codecogs.com/png.latex?%5CDelta%20y%20%5Capprox%20f%5E%5Cprime(x)%5CDelta%20x"> 動くことから，その区間での曲線の長さは</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Csqrt%7B(%5CDelta%20x)%5E2%20+%20(f%5E%5Cprime(x)%5CDelta%20x)%5E2%7D%20=%20%5Csqrt%7B1%20+%20f%5E%5Cprime(x)%5E2%7D%5CDelta%20x%0A"></p>
<p>で近似できます．従って，<img src="https://latex.codecogs.com/png.latex?%5CDelta%20x%20%5Cto%20dx"> と極限を取ることで</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AL%20=%20%5Cint%5Eb_a%20%5Csqrt%7B1%20+%20f%5E%5Cprime(x)%5E2%7D%20dx%0A"></p>
<p>と理解することが出来ます．</p>
<p>今回の曲線 <img src="https://latex.codecogs.com/png.latex?f(x)"> は <img src="https://latex.codecogs.com/png.latex?%5B0,%205%5D"> 区間で以下のように記述することができるとします．</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(x)%20=%20%20%5Csin(x)%20+%200.1%5Ccos(x%5E2)%0A"></p>
<p>このとき，<img src="https://latex.codecogs.com/png.latex?f(x)"> の1次導関数は</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af%5E%5Cprime(x)%20=%20%5Ccos(x)%20-%200.2%20x%20%5Csin(x%5E2)%0A"></p>
<p>従って，曲線の公式より</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AL%20=%20%5Cint%5E5_0%20%5Csqrt%7B1%20+%20%20%5Ccos%5E2(x)%20+%200.04%20x%5E2%20%5Csin%5E2(x%5E2)%20-%200.4x%5Ccos(x)%5Csin(x%5E2)%7Ddx%0A"></p>
<p><code>scipy.integrate.quad</code> を用いて数値計算すると</p>
<div id="63c7fabd" class="cell" data-execution_count="8">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> scipy.integrate <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> quad</span>
<span id="cb9-2"></span>
<span id="cb9-3"></span>
<span id="cb9-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> curve_length(x):</span>
<span id="cb9-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> np.sqrt(</span>
<span id="cb9-6">        np.cos(x) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb9-7">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb9-8">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.cos(x) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x</span>
<span id="cb9-9">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb9-10">    )</span>
<span id="cb9-11"></span>
<span id="cb9-12"></span>
<span id="cb9-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(quad(curve_length, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1.24703476690297</code></pre>
</div>
</div>
<p><code>shapely.Polygon</code> を用いた計算結果と近しい値であることから計算結果の妥当性をうかがい知ることができます．</p>


</section>

 ]]></description>
  <category>幾何</category>
  <guid>https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-02-28-cavalieri-principle/</guid>
  <pubDate>Fri, 28 Feb 2025 00:00:00 GMT</pubDate>
</item>
<item>
  <title>tangent 75°の図形的計算</title>
  <dc:creator>Ryo Nakagami</dc:creator>
  <link>https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-02-27-how-to-compute-tan75/</link>
  <description><![CDATA[ 





<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="exr-" class="custom_problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1</strong></span> <br></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctan%20%7B75%7D%5E%5Ccirc"> を求めよ</p>
</div>
</div>
<!--::: {.callout-note collapse="true" icon=false}-->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
解1: 加法定理を用いる場合
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Ctan%20%7B45%7D%5E%5Ccirc%20&amp;=%201%5C%5C%0A%5Ctan%20%7B30%7D%5E%5Ccirc%20&amp;=%20%5Cfrac%7B%5Csqrt%7B3%7D%7D%7B3%7D%0A%5Cend%7Balign%7D%0A"></p>
<p>より，加法定理を用いて</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Ctan%20%7B75%7D%5E%5Ccirc%0A%20%20%20%20&amp;=%20%5Cfrac%7B%5Ctan%7B30%7D%5E%5Ccirc%20+%20%5Ctan%7B45%7D%5E%5Ccirc%7D%7B1%20-%20%5Ctan%7B30%7D%5E%5Ccirc%5Ctan%7B45%7D%5E%5Ccirc%7D%5C%5C%0A%20%20%20%20&amp;=%20%5Cfrac%7B1%20+%20%5Cfrac%7B%5Csqrt%7B3%7D%7D%7B3%7D%7D%7B1%20-%20%5Cfrac%7B%5Csqrt%7B3%7D%7D%7B3%7D%7D%5C%5C%0A%20%20%20%20&amp;=%202%20+%20%5Csqrt%7B3%7D%0A%5Cend%7Balign%7D%0A"></p>
</div>
</div>
</div>
<!--::: {.callout-note collapse="true" icon=false}-->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
解2: 平面幾何的に求める場合
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5Cangle%20A%20=%20%7B30%7D%5E%5Ccirc,%20%5Cangle%20B%20=%20%7B90%7D%5E%5Ccirc,%20%5Cangle%20C%20=%20%7B60%7D%5E%5Ccirc"> の <img src="https://latex.codecogs.com/png.latex?%5Ctriangle%20ABC"> を考えたとき，<img src="https://latex.codecogs.com/png.latex?%5Cangle%20A"> の斜辺 <img src="https://latex.codecogs.com/png.latex?AC"> を用いて 直角二等辺三角形 <img src="https://latex.codecogs.com/png.latex?%5Ctriangle%20ACD"> をまず作成します．</p>
<p>この点 <img src="https://latex.codecogs.com/png.latex?D"> を通るように <img src="https://latex.codecogs.com/png.latex?AB"> と平行な線を引き，長方形 <img src="https://latex.codecogs.com/png.latex?AEFB"> を以下のように作成します．</p>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> shapely.plotting</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> shapely.geometry <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Polygon</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-5"></span>
<span id="cb1-6">A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb1-7">B <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb1-8">C <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, np.sin(np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>)))</span>
<span id="cb1-9">D <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (np.sqrt(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.cos(np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>)), np.sqrt(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>)))</span>
<span id="cb1-10">E <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, np.sqrt(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>)))</span>
<span id="cb1-11">F <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, np.sqrt(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>)))</span>
<span id="cb1-12"></span>
<span id="cb1-13">polygon1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Polygon([A, B, C])</span>
<span id="cb1-14">polygon2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Polygon([A, C, D])</span>
<span id="cb1-15">polygon3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Polygon([A, E, D])</span>
<span id="cb1-16">polygon4 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Polygon([C, D, F])</span>
<span id="cb1-17"></span>
<span id="cb1-18">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb1-19"></span>
<span id="cb1-20">shapely.plotting.plot_polygon(polygon1, ax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ax)</span>
<span id="cb1-21">shapely.plotting.plot_polygon(polygon2, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, facecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>, ax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ax)</span>
<span id="cb1-22">shapely.plotting.plot_polygon(polygon3, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, facecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>, ax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ax)</span>
<span id="cb1-23">shapely.plotting.plot_polygon(polygon4, ax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ax)</span>
<span id="cb1-24"></span>
<span id="cb1-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 軸の範囲を設定</span></span>
<span id="cb1-26">plt.xlim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.45</span>)</span>
<span id="cb1-27">plt.ylim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.45</span>)</span>
<span id="cb1-28"></span>
<span id="cb1-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add label</span></span>
<span id="cb1-30">plt.text(A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'A'</span>)</span>
<span id="cb1-31">plt.text(B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>, B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'B'</span>)</span>
<span id="cb1-32">plt.text(C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>, C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C'</span>)</span>
<span id="cb1-33">plt.text(D[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], D[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'D'</span>)</span>
<span id="cb1-34">plt.text(E[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], E[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'E'</span>)</span>
<span id="cb1-35">plt.text(F[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], F[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'F'</span>)</span>
<span id="cb1-36"></span>
<span id="cb1-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add Angles</span></span>
<span id="cb1-38">ax.text(A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.06</span>, A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">°"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb1-39">ax.text(A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.06</span>, A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">°"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb1-40">ax.text(B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.09</span>, B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">°"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb1-41">ax.text(C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">°"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb1-42">ax.text(C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.14</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">°"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb1-43">ax.text(C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">°"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb1-44"></span>
<span id="cb1-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add length</span></span>
<span id="cb1-46">ax.text(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$\sqrt</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{3}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">$"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, horizontalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>)</span>
<span id="cb1-47">ax.text(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, horizontalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>)</span>
<span id="cb1-48">ax.text(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, horizontalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>)</span>
<span id="cb1-49">ax.text(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.05</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, horizontalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span>)</span>
<span id="cb1-50">ax.text(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.05</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$\sqrt</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{3}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">$"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, horizontalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span>)</span>
<span id="cb1-51">ax.text((D[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> F[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.37</span>,  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, horizontalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>)</span>
<span id="cb1-52">ax.text((D[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> E[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.37</span>,  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$\sqrt</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{3}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> - 1$"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, horizontalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>)</span>
<span id="cb1-53"></span>
<span id="cb1-54"></span>
<span id="cb1-55">plt.show()</span></code></pre></div>
</details>
<div id="fig-plot" class="center quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="e7465092" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-02-27-how-to-compute-tan75/index_files/figure-html/cell-2-output-1.png" width="496" height="485" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1
</figcaption>
</figure>
</div>
<p>このとき， <img src="https://latex.codecogs.com/png.latex?%5Ctriangle%20CFD%20%20%5Cequiv%20%5Ctriangle%20ABC"> なので</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?AE%20=%201%20+%20%5Csqrt%7B3%7D"></li>
<li><img src="https://latex.codecogs.com/png.latex?DE%20=%20%5Csqrt%7B3%7D%20-%201"></li>
</ul>
<p>であることがわかります．<img src="https://latex.codecogs.com/png.latex?%5Ctriangle%20ACD"> は直角二等辺三角形なので <img src="https://latex.codecogs.com/png.latex?%5Cangle%20ADC%20=%20%7B45%7D%5E%5Ccirc">．従って，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cangle%20ADE%20=%20%7B75%7D%5E%5Ccirc%0A"></p>
<p>よって，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Ctan%7B75%7D%5E%5Ccirc%0A%20%20%20%20&amp;=%20%5Cfrac%7B1%20+%20%5Csqrt%7B3%7D%7D%7B%5Csqrt%7B3%7D%20-%201%7D%20%5C%5C%0A%20%20%20%20&amp;=%20%5Cfrac%7B4%20+%202%5Csqrt%7B3%7D%7D%7B2%7D%5C%5C%0A%20%20%20%20&amp;=%202%20+%20%5Csqrt%7B3%7D%0A%5Cend%7Balign%7D%0A"></p>
</div>
</div>
</div>



 ]]></description>
  <category>三角関数</category>
  <guid>https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-02-27-how-to-compute-tan75/</guid>
  <pubDate>Thu, 27 Feb 2025 00:00:00 GMT</pubDate>
</item>
<item>
  <title>余弦定理の考え方</title>
  <dc:creator>Ryo Nakagami</dc:creator>
  <link>https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-02-26-law-of-cosines/</link>
  <description><![CDATA[ 





<section id="余弦定理の考え方" class="level2">
<h2 class="anchored" data-anchor-id="余弦定理の考え方">余弦定理の考え方</h2>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="exr-" class="custom_problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1</strong></span> <br></p>
<p><img src="https://latex.codecogs.com/png.latex?AC%20=%2030,%20BC%20=%2026,%20%5Cangle%20C%20=%2070%5E%5Ccirc"> となるような <img src="https://latex.codecogs.com/png.latex?%5Ctriangle%20ABC"> が与えられたとします．このとき，長さ <img src="https://latex.codecogs.com/png.latex?AB"> を求めよ</p>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.patches <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> patches</span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 辺の長さと角度</span></span>
<span id="cb1-6">AC <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb1-7">BC <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">26</span></span>
<span id="cb1-8">angle_C <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span></span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 角度をラジアンに変換</span></span>
<span id="cb1-11">angle_C_rad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.radians(angle_C)</span>
<span id="cb1-12"></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 点Aの座標</span></span>
<span id="cb1-14">A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb1-15"></span>
<span id="cb1-16">AB <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.sqrt(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">26</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">26</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.cos(np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>)))</span>
<span id="cb1-17"></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 点Bの座標</span></span>
<span id="cb1-19">B <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (AB, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb1-20"></span>
<span id="cb1-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 点Cの座標</span></span>
<span id="cb1-22">cos_A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> AB<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">26</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> AB)</span>
<span id="cb1-23">sin_A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.sqrt(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> cos_A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-24">C <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> cos_A, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> sin_A)</span>
<span id="cb1-25"></span>
<span id="cb1-26">slope <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb1-27">H <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">24.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">24.6</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> slope)</span>
<span id="cb1-28"></span>
<span id="cb1-29"></span>
<span id="cb1-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 座標をリストに変換</span></span>
<span id="cb1-31">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb1-32"></span>
<span id="cb1-33">ax.plot([A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], H[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]], [A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], H[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"k"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Black line with circle markers</span></span>
<span id="cb1-34">ax.plot([A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]], [A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ko-"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Black line with circle markers</span></span>
<span id="cb1-35">ax.plot([B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]], [B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ko-"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Black line with circle markers</span></span>
<span id="cb1-36">ax.plot([C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]], [C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ko-"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Black line with circle markers</span></span>
<span id="cb1-37"></span>
<span id="cb1-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 点のラベル</span></span>
<span id="cb1-39">plt.text(H[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, H[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"H"</span>)</span>
<span id="cb1-40">plt.text(A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>)</span>
<span id="cb1-41">plt.text(B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>)</span>
<span id="cb1-42">plt.text(C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C"</span>)</span>
<span id="cb1-43"></span>
<span id="cb1-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 軸の範囲を設定</span></span>
<span id="cb1-45">plt.xlim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>)</span>
<span id="cb1-46">plt.ylim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>)</span>
<span id="cb1-47"></span>
<span id="cb1-48"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 軸のラベルを設定</span></span>
<span id="cb1-49">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"X"</span>)</span>
<span id="cb1-50">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Y"</span>)</span>
<span id="cb1-51"></span>
<span id="cb1-52"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># タイトルを設定</span></span>
<span id="cb1-53">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Triangle ABC"</span>)</span>
<span id="cb1-54"></span>
<span id="cb1-55"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add angles as arcs</span></span>
<span id="cb1-56">arc_radius <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Radius for the arcs</span></span>
<span id="cb1-57"></span>
<span id="cb1-58"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Angle at B</span></span>
<span id="cb1-59">angle_C_arc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> patches.Arc(C, arc_radius<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, arc_radius<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, angle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>, theta1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>np.degrees(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">320</span>), theta2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>np.degrees(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>), color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blue'</span>)</span>
<span id="cb1-60">ax.add_patch(angle_C_arc)</span>
<span id="cb1-61">ax.text(C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> arc_radius<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.8</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">°"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blue'</span>)</span>
<span id="cb1-62"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ax.text(C[0] + arc_radius/2, B[1] + 1, f"{70}°", fontsize=12, color='blue')</span></span>
<span id="cb1-63">ax.text(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AC = 30"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>, horizontalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb1-64">ax.text(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BC = 26"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>, horizontalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb1-65"></span>
<span id="cb1-66"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 図の表示</span></span>
<span id="cb1-67">plt.show()</span></code></pre></div>
</details>
<div id="fig-plot" class="center quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="fceea146" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-02-26-law-of-cosines/index_files/figure-html/cell-2-output-1.png" width="521" height="523" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1
</figcaption>
</figure>
</div>
<p>このとき，点 <img src="https://latex.codecogs.com/png.latex?A"> から <img src="https://latex.codecogs.com/png.latex?BC"> に対して垂線を下ろし，その交点を <img src="https://latex.codecogs.com/png.latex?H"> とします．このとき</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0ACH%20&amp;=%20AC%20*%20%5Ccos(C)%5C%5C%0ABH%20&amp;=%20BC%20-%20AC%20*%20%5Ccos(C)%5C%5C%0AAH&amp;%20=%20AC%20*%20%5Csin(C)%0A%5Cend%7Balign%7D%0A"></p>
<p>ピタゴラスの定理より</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AAB%5E2%20=%20AH%5E2%20+%20BH%5E2%0A"></p>
<p>なので</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0AAB%5E2%20&amp;=%20(BC%20-%20AC%20*%20%5Ccos(C))%5E2%20+%20(AC%20*%20%5Csin(C))%5E2%5C%5C%0A%20%20%20%20%20&amp;=%20BC%5E2%20+%20AC%5E2%20-%202%5Ccdot%20BC%5Ccdot%20AC%20%5Ccos(C)%0A%5Cend%7Balign%7D%0A"></p>
<p>従って，</p>
<div id="ca7bc67e" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"AB = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>AB<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>AB = 32.29</code></pre>
</div>
</div>
<p><strong> ▶&nbsp; ベクトルを用いた直感的理解</strong></p>
<p>ベクトルの内積は <img src="https://latex.codecogs.com/png.latex?%5Cvec%20a%20%5Ccdot%20%5Cvec%20b%20=%20%5Clvert%20a%20%5Crvert%20%5Clvert%20b%20%5Crvert%20%5Ccos%20%5Ctheta"> で定義されることを利用すると，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0AAB%5E2%0A%20%20%20%20&amp;=%20%5Cleft%5Clvert%20%5Coverrightarrow%7BCA%7D%20-%20%5Coverrightarrow%7BCB%7D%20%5Cright%5Crvert%5E2%20%5C%5C%0A%20%20%20%20&amp;=%20(%5Coverrightarrow%7BCA%7D%20-%20%5Coverrightarrow%7BCB%7D)%20%5Ccdot%20(%5Coverrightarrow%7BCA%7D%20-%20%5Coverrightarrow%7BCB%7D)%20%5C%5C%0A%20%20%20%20&amp;=%20%5Cleft%5Clvert%20%5Coverrightarrow%7BCA%7D%20%5Cright%5Crvert%5E2%20+%20%5Cleft%5Clvert%20%5Coverrightarrow%7BCB%7D%20%5Cright%5Crvert%5E2%0A%20%20%20%20-%202%20%5Coverrightarrow%7BCA%7D%20%5Ccdot%20%5Coverrightarrow%7BCB%7D%20%5C%5C%0A%20%20%20%20&amp;=%20%5Cleft%5Clvert%20%5Coverrightarrow%7BCA%7D%20%5Cright%5Crvert%5E2%20+%20%5Cleft%5Clvert%20%5Coverrightarrow%7BCB%7D%20%5Cright%5Crvert%5E2%0A%20%20%20%20-%202%20%5Cleft%5Clvert%20%5Coverrightarrow%7BCA%7D%20%5Cright%5Crvert%20%5Cleft%5Clvert%20%5Coverrightarrow%7BCB%7D%20%5Cright%5Crvert%20%5Ccos(%5Cangle%20ACB)%20%5C%5C%0A%20%20%20%20&amp;=%20AC%5E2%20+%20BC%5E2%20%20-%202%5Ccdot%20AC%5Ccdot%20BC%20%5Ccos(C)%0A%5Cend%7Baligned%7D%0A"></p>
<section id="正弦定理と余弦定理の応用-対岸の２点間距離を測る" class="level3">
<h3 class="anchored" data-anchor-id="正弦定理と余弦定理の応用-対岸の２点間距離を測る">正弦定理と余弦定理の応用: 対岸の２点間距離を測る</h3>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="exr-" class="custom_problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2</strong></span> <br></p>
<p>四角形PABQ が以下のように与えられている</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?AB%20=%2010"></li>
<li><img src="https://latex.codecogs.com/png.latex?%5Cangle%20PAB%20=%20%7B75%7D%5E%5Ccirc"></li>
<li><img src="https://latex.codecogs.com/png.latex?%5Cangle%20PBA%20=%20%7B50%7D%5E%5Ccirc"></li>
<li><img src="https://latex.codecogs.com/png.latex?%5Cangle%20PAQ%20=%20%7B40%7D%5E%5Ccirc"></li>
<li><img src="https://latex.codecogs.com/png.latex?%5Cangle%20QAB%20=%20%7B35%7D%5E%5Ccirc"></li>
<li><img src="https://latex.codecogs.com/png.latex?%5Cangle%20PBQ%20=%20%7B70%7D%5E%5Ccirc"></li>
</ul>
<p>このとき，PQの距離を求めよ．</p>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb4-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb4-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.patches <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> patches</span>
<span id="cb4-4"></span>
<span id="cb4-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 辺の長さと角度</span></span>
<span id="cb4-6">AB <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb4-7">angle_PAB <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>)</span>
<span id="cb4-8">angle_PBA <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>)</span>
<span id="cb4-9">angle_QAB <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>)</span>
<span id="cb4-10">angle_AQB <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>)</span>
<span id="cb4-11">angle_QBA <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">120</span>)</span>
<span id="cb4-12">angle_APB <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">55</span>)</span>
<span id="cb4-13"></span>
<span id="cb4-14"></span>
<span id="cb4-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 点Aの座標</span></span>
<span id="cb4-16">A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-17"></span>
<span id="cb4-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 点Bの座標</span></span>
<span id="cb4-19">B <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (AB, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-20"></span>
<span id="cb4-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 点Pの座標</span></span>
<span id="cb4-22">PA <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AB <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> np.sin(angle_APB) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(angle_PBA)</span>
<span id="cb4-23">P <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ((np.cos(angle_PAB)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> PA, (np.sin(angle_PAB)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> PA)</span>
<span id="cb4-24"></span>
<span id="cb4-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 点Qの座標</span></span>
<span id="cb4-26">QA <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AB <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> np.sin(angle_AQB) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(angle_QBA)</span>
<span id="cb4-27">Q <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ((np.cos(angle_QAB)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> QA, (np.sin(angle_QAB)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> QA)</span>
<span id="cb4-28"></span>
<span id="cb4-29"></span>
<span id="cb4-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 座標をリストに変換</span></span>
<span id="cb4-31">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb4-32"></span>
<span id="cb4-33">ax.plot([A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]], [A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"k"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Black line with circle markers</span></span>
<span id="cb4-34">ax.plot([A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]], [A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ko-"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Black line with circle markers</span></span>
<span id="cb4-35">ax.plot([B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]], [B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ko-"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Black line with circle markers</span></span>
<span id="cb4-36">ax.plot([Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]], [Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ko-"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Black line with circle markers</span></span>
<span id="cb4-37">ax.plot([Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]], [Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ko-"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Black line with circle markers</span></span>
<span id="cb4-38">ax.plot([Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]], [Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ko-"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Black line with circle markers</span></span>
<span id="cb4-39"></span>
<span id="cb4-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 点のラベル</span></span>
<span id="cb4-41">plt.text(A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>)</span>
<span id="cb4-42">plt.text(B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>)</span>
<span id="cb4-43">plt.text(P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P"</span>)</span>
<span id="cb4-44">plt.text(Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Q"</span>)</span>
<span id="cb4-45"></span>
<span id="cb4-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 軸の範囲を設定</span></span>
<span id="cb4-47">plt.xlim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb4-48">plt.ylim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb4-49"></span>
<span id="cb4-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 軸のラベルを設定</span></span>
<span id="cb4-51">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"X"</span>)</span>
<span id="cb4-52">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Y"</span>)</span>
<span id="cb4-53"></span>
<span id="cb4-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># タイトルを設定</span></span>
<span id="cb4-55">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"How far is the distance between P and Q"</span>)</span>
<span id="cb4-56"></span>
<span id="cb4-57"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add angles as arcs</span></span>
<span id="cb4-58">arc_radius <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Radius for the arcs</span></span>
<span id="cb4-59"></span>
<span id="cb4-60"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Angle at B</span></span>
<span id="cb4-61">ax.text(A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.8</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">°"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>)</span>
<span id="cb4-62">ax.text(A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">°"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>)</span>
<span id="cb4-63">ax.text(B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">°"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>)</span>
<span id="cb4-64">ax.text(B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">°"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>)</span>
<span id="cb4-65"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ax.text(C[0] + arc_radius/2, B[1] + 1, f"{70}°", fontsize=12, color='blue')</span></span>
<span id="cb4-66">ax.text(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AB = 10"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, horizontalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>)</span>
<span id="cb4-67">ax.text(</span>
<span id="cb4-68">    (P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb4-69">    (P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Q[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-70">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PQ = ???"</span>,</span>
<span id="cb4-71">    fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,</span>
<span id="cb4-72">    color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span id="cb4-73">    horizontalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>,</span>
<span id="cb4-74">)</span>
<span id="cb4-75"></span>
<span id="cb4-76"></span>
<span id="cb4-77"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 図の表示</span></span>
<span id="cb4-78">plt.show()</span></code></pre></div>
</details>
<div id="fig-plot" class="center quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="0c87f1ef" class="cell" data-execution_count="3">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-02-26-law-of-cosines/index_files/figure-html/cell-4-output-1.png" width="538" height="523" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2
</figcaption>
</figure>
</div>
</div>
</div>
<!--::: {.callout-note collapse="true" icon=false}-->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution 1: 余弦定理を用いて解く
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5Cangle%20PAQ%20=%20%7B40%7D%5E%5Ccirc"> と問題分よりわかるので，<img src="https://latex.codecogs.com/png.latex?PA,%20QA"> の長さがわかれば余弦定理より <img src="https://latex.codecogs.com/png.latex?PQ"> が導出できます．</p>
<p>正弦定理を用いて</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0APA%20&amp;=%20%5Cfrac%7BAB%7D%7B%5Csin(%7B55%7D%5E%5Ccirc)%7D%5Ctimes%20%5Csin(%7B50%7D%5E%5Ccirc)%5C%5C%0AQA%20&amp;=%20%5Cfrac%7BAB%7D%7B%5Csin(%7B25%7D%5E%5Ccirc)%7D%5Ctimes%20%5Csin(%7B120%7D%5E%5Ccirc)%0A%5Cend%7Balign%7D%0A"></p>
<p>余弦定理を用いると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0APQ%5E2%20=%20QA%5E2%20+%20PA%5E2%20-%202(PA)(QA)%5Ccos(%7B40%7D%5E%5Ccirc)%0A"></p>
<p>よって，</p>
<div id="f52584ba" class="cell" data-execution_count="4">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-overflow-wrap code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set variables</span></span>
<span id="cb5-2">AB <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb5-3">angle_APB <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">55</span>)</span>
<span id="cb5-4">angle_AQB <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>)</span>
<span id="cb5-5">angle_PBA <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>)</span>
<span id="cb5-6">angle_QBA <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">120</span>)</span>
<span id="cb5-7">angle_PAQ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>)</span>
<span id="cb5-8"></span>
<span id="cb5-9"></span>
<span id="cb5-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># compute PA and QA</span></span>
<span id="cb5-11">PA <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AB <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> np.sin(angle_APB) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(angle_PBA)</span>
<span id="cb5-12">QA <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AB <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> np.sin(angle_AQB) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(angle_QBA)</span>
<span id="cb5-13"></span>
<span id="cb5-14"></span>
<span id="cb5-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># comnpute PQ using laws of cosines</span></span>
<span id="cb5-16">PQ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.sqrt(PA <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> QA <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> PA <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> QA <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.cos(angle_PAQ))</span>
<span id="cb5-17"></span>
<span id="cb5-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"PQ = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>PQ<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>PQ = 14.62</code></pre>
</div>
</div>
</div>
</div>
</div>
<!--::: {.callout-note collapse="true" icon=false}-->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution 2: 座標を用いて解く
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>各点を <img src="https://latex.codecogs.com/png.latex?XY"> 平明座標に以下のように置き換えます</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?A"> = (0, 0)</li>
<li><img src="https://latex.codecogs.com/png.latex?B"> = (0, 10)</li>
</ul>
<p>このとき，点 <img src="https://latex.codecogs.com/png.latex?P"> の座標 <img src="https://latex.codecogs.com/png.latex?(P_X,%20P_Y)"> は</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0AP_X%20&amp;%20=%20PA%20%5Ccdot%20%5Ccos(%7B75%7D%5E%5Ccirc)%5C%5C%0AP_Y%20&amp;%20=%20PA%20%5Ccdot%20%5Csin(%7B75%7D%5E%5Ccirc)%0A%5Cend%7Balign%7D%0A"></p>
<p>同様に点 <img src="https://latex.codecogs.com/png.latex?Q"> の座標 <img src="https://latex.codecogs.com/png.latex?(Q_X,%20Q_Y)"> は</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0AQ_X%20&amp;%20=%20QA%20%5Ccdot%20%5Ccos(%7B35%7D%5E%5Ccirc)%5C%5C%0AQ_Y%20&amp;%20=%20QA%20%5Ccdot%20%5Csin(%7B35%7D%5E%5Ccirc)%0A%5Cend%7Balign%7D%0A"></p>
<p>このとき，長さ <img src="https://latex.codecogs.com/png.latex?PQ"> は点 <img src="https://latex.codecogs.com/png.latex?P,%20Q"> の距離と表せるので</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0APQ%20&amp;=%20%5ClVert%20P%20-%20Q%20%5CrVert%5C%5C%0A%20%20%20&amp;=%20%5Csqrt%7B(P_X%20-%20Q_X)%5E2%20+%20(P_Y%20-%20Q_Y)%5E2%7D%5C%5C%0A%20%20%20&amp;=%20%5Csqrt%7B(AQ%5E2%20+%20PA%5E2%20-%202(PA)(QA)(%5Ccos(%7B35%7D%5E%5Ccirc)%5Ccos(%7B75%7D%5E%5Ccirc)%20+%20%5Csin(%7B35%7D%5E%5Ccirc)%5Csin(%7B75%7D%5E%5Ccirc)))%7D%0A%5Cend%7Balign%7D%0A"></p>
<p>加法定理より</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ccos%20(A%20%5Cpm%20B)%20=%20%5Ccos%20A%20%5Ccos%20B%20%5Cmp%20%5Csin%20A%20%5Csin%20B%0A"></p>
<p>なので</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ccos(%7B35%7D%5E%5Ccirc)%5Ccos(%7B75%7D%5E%5Ccirc)%20+%20%5Csin(%7B35%7D%5E%5Ccirc)%5Csin(%7B75%7D%5E%5Ccirc)%20=%20%5Ccos(%7B40%7D%5E%5Ccirc)%0A"></p>
<p>従って，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0APQ%5E2%20=%20QA%5E2%20+%20PA%5E2%20-%202(PA)(QA)%5Ccos(%7B40%7D%5E%5Ccirc)%0A"></p>
</div>
</div>
</div>


</section>
</section>

 ]]></description>
  <category>三角関数</category>
  <guid>https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-02-26-law-of-cosines/</guid>
  <pubDate>Wed, 26 Feb 2025 00:00:00 GMT</pubDate>
</item>
<item>
  <title>正弦定理の考え方</title>
  <dc:creator>Ryo Nakagami</dc:creator>
  <link>https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-02-25-law-of-sines/</link>
  <description><![CDATA[ 





<section id="正弦定理の考え方" class="level2">
<h2 class="anchored" data-anchor-id="正弦定理の考え方">正弦定理の考え方</h2>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="exr-" class="custom_problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1</strong></span> <br></p>
<p><img src="https://latex.codecogs.com/png.latex?BC%20=%2030,%20%5Cangle%20B%20=%2070%5E%5Ccirc,%20%5Cangle%20C%20=%2063%5E%5Ccirc"> となるような <img src="https://latex.codecogs.com/png.latex?%5Ctriangle%20ABC"> が与えられたとします．このとき，長さ <img src="https://latex.codecogs.com/png.latex?AB"> を求めよ</p>
</div>
</div>
<p>設問の <img src="https://latex.codecogs.com/png.latex?%5Ctriangle%20ABC"> を図示すると以下のようになります．<img src="https://latex.codecogs.com/png.latex?B"> から <img src="https://latex.codecogs.com/png.latex?AC"> に対して垂線を垂らし，その交点を <img src="https://latex.codecogs.com/png.latex?BH"> とします．</p>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.patches <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> patches</span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> plot_triangular(base_length: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>, angles: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">tuple</span>, fig_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)):</span>
<span id="cb1-6">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Given values</span></span>
<span id="cb1-7">    BC <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Side BC</span></span>
<span id="cb1-8">    angle_B <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.radians(angles[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert degrees to radians</span></span>
<span id="cb1-9">    angle_C <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.radians(angles[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert degrees to radians</span></span>
<span id="cb1-10"></span>
<span id="cb1-11">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate angle A</span></span>
<span id="cb1-12">    angle_A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(angles))</span>
<span id="cb1-13"></span>
<span id="cb1-14">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use Law of Sines to find AB and AC</span></span>
<span id="cb1-15">    AB <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> BC <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(angle_B) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> np.sin(angle_A)</span>
<span id="cb1-16">    AC <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> BC <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(angle_C) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> np.sin(angle_A)</span>
<span id="cb1-17"></span>
<span id="cb1-18">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set points in a 2D coordinate system</span></span>
<span id="cb1-19">    B <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Point B at the origin</span></span>
<span id="cb1-20">    C <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([BC, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Point C on the x-axis</span></span>
<span id="cb1-21"></span>
<span id="cb1-22">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate A's coordinates using trigonometry</span></span>
<span id="cb1-23">    A_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> BC <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> AC <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.cos(angle_B)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Projection of AC on x-axis</span></span>
<span id="cb1-24">    A_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AC <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(angle_B)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Height of A</span></span>
<span id="cb1-25"></span>
<span id="cb1-26">    A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([A_x, A_y])</span>
<span id="cb1-27"></span>
<span id="cb1-28">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the triangle using ax</span></span>
<span id="cb1-29">    fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(figsize <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fig_size)</span>
<span id="cb1-30">    ax.plot([A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]], [A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ko-'</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Black line with circle markers</span></span>
<span id="cb1-31">    ax.plot([B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]], [B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ko-'</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Black line with circle markers</span></span>
<span id="cb1-32">    ax.plot([C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]], [C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ko-'</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Black line with circle markers</span></span>
<span id="cb1-33"></span>
<span id="cb1-34">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Annotate points</span></span>
<span id="cb1-35">    ax.text(A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'  A'</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, verticalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bottom'</span>)</span>
<span id="cb1-36">    ax.text(B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'  B'</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, verticalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'top'</span>, horizontalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'right'</span>)</span>
<span id="cb1-37">    ax.text(C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'  C'</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, verticalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'top'</span>, horizontalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'left'</span>)</span>
<span id="cb1-38"></span>
<span id="cb1-39">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add angles as arcs</span></span>
<span id="cb1-40">    arc_radius <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Radius for the arcs</span></span>
<span id="cb1-41"></span>
<span id="cb1-42">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Angle at B</span></span>
<span id="cb1-43">    angle_B_arc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> patches.Arc(B, arc_radius, arc_radius, angle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, theta1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, theta2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>np.degrees(angle_B), color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blue'</span>)</span>
<span id="cb1-44">    ax.add_patch(angle_B_arc)</span>
<span id="cb1-45">    ax.text(B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> arc_radius<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">°"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blue'</span>)</span>
<span id="cb1-46"></span>
<span id="cb1-47">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Angle at C</span></span>
<span id="cb1-48">    angle_C_arc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> patches.Arc(C, arc_radius, arc_radius, angle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, theta1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> np.degrees(angle_C), theta2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>)</span>
<span id="cb1-49">    ax.add_patch(angle_C_arc)</span>
<span id="cb1-50">    ax.text((C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> arc_radius<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">63</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">°"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>)</span>
<span id="cb1-51"></span>
<span id="cb1-52">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> fig, ax, (A, B, C)</span>
<span id="cb1-53"></span>
<span id="cb1-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot</span></span>
<span id="cb1-55">fig, ax, coordinates <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plot_triangular(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">63</span>))</span>
<span id="cb1-56"></span>
<span id="cb1-57"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add BH</span></span>
<span id="cb1-58">slope <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>((coordinates[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> coordinates[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(coordinates[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> coordinates[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]))</span>
<span id="cb1-59">ax.plot((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">26.5</span>), (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, slope <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">26.5</span>))</span>
<span id="cb1-60">ax.text(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">26.5</span>, slope <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">26.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'  H'</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, verticalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'top'</span>, horizontalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'left'</span>)</span>
<span id="cb1-61"></span>
<span id="cb1-62"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add labels</span></span>
<span id="cb1-63">ax.text(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BC = 30"</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>, horizontalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>)</span>
<span id="cb1-64">ax.axhline(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>,linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb1-65">ax.axvline(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>,linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb1-66">ax.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, linestyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--'</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>)</span>
<span id="cb1-67">ax.set_xlim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>)</span>
<span id="cb1-68">ax.set_ylim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb1-69">ax.set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Triangle ABC"</span>)</span>
<span id="cb1-70">plt.show()</span></code></pre></div>
</details>
<div id="fig-plot" class="center quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="fb69d640" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-02-25-law-of-sines/index_files/figure-html/cell-2-output-1.png" width="500" height="505" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1
</figcaption>
</figure>
</div>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctriangle%20BCH,%20%5Ctriangle%20ABH"> を考えると，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0ABH%20&amp;=%20%5Csin(%20A)%20*%20AB%5C%5C%0ABH%20&amp;=%20%5Csin(%20C)%20*%20BC%0A%5Cend%7Balign%7D%0A"></p>
<p>これを整理すると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0AAB%20&amp;=%20%5Cfrac%7B%5Csin(C)%20*%20BC%7D%7B%5Csin%20A%7D%5Clabel%7Beq-law-of-sines-1%7D%5C%5C%0A%20%20%20&amp;=%20%5Cfrac%7B30%20%5Ccdot%20%5Csin(63%5E%5Ccirc)%7D%7B%5Csin(47%5E%5Ccirc)%7D%5Clabel%7Beq-law-of-sines-2%7D%0A%5Cend%7Balign%7D%0A"></p>
<p>従って，</p>
<div id="8abe4a10" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"BC = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>sin(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">63</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.pi)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>sin(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">47</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.pi)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.4f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>BC = 36.5489</code></pre>
</div>
</div>
<p>と計算されます．</p>
<section id="正弦定理の証明" class="level3">
<h3 class="anchored" data-anchor-id="正弦定理の証明">正弦定理の証明</h3>
<p><img src="https://latex.codecogs.com/png.latex?%5Ceqref%7Beq-law-of-sines-1%7D">, <img src="https://latex.codecogs.com/png.latex?%5Ceqref%7Beq-law-of-sines-2%7D"> を整理すると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7BAB%7D%7B%5Csin%20A%7D%20=%20%5Cfrac%7BBC%7D%7B%5Csin%20C%7D%0A"></p>
<p>を得ます．同様の方法で <img src="https://latex.codecogs.com/png.latex?AC"> を求めて整理すると，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7BAB%7D%7B%5Csin%20A%7D=%20%5Cfrac%7BAC%7D%7B%5Csin%20B%7D%20=%20%5Cfrac%7BBC%7D%7B%5Csin%20C%7D%0A"></p>
<p>これは，<img src="https://latex.codecogs.com/png.latex?%5Ctriangle%20ABC"> の外接円を考えたとき，その外接円の半径を <img src="https://latex.codecogs.com/png.latex?R"> としたとき</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7BAB%7D%7B%5Csin%20A%7D=%20%5Cfrac%7BAC%7D%7B%5Csin%20B%7D%20=%20%5Cfrac%7BBC%7D%7B%5Csin%20C%7D%20=%202R%0A"></p>
<p>という正弦定理へ繋がります．</p>
<p><strong> ▶&nbsp; 対辺と<img src="https://latex.codecogs.com/png.latex?%5Csin"> の比率が直径 <img src="https://latex.codecogs.com/png.latex?2R">に一致する証明</strong></p>
<!--::: {.callout-note collapse="true" icon=false}-->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><img src="https://latex.codecogs.com/png.latex?%5Ctriangle%20ABC"> の外接円について，弧BC以外の円周上の点 <img src="https://latex.codecogs.com/png.latex?P"> を適当に取ったときに形成される角度 <img src="https://latex.codecogs.com/png.latex?%5Cangle%20BPC"> を弧BCの円周角といいます． 中心角と円周角の関係として，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctext%7B%E4%B8%AD%E5%BF%83%E8%A7%92%7D%20=%202%5Ctimes%20(%5Ctext%7B%E5%86%86%E5%91%A8%E8%A7%92%7D)%0A"></p>
<p>ここから，「<strong>同じ弧に対する円周角は等しい</strong>」ことがいえます．ここで，<img src="https://latex.codecogs.com/png.latex?CP"> が外接円の直径となるように <img src="https://latex.codecogs.com/png.latex?P"> を取ると直径に対する円周角は直角なので <img src="https://latex.codecogs.com/png.latex?%5Ctriangle%20BCP"> は直角三角形となります．<img src="https://latex.codecogs.com/png.latex?CP"> を斜辺，<img src="https://latex.codecogs.com/png.latex?BC">を対辺とすると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0ABC%20=%202R%20%5Ctimes%20%5Csin(%5Cangle%20BPC)%20=%202R%20%5Ctimes%20%5Csin(A)%0A"></p>
<p>従って，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7BBC%7D%7B%5Csin%20A%7D%20=%202R%0A"></p>
<p>従って，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7BAB%7D%7B%5Csin%20A%7D=%20%5Cfrac%7BAC%7D%7B%5Csin%20B%7D%20=%20%5Cfrac%7BBC%7D%7B%5Csin%20C%7D%20=%202R%0A"></p>
</div>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb4-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 与えられた条件</span></span>
<span id="cb4-5">BC <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 辺BC</span></span>
<span id="cb4-6">angle_B <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 角B (ラジアン変換)</span></span>
<span id="cb4-7">angle_C <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">63</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 角C (ラジアン変換)</span></span>
<span id="cb4-8"></span>
<span id="cb4-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 角Aを計算</span></span>
<span id="cb4-10">angle_A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">63</span>))</span>
<span id="cb4-11"></span>
<span id="cb4-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 正弦定理を使ってABとACを求める</span></span>
<span id="cb4-13">AB <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> BC <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(angle_B) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> np.sin(angle_A)</span>
<span id="cb4-14">AC <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> BC <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(angle_C) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> np.sin(angle_A)</span>
<span id="cb4-15"></span>
<span id="cb4-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 頂点座標</span></span>
<span id="cb4-17">B <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Bを原点に配置</span></span>
<span id="cb4-18">C <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([BC, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Cをx軸上に配置</span></span>
<span id="cb4-19">A_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> BC <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> AC <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.cos(angle_B)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Aのx座標</span></span>
<span id="cb4-20">A_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AC <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(angle_B)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Aのy座標</span></span>
<span id="cb4-21">A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([A_x, A_y])</span>
<span id="cb4-22"></span>
<span id="cb4-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 垂直二等分線の交点（外心）を求める</span></span>
<span id="cb4-24"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> circumcenter(A, B, C):</span>
<span id="cb4-25">    D <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]))</span>
<span id="cb4-26">    Ux <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ((A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> D</span>
<span id="cb4-27">    Uy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ((A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> D</span>
<span id="cb4-28">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> np.array([Ux, Uy])</span>
<span id="cb4-29"></span>
<span id="cb4-30">circumcenter_point <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> circumcenter(A, B, C)</span>
<span id="cb4-31">radius <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linalg.norm(A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> circumcenter_point)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 外接円の半径</span></span>
<span id="cb4-32"></span>
<span id="cb4-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 円周上の点P（円周角を示す）</span></span>
<span id="cb4-34">theta_P <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">120</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 任意の角度 (120°)</span></span>
<span id="cb4-35">P_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> circumcenter_point[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> radius <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.cos(theta_P)</span>
<span id="cb4-36">P_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> circumcenter_point[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> radius <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(theta_P)</span>
<span id="cb4-37">P <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>np.sin(angle_A) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(np.pi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> angle_A)])</span>
<span id="cb4-38"></span>
<span id="cb4-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 図を作成</span></span>
<span id="cb4-40">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb4-41"></span>
<span id="cb4-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 三角形ABCをプロット</span></span>
<span id="cb4-43">ax.plot([A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]], [A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bo-'</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AB"</span>)</span>
<span id="cb4-44">ax.plot([B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]], [B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ro-'</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BC"</span>)</span>
<span id="cb4-45">ax.plot([C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]], [C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'go-'</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CA"</span>)</span>
<span id="cb4-46"></span>
<span id="cb4-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 外接円をプロット</span></span>
<span id="cb4-48">circle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.Circle(circumcenter_point, radius, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cyan'</span>, fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, linestyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dashed'</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Circumcircle"</span>)</span>
<span id="cb4-49">ax.add_patch(circle)</span>
<span id="cb4-50"></span>
<span id="cb4-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 円周角を示す点Pと三角形BPC</span></span>
<span id="cb4-52">ax.plot([B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]], [B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'purple'</span>, linestyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dotted'</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BP"</span>)</span>
<span id="cb4-53">ax.plot([C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]], [C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'purple'</span>, linestyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dotted'</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CP"</span>)</span>
<span id="cb4-54"></span>
<span id="cb4-55"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 点のラベル</span></span>
<span id="cb4-56">ax.text(A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], A[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'  A'</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, verticalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bottom'</span>)</span>
<span id="cb4-57">ax.text(B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], B[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'  B'</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, verticalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'top'</span>, horizontalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'right'</span>)</span>
<span id="cb4-58">ax.text(C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], C[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'  C'</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, verticalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'top'</span>, horizontalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'left'</span>)</span>
<span id="cb4-59">ax.text(P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], P[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'  P'</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, verticalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bottom'</span>, horizontalalignment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'right'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'purple'</span>)</span>
<span id="cb4-60">ax.scatter(circumcenter_point[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], circumcenter_point[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 外心O</span></span>
<span id="cb4-61"></span>
<span id="cb4-62"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># グリッドと範囲設定</span></span>
<span id="cb4-63">ax.axhline(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>, linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb4-64">ax.axvline(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>, linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb4-65">ax.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, linestyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--'</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>)</span>
<span id="cb4-66">ax.set_xlim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>radius<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, BC<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>radius<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb4-67">ax.set_ylim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>radius<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, radius<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>AC<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb4-68">ax.legend()</span>
<span id="cb4-69">ax.set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Triangle ABC with Circumcircle and Inscribed Angle"</span>)</span>
<span id="cb4-70"></span>
<span id="cb4-71"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 図を表示</span></span>
<span id="cb4-72">plt.show()</span></code></pre></div>
</details>
<div id="fig-plot" class="center quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="b6ebb436" class="cell" data-execution_count="3">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-02-25-law-of-sines/index_files/figure-html/cell-4-output-1.png" width="503" height="505" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2
</figcaption>
</figure>
</div>
</section>
<section id="例題-山の高さを求める" class="level3">
<h3 class="anchored" data-anchor-id="例題-山の高さを求める">例題: 山の高さを求める</h3>
<div class="blog-custom-border" style="margin-top: 1rem; margin-bottom: 1rem;">
<div id="exr-" class="custom_problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2</strong></span> <br></p>
<p>とある山へハイキングにいくとします．</p>
<ul>
<li>山頂をC</li>
<li>山の麓のA地点から同じ標高で直線距離で1000m離れている地点をB</li>
<li>A地点からCを見たときの仰角は <img src="https://latex.codecogs.com/png.latex?30%5E%5Ccirc"></li>
<li><img src="https://latex.codecogs.com/png.latex?%5Ctriangle%20ABC"> について，<img src="https://latex.codecogs.com/png.latex?%5Cangle%20CAB%20=%2075%5E%5Ccirc,%20%5Cangle%20ABC%20=%2045%5E%5Ccirc"></li>
</ul>
<p>ということがわかっているとします．このとき，Cの標高を求めよ．なお，<img src="https://latex.codecogs.com/png.latex?A,%20B"> の標高は 0m とする．</p>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb5-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb5-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> mpl_toolkits.mplot3d.art3d <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Poly3DCollection</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Given angles and side lengths</span></span>
<span id="cb5-6">angle_A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>)</span>
<span id="cb5-7">angle_B <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>)</span>
<span id="cb5-8">AB <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Given</span></span>
<span id="cb5-9"></span>
<span id="cb5-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute angle C</span></span>
<span id="cb5-11">angle_C <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># C = 60 degrees</span></span>
<span id="cb5-12"></span>
<span id="cb5-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute sides using the Law of Sines</span></span>
<span id="cb5-14">BC <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AB <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(angle_A) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> np.sin(angle_C)</span>
<span id="cb5-15">AC <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AB <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(angle_B) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> np.sin(angle_C)</span>
<span id="cb5-16"></span>
<span id="cb5-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute coordinates of A, B, and C</span></span>
<span id="cb5-18">A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A is the origin</span></span>
<span id="cb5-19">B <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([AB, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># B is along the x-axis</span></span>
<span id="cb5-20">C_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Projection of AC on x-axis</span></span>
<span id="cb5-21">C_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AC <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.cos(np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>))</span>
<span id="cb5-22">C_z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AC <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Projection on y-axis</span></span>
<span id="cb5-23">C <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, C_y, C_z])  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># C remains in the XY plane</span></span>
<span id="cb5-24"></span>
<span id="cb5-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Triangle ACH: Given CAH = 30°, CHA = 90° (Right Triangle)</span></span>
<span id="cb5-26">angle_CAH <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.radians(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>)</span>
<span id="cb5-27"></span>
<span id="cb5-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># H's coordinates (directly above C in the Z direction)</span></span>
<span id="cb5-29">H <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, C_y, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb5-30"></span>
<span id="cb5-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create 3D plot</span></span>
<span id="cb5-32">fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))</span>
<span id="cb5-33">ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fig.add_subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">111</span>, projection<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'3d'</span>)</span>
<span id="cb5-34"></span>
<span id="cb5-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot edges of tetrahedron</span></span>
<span id="cb5-36">edges <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb5-37">    (A, B), (B, C), (C, A),  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Triangle ABC</span></span>
<span id="cb5-38">    (A, H), (C, H), (B, H)   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Connecting H to A, C, and B</span></span>
<span id="cb5-39">]</span>
<span id="cb5-40"></span>
<span id="cb5-41"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> edge <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> edges:</span>
<span id="cb5-42">    ax.plot(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>edge), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'k-'</span>)</span>
<span id="cb5-43"></span>
<span id="cb5-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define faces for tetrahedron visualization</span></span>
<span id="cb5-45">faces <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb5-46">    [A, B, C],  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Base ABC</span></span>
<span id="cb5-47">    [A, C, H],  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Side ACH</span></span>
<span id="cb5-48">    [C, B, H],  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Side CBH</span></span>
<span id="cb5-49">    [A, H, B]   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Side AHB</span></span>
<span id="cb5-50">]</span>
<span id="cb5-51"></span>
<span id="cb5-52"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add face shading</span></span>
<span id="cb5-53">ax.add_collection3d(Poly3DCollection(faces, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cyan'</span>))</span>
<span id="cb5-54"></span>
<span id="cb5-55"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Annotate points</span></span>
<span id="cb5-56">ax.text(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>A, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" A"</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)</span>
<span id="cb5-57">ax.text(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>B, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" B"</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)</span>
<span id="cb5-58">ax.text(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>C, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" C"</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)</span>
<span id="cb5-59">ax.text(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>H, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" H"</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)</span>
<span id="cb5-60"></span>
<span id="cb5-61"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Labels and grid</span></span>
<span id="cb5-62">ax.set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"X-axis"</span>)</span>
<span id="cb5-63">ax.set_ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Y-axis"</span>)</span>
<span id="cb5-64">ax.set_zlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Z-axis"</span>)</span>
<span id="cb5-65">ax.set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"3D Tetrahedron CAHB"</span>)</span>
<span id="cb5-66">ax.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb5-67"></span>
<span id="cb5-68">ax.view_init(elev<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, azim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">55</span>) </span>
<span id="cb5-69"></span>
<span id="cb5-70"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Show the plot</span></span>
<span id="cb5-71">plt.show()</span></code></pre></div>
</details>
<div id="fig-plot" class="center quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="d8958815" class="cell" data-execution_count="4">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-02-25-law-of-sines/index_files/figure-html/cell-5-output-1.png" width="627" height="631" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3
</figcaption>
</figure>
</div>
<!--::: {.callout-note collapse="true" icon=false}-->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>上の図のようにCから<img src="https://latex.codecogs.com/png.latex?XY">平面に垂線を下ろして，XY平面との交点を <img src="https://latex.codecogs.com/png.latex?H"> としたとき，今回求めたい長さは <img src="https://latex.codecogs.com/png.latex?CH">．</p>
<p>問題文の情報を用いて正弦定理を利用すると</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cdisplaystyle%20AC%20=%20%5Cfrac%7BAB%7D%7B%5Csin%20(%5Cangle%20ACB)%7D%20%5Ccdot%20%5Csin(%5Cangle%20ABC)%0A"></p>
<p>ここで</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0ACH%20&amp;=%20AC%20%5Ccdot%20%5Csin(%5Cangle%20CAH)%5C%5C%0A%20%20%20%20&amp;=%20%5Cfrac%7BAB%7D%7B%5Csin%20(%5Cangle%20ACB)%7D%20%5Ccdot%20%5Csin(%5Cangle%20ABC)%20%5Ccdot%20%5Csin(%5Cangle%20CAH)%0A%5Cend%7Balign%7D%0A"></p>
<p>従って，</p>
<div id="fb6195cf" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"CH = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>C_z<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>CH = 408.25</code></pre>
</div>
</div>
</div>
</div>
</div>


</section>
</section>

 ]]></description>
  <category>三角関数</category>
  <guid>https://ryonakagami.github.io/regmonkey-datascience-blog/posts/2025-02-25-law-of-sines/</guid>
  <pubDate>Tue, 25 Feb 2025 00:00:00 GMT</pubDate>
</item>
</channel>
</rss>
